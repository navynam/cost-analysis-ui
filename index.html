<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Í≤¨Ï†ÅÏÑú Î∂ÑÏÑù ÏãúÏä§ÌÖú - ÏôÄÏù¥Ïñ¥ÌîÑÎ†àÏûÑ v2</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  :root { --sidebar-width: 260px; --blue: #0071e3; --red: #ff3b30; --green: #34c759; --orange: #ff9500; --purple: #af52de; --gray: #86868b; --dark: #1d1d1f; --border: #e5e5e7; --bg: #f5f5f7; }
  body { font-family: 'Pretendard', -apple-system, sans-serif; background: var(--bg); color: var(--dark); }
  body.sidebar-collapsed { --sidebar-width: 60px; }

  /* ===== Login ===== */
  .login-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); z-index: 9999; display: flex; align-items: center; justify-content: center; transition: opacity 0.4s ease; }
  .login-overlay.hidden { opacity: 0; pointer-events: none; }
  .login-card { background: #fff; border-radius: 20px; padding: 48px 40px; width: 420px; max-width: 90vw; box-shadow: 0 20px 60px rgba(0,0,0,0.3); text-align: center; }
  .login-logo { width: 56px; height: 56px; background: var(--blue); border-radius: 14px; display: inline-flex; align-items: center; justify-content: center; font-size: 24px; color: #fff; font-weight: 700; margin-bottom: 20px; }
  .login-title { font-size: 22px; font-weight: 700; margin-bottom: 6px; }
  .login-subtitle { font-size: 14px; color: var(--gray); margin-bottom: 32px; }
  .login-field { width: 100%; margin-bottom: 16px; text-align: left; }
  .login-field label { display: block; font-size: 13px; font-weight: 600; margin-bottom: 6px; }
  .login-field input { width: 100%; padding: 12px 14px; border: 1.5px solid #d2d2d7; border-radius: 10px; font-size: 15px; outline: none; transition: border-color 0.2s; }
  .login-field input:focus { border-color: var(--blue); }
  .login-btn { width: 100%; padding: 14px; background: var(--blue); color: #fff; border: none; border-radius: 12px; font-size: 16px; font-weight: 600; cursor: pointer; margin-top: 8px; transition: background 0.2s; }
  .login-btn:hover { background: #0077ED; }
  .login-btn:disabled { background: #a1a1a6; cursor: not-allowed; }
  .login-error { color: var(--red); font-size: 13px; margin-top: 8px; display: none; }
  .login-error.show { display: block; }
  .login-footer { margin-top: 24px; font-size: 12px; color: #a1a1a6; }
  .login-links { display: flex; justify-content: center; gap: 16px; margin-top: 16px; }
  .login-links a { font-size: 13px; color: var(--blue); text-decoration: none; cursor: pointer; }
  .login-links a:hover { text-decoration: underline; }
  .otp-wrap { display: none; }
  .otp-wrap.active { display: block; }
  .login-form-wrap { display: block; }
  .login-form-wrap.hidden { display: none; }
  .otp-phone-info { font-size: 14px; margin-bottom: 24px; line-height: 1.6; }
  .otp-phone-info strong { color: var(--blue); }
  .otp-inputs { display: flex; gap: 10px; justify-content: center; margin-bottom: 24px; }
  .otp-inputs input { width: 48px; height: 56px; text-align: center; font-size: 22px; font-weight: 700; border: 1.5px solid #d2d2d7; border-radius: 10px; outline: none; }
  .otp-inputs input:focus { border-color: var(--blue); }
  .otp-timer { font-size: 13px; color: var(--gray); margin-bottom: 20px; }
  .otp-timer span { color: var(--blue); font-weight: 600; }
  .otp-resend { background: none; border: none; color: var(--blue); font-size: 13px; cursor: pointer; text-decoration: underline; margin-bottom: 24px; display: inline-block; }

  /* ===== Sidebar ===== */
  .sidebar { position: fixed; top: 0; left: 0; bottom: 0; width: var(--sidebar-width); background: var(--dark); color: #fff; z-index: 50; transition: width 0.3s ease; display: flex; flex-direction: column; overflow: hidden; }
  .sidebar.collapsed { width: 60px; }
  .sidebar.collapsed .sidebar-logo-text, .sidebar.collapsed .sidebar-item-text, .sidebar.collapsed .sidebar-item-badge, .sidebar.collapsed .sidebar-user-info, .sidebar.collapsed .sidebar-section { display: none; }
  .sidebar.collapsed .sidebar-header { justify-content: center; padding: 16px 0; gap: 0; }
  .sidebar.collapsed .sidebar-logo-icon { display: none; }
  .sidebar.collapsed .sidebar-item { justify-content: center; padding: 12px 0; border-left: none; }
  .sidebar.collapsed .sidebar-footer { justify-content: center; padding: 14px 0; }
  .main-wrapper { margin-left: var(--sidebar-width); transition: margin-left 0.3s ease; }
  .sidebar-header { padding: 16px; border-bottom: 1px solid #333; display: flex; align-items: center; gap: 10px; min-height: 56px; cursor: pointer; }
  .sidebar-logo-icon { width: 28px; height: 28px; background: var(--blue); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 14px; flex-shrink: 0; }
  .sidebar-logo-text { font-size: 15px; font-weight: 700; white-space: nowrap; }
  .sidebar-nav { flex: 1; padding: 8px 0; overflow-y: auto; overflow-x: hidden; }
  .sidebar-section { padding: 12px 16px 4px; font-size: 10px; font-weight: 600; color: #666; text-transform: uppercase; letter-spacing: 0.5px; white-space: nowrap; }
  .sidebar-item { display: flex; align-items: center; gap: 10px; padding: 10px 16px; font-size: 13px; color: #a1a1a6; cursor: pointer; transition: all 0.15s; border-left: 3px solid transparent; white-space: nowrap; position: relative; }
  .sidebar-item:hover { background: #2a2a2c; color: #fff; }
  .sidebar-item.active { background: #2a2a2c; color: #fff; border-left-color: var(--blue); }
  .sidebar-item-icon { width: 24px; text-align: center; font-size: 17px; flex-shrink: 0; }
  .sidebar-item-text { flex: 1; overflow: hidden; text-overflow: ellipsis; }
  .sidebar-item-badge { font-size: 10px; padding: 1px 7px; border-radius: 10px; font-weight: 600; flex-shrink: 0; }
  .sidebar-item-badge.blue { background: var(--blue); color: #fff; }
  .sidebar-item-badge.red { background: var(--red); color: #fff; }
  .sidebar-item-badge.orange { background: var(--orange); color: #fff; }
  .sidebar-divider { height: 1px; background: #333; margin: 8px 12px; }
  .sidebar-footer { padding: 14px 16px; border-top: 1px solid #333; display: flex; align-items: center; gap: 10px; overflow: hidden; }
  .sidebar-avatar { width: 32px; height: 32px; border-radius: 50%; background: var(--blue); display: flex; align-items: center; justify-content: center; font-size: 13px; font-weight: 600; flex-shrink: 0; }
  .sidebar-user-info { font-size: 12px; white-space: nowrap; }
  .sidebar-user-name { font-weight: 600; }
  .sidebar-user-role { color: var(--gray); font-size: 11px; }

  /* ===== Common ===== */
  .page-header { padding: 20px 24px 0; }
  .page-title { font-size: 20px; font-weight: 700; margin-bottom: 2px; }
  .page-subtitle { font-size: 13px; color: var(--gray); margin-bottom: 16px; }
  .btn { padding: 6px 16px; border-radius: 6px; font-size: 13px; cursor: pointer; border: 1px solid var(--border); background: #fff; transition: all 0.15s; }
  .btn:hover { background: var(--bg); }
  .btn-primary { background: var(--blue); color: #fff; border-color: var(--blue); }
  .btn-primary:hover { background: #0077ED; }
  .btn-outline { background: transparent; }
  .btn-danger { background: var(--red); color: #fff; border-color: var(--red); }
  .badge { font-size: 10px; padding: 2px 6px; border-radius: 4px; font-weight: 600; }
  .badge-ok { background: #d4edda; color: var(--green); }
  .badge-warn { background: #fff3cd; color: var(--orange); }
  .badge-error { background: #f8d7da; color: var(--red); }

  /* ===== Top Header Bar ===== */
  .top-header { background: #fff; border-bottom: 1px solid var(--border); padding: 10px 24px; display: flex; align-items: center; justify-content: flex-end; gap: 12px; }
  .header-bell { position: relative; width: 36px; height: 36px; border-radius: 8px; border: 1px solid var(--border); background: #fff; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 18px; }
  .header-bell .bell-dot { position: absolute; top: 6px; right: 6px; width: 8px; height: 8px; background: var(--red); border-radius: 50%; border: 2px solid #fff; }
  .header-help { width: 36px; height: 36px; border-radius: 8px; border: 1px solid var(--border); background: #fff; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 16px; }
  .header-user-btn { display: flex; align-items: center; gap: 8px; padding: 4px 12px 4px 4px; border-radius: 20px; border: 1px solid var(--border); background: #fff; cursor: pointer; font-size: 13px; }
  .header-user-avatar { width: 28px; height: 28px; border-radius: 50%; background: var(--blue); color: #fff; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 600; }

  /* ===== Header ===== */
  .header { background: #fff; border-bottom: 1px solid var(--border); padding: 16px 24px; display: flex; align-items: center; justify-content: space-between; }
  .header-left { display: flex; align-items: center; gap: 16px; }
  .header-left h1 { font-size: 16px; font-weight: 600; }
  .breadcrumb { font-size: 13px; color: var(--gray); }
  .header-right { display: flex; gap: 8px; }

  /* ===== Status Bar ===== */
  .status-bar { background: #fff; border-bottom: 1px solid var(--border); padding: 12px 24px; display: flex; align-items: center; justify-content: space-between; }
  .status-items { display: flex; gap: 24px; }
  .status-item { display: flex; align-items: center; gap: 6px; font-size: 13px; }
  .status-item .label { color: var(--gray); }
  .status-item .value { font-weight: 600; }
  .status-item .value.green { color: var(--green); }
  .status-item .value.red { color: var(--red); }
  .view-tabs { display: flex; gap: 4px; }
  .view-tab { padding: 6px 14px; border-radius: 6px; font-size: 13px; cursor: pointer; border: 1px solid var(--border); background: #fff; color: var(--gray); }
  .view-tab.active { background: var(--dark); color: #fff; border-color: var(--dark); }

  /* ===== Dashboard ===== */
  .dashboard-page { display: none; min-height: 100vh; background: var(--bg); overflow-y: auto; }
  .dash-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; padding: 0 24px 16px; }
  .dash-card { background: #fff; border: 1px solid var(--border); border-radius: 12px; padding: 20px; transition: box-shadow 0.2s; cursor: pointer; }
  .dash-card:hover { box-shadow: 0 2px 12px rgba(0,0,0,0.06); }
  .dash-card-label { font-size: 12px; color: var(--gray); margin-bottom: 8px; display: flex; align-items: center; gap: 6px; }
  .dash-card-value { font-size: 28px; font-weight: 700; margin-bottom: 4px; }
  .dash-card-change { font-size: 12px; }
  .dash-card-change.up { color: var(--red); }
  .dash-card-change.down { color: var(--green); }
  .dash-card-change.neutral { color: var(--gray); }

  .dash-quick-actions { display: flex; gap: 10px; padding: 0 24px 16px; }
  .dash-quick-btn { padding: 10px 20px; border-radius: 10px; font-size: 13px; font-weight: 600; cursor: pointer; border: 1px solid var(--border); background: #fff; display: flex; align-items: center; gap: 8px; transition: all 0.15s; }
  .dash-quick-btn:hover { border-color: var(--blue); color: var(--blue); }
  .dash-quick-btn.primary-action { background: var(--blue); color: #fff; border-color: var(--blue); }
  .dash-quick-btn.primary-action:hover { background: #0077ED; }

  .dash-period-filter { display: flex; gap: 4px; padding: 0 24px 16px; }
  .period-btn { padding: 6px 14px; border-radius: 20px; font-size: 12px; cursor: pointer; border: 1px solid var(--border); background: #fff; color: var(--gray); }
  .period-btn.active { background: var(--dark); color: #fff; border-color: var(--dark); }

  .dash-section { padding: 0 24px 24px; }
  .dash-section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
  .dash-section-title { font-size: 15px; font-weight: 700; }
  .dash-recent-table { width: 100%; border-collapse: collapse; background: #fff; border: 1px solid var(--border); border-radius: 10px; overflow: hidden; }
  .dash-recent-table th { padding: 10px 16px; text-align: left; font-size: 11px; font-weight: 600; color: var(--gray); background: #f9f9fb; border-bottom: 1px solid var(--border); }
  .dash-recent-table td { padding: 12px 16px; border-bottom: 1px solid #f0f0f0; font-size: 13px; }
  .dash-recent-table tbody tr { cursor: pointer; transition: background 0.15s; }
  .dash-recent-table tbody tr:hover { background: #f8f9ff; }
  .dash-recent-table tbody tr:last-child td { border-bottom: none; }
  .dash-alerts { display: flex; flex-direction: column; gap: 8px; }
  .dash-alert { background: #fff; border: 1px solid var(--border); border-radius: 10px; padding: 14px 16px; display: flex; align-items: center; gap: 12px; cursor: pointer; transition: all 0.15s; }
  .dash-alert:hover { border-color: var(--blue); }
  .dash-alert-icon { font-size: 20px; flex-shrink: 0; }
  .dash-alert-content { flex: 1; }
  .dash-alert-title { font-size: 13px; font-weight: 600; margin-bottom: 2px; }
  .dash-alert-desc { font-size: 12px; color: var(--gray); }
  .dash-alert-time { font-size: 11px; color: #a1a1a6; white-space: nowrap; }
  .dash-two-col { display: grid; grid-template-columns: 2fr 1fr; gap: 16px; padding: 0 24px 24px; }
  .dash-chart-placeholder { background: #fff; border: 1px solid var(--border); border-radius: 12px; padding: 24px; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 280px; color: var(--gray); }
  .dash-chart-placeholder .chart-icon { font-size: 48px; margin-bottom: 12px; opacity: 0.5; }

  /* ===== Parsing ===== */
  .parsing-container { display: none; min-height: 100vh; background: var(--bg); overflow-y: auto; }
  .upload-area { border: 2px dashed #d2d2d7; border-radius: 12px; padding: 32px; text-align: center; margin: 0 24px 16px; background: #fff; cursor: pointer; transition: all 0.3s; }
  .upload-area:hover { border-color: var(--blue); background: #f8fbff; }
  .upload-area.drag-over { border-color: var(--blue); background: #e8f4fd; border-style: solid; transform: scale(1.01); }
  .upload-icon { font-size: 40px; margin-bottom: 12px; }
  .upload-text { font-size: 14px; color: var(--gray); margin-bottom: 8px; }
  .upload-text strong { color: var(--blue); }
  .upload-formats { font-size: 11px; color: #a1a1a6; }
  .upload-queue { padding: 0 24px 16px; display: none; }
  .upload-queue.show { display: block; }
  .upload-queue-item { background: #fff; border: 1px solid var(--border); border-radius: 8px; padding: 10px 16px; margin-bottom: 8px; display: flex; align-items: center; gap: 12px; }
  .upload-queue-name { flex: 1; font-size: 13px; font-weight: 500; }
  .upload-queue-progress { width: 120px; height: 4px; background: #e5e5e7; border-radius: 2px; overflow: hidden; }
  .upload-queue-fill { height: 100%; background: var(--blue); border-radius: 2px; transition: width 0.3s; }
  .upload-queue-cancel { width: 24px; height: 24px; border-radius: 50%; border: none; background: #e5e5e7; cursor: pointer; font-size: 12px; display: flex; align-items: center; justify-content: center; }
  .upload-queue-cancel:hover { background: #f8d7da; color: var(--red); }

  .parsing-toolbar { display: flex; gap: 8px; padding: 0 24px 12px; align-items: center; }
  .parsing-toolbar .btn { font-size: 12px; }
  .select-all-wrap { display: flex; align-items: center; gap: 6px; font-size: 12px; color: var(--gray); }

  .status-cards { display: flex; gap: 12px; margin-bottom: 16px; padding: 0 24px; }
  .status-card { flex: 1; background: #fff; border: 1px solid var(--border); border-radius: 10px; padding: 16px; cursor: pointer; transition: all 0.2s; text-align: center; }
  .status-card:hover { border-color: var(--blue); }
  .status-card.active { border-color: var(--blue); background: #f0f6ff; }
  .status-card-count { font-size: 28px; font-weight: 700; margin-bottom: 4px; }
  .status-card-label { font-size: 12px; color: var(--gray); }
  .sc-all .status-card-count { color: var(--dark); }
  .sc-extracting .status-card-count { color: var(--orange); }
  .sc-complete .status-card-count { color: var(--green); }
  .sc-failed .status-card-count { color: var(--red); }
  .sc-analyzing .status-card-count { color: var(--purple); }

  .file-list { padding: 0 24px 24px; }
  .file-table { width: 100%; border-collapse: collapse; background: #fff; border: 1px solid var(--border); border-radius: 10px; overflow: hidden; }
  .file-table th { padding: 12px 16px; text-align: left; font-size: 11px; font-weight: 600; color: var(--gray); background: #f9f9fb; border-bottom: 1px solid var(--border); }
  .file-table td { padding: 14px 16px; border-bottom: 1px solid #f0f0f0; font-size: 13px; }
  .file-table tbody tr { cursor: pointer; transition: background 0.15s; }
  .file-table tbody tr:hover { background: #f8f9ff; }
  .file-table tbody tr:last-child td { border-bottom: none; }
  .file-name { font-weight: 600; }
  .file-status { display: inline-flex; align-items: center; gap: 5px; font-size: 12px; font-weight: 600; padding: 3px 10px; border-radius: 12px; white-space: nowrap; }
  .fs-extracting { background: #fff3cd; color: #b8860b; }
  .fs-complete { background: #d4edda; color: #155724; }
  .fs-failed { background: #f8d7da; color: #721c24; }
  .fs-analyzing { background: #e8daef; color: #6c3483; }
  .file-progress { width: 80px; height: 6px; background: #e5e5e7; border-radius: 3px; overflow: hidden; }
  .file-progress-fill { height: 100%; border-radius: 3px; }
  .file-action-btn { padding: 4px 10px; border: 1px solid var(--border); border-radius: 6px; background: #fff; font-size: 11px; cursor: pointer; color: #555; }
  .file-action-btn:hover { border-color: var(--blue); color: var(--blue); }
  .file-action-btn.primary { background: var(--blue); color: #fff; border-color: var(--blue); }
  .file-action-btn.disabled { opacity: 0.4; pointer-events: none; }
  .file-checkbox { width: 16px; height: 16px; cursor: pointer; accent-color: var(--blue); }

  .parsing-search { display: flex; gap: 10px; margin-bottom: 16px; padding: 0 24px; }
  .parsing-search-input { flex: 1; padding: 10px 16px; border: 1px solid var(--border); border-radius: 8px; font-size: 13px; background: #fff; outline: none; }
  .parsing-search-input:focus { border-color: var(--blue); }
  .parsing-filter-btn { padding: 10px 16px; border: 1px solid var(--border); border-radius: 8px; background: #fff; font-size: 13px; cursor: pointer; }

  /* ===== Detail Drawer ===== */
  .detail-drawer { position: fixed; top: 0; right: 0; bottom: 0; width: 480px; background: #fff; box-shadow: -4px 0 20px rgba(0,0,0,0.1); z-index: 60; transform: translateX(480px); transition: transform 0.3s ease; display: flex; flex-direction: column; }
  .detail-drawer.open { transform: translateX(0); }
  .drawer-header { padding: 20px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
  .drawer-body { flex: 1; overflow-y: auto; padding: 20px; }
  .drawer-section { margin-bottom: 20px; }
  .drawer-section-title { font-size: 12px; font-weight: 600; color: var(--gray); margin-bottom: 8px; }
  .drawer-info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
  .drawer-info-item { background: #f9f9fb; border-radius: 8px; padding: 10px; }
  .drawer-info-label { font-size: 10px; color: var(--gray); margin-bottom: 2px; }
  .drawer-info-value { font-size: 13px; font-weight: 600; }
  .drawer-footer { padding: 16px 20px; border-top: 1px solid var(--border); display: flex; gap: 8px; }
  .drawer-footer .btn { flex: 1; text-align: center; padding: 10px; }
  .popup-close { width: 28px; height: 28px; border-radius: 50%; border: none; background: #e5e5e7; cursor: pointer; font-size: 14px; display: flex; align-items: center; justify-content: center; }
  .popup-close:hover { background: #d2d2d7; }
  .extraction-log { background: var(--dark); border-radius: 8px; padding: 12px; font-family: monospace; font-size: 11px; color: #a1a1a6; max-height: 200px; overflow-y: auto; }
  .log-line { margin-bottom: 4px; }
  .log-time { color: #666; }
  .log-ok { color: var(--green); }
  .log-warn { color: var(--orange); }
  .log-err { color: var(--red); }
  .log-info { color: var(--blue); }
  .error-box { background: #fff8f8; border: 1px solid #f8d7da; border-radius: 8px; padding: 12px; }
  .error-title { font-size: 12px; font-weight: 600; color: var(--red); margin-bottom: 6px; }
  .error-detail { font-size: 12px; color: #666; }

  /* ===== Verification Views ===== */
  .standard-container, .list-container { overflow-y: auto; height: calc(100vh - 130px); background: var(--bg); display: none; }
  .std-group { background: #fff; border: 1px solid var(--border); border-radius: 10px; margin-bottom: 16px; overflow: hidden; }
  .std-group-header { display: flex; justify-content: space-between; align-items: center; padding: 14px 20px; background: #f9f9fb; border-bottom: 1px solid var(--border); }
  .std-total-header { background: #f0f4ff; }
  .std-group-title { display: flex; align-items: center; gap: 10px; font-size: 14px; font-weight: 600; }
  .std-group-icon { width: 26px; height: 26px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 700; }
  .std-group-summary { display: flex; align-items: center; gap: 10px; }
  .std-summary-value { font-size: 16px; font-weight: 700; }
  .std-summary-pct { font-size: 13px; color: var(--gray); }
  .std-table { width: 100%; border-collapse: collapse; font-size: 12px; }
  .std-table th { padding: 8px 12px; text-align: left; font-size: 11px; font-weight: 600; color: var(--gray); background: #fafafa; border-bottom: 1px solid var(--border); }
  .std-table td { padding: 10px 12px; border-bottom: 1px solid #f0f0f0; }
  .std-table tbody tr:hover { background: #f8f9ff; }
  .std-table tbody tr:last-child td { border-bottom: none; }
  .std-cell-name { font-weight: 500; }
  .has-sub { font-size: 10px; color: var(--blue); background: #e8f4fd; padding: 1px 6px; border-radius: 3px; margin-left: 6px; cursor: pointer; }
  .anomaly-row { background: #fff8f8 !important; }
  .anomaly-row td { background: #fff8f8; }
  .anomaly-row:hover td { background: #fff0f0 !important; }
  .sub-row td { color: #666; background: #fafcff; }
  .level-badge { display: inline-block; font-size: 10px; font-weight: 700; padding: 2px 6px; border-radius: 4px; }
  .level-badge.l0 { background: #e8edf3; color: #555; }
  .level-badge.l1 { background: #dce6f7; color: var(--blue); }
  .mini-confidence { width: 40px; height: 3px; background: #e5e5e7; border-radius: 2px; display: inline-block; vertical-align: middle; margin-right: 4px; overflow: hidden; }
  .mini-bar { height: 100%; border-radius: 2px; }
  .cost-bar { display: flex; height: 8px; background: #e5e5e7; border-radius: 4px; overflow: hidden; }
  .cost-fill { height: 100%; }

  /* Inline Editing */
  .editable-cell { cursor: pointer; position: relative; }
  .editable-cell:hover { background: #e8f4fd; border-radius: 4px; }
  .inline-edit-input { width: 80px; padding: 4px 8px; border: 2px solid var(--blue); border-radius: 4px; font-size: 12px; font-weight: 600; outline: none; }
  .anomaly-reason { display: none; position: absolute; background: var(--dark); color: #fff; border-radius: 8px; padding: 12px; font-size: 12px; width: 260px; z-index: 20; box-shadow: 0 4px 16px rgba(0,0,0,0.2); line-height: 1.5; }
  .anomaly-reason.show { display: block; }
  .anomaly-reason::before { content: 'ü§ñ AI ÌåêÎã® Í∑ºÍ±∞'; display: block; font-weight: 600; margin-bottom: 6px; color: var(--orange); }

  /* List View */
  .list-group { background: #fff; border: 1px solid var(--border); border-radius: 10px; margin-bottom: 16px; overflow: hidden; }
  .list-row { display: grid; grid-template-columns: 36px 80px 1fr 100px 60px 50px 90px 90px 60px 70px 60px; align-items: center; padding: 10px 16px; border-bottom: 1px solid #f0f0f0; font-size: 12px; }
  .list-row:last-child { border-bottom: none; }
  .list-row:hover { background: #f8f9ff; }
  .list-row.anomaly-row:hover { background: #fff0f0; }
  .list-row-header { background: #fafafa; font-size: 11px; font-weight: 600; color: var(--gray); }
  .list-row-header:hover { background: #fafafa; }
  .accordion-toggle { width: 22px; height: 22px; border-radius: 4px; border: 1px solid #d2d2d7; background: #fff; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 11px; transition: all 0.2s; color: #666; }
  .accordion-toggle:hover { border-color: var(--blue); color: var(--blue); }
  .accordion-toggle.open { background: var(--blue); color: #fff; border-color: var(--blue); transform: rotate(90deg); }
  .accordion-toggle.no-child { visibility: hidden; }
  .accordion-children { display: none; background: #f8faff; border-top: 1px solid #eef0f5; }
  .accordion-children.open { display: block; }
  .accordion-children .list-row { padding-left: 52px; background: #f8faff; border-bottom: 1px solid #eef0f5; }
  .child-connector { color: var(--blue); font-size: 11px; margin-right: 4px; }

  /* Graph View */
  .canvas-container { position: relative; width: 100%; height: calc(100vh - 130px); overflow: auto; padding: 40px; display: none; }
  .graph { position: relative; width: 1500px; height: 900px; margin: 0 auto; }
  .node { position: absolute; background: #fff; border: 2px solid var(--border); border-radius: 12px; padding: 16px; width: 260px; cursor: pointer; transition: all 0.2s; box-shadow: 0 1px 3px rgba(0,0,0,0.08); z-index: 1; }
  .node:hover { border-color: var(--blue); box-shadow: 0 4px 12px rgba(0,113,227,0.15); transform: translateY(-2px); }
  .node.root { border-color: var(--blue); }
  .node.has-anomaly { border-color: var(--red); }
  .node-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px; }
  .node-type { font-size: 11px; font-weight: 600; padding: 2px 8px; border-radius: 4px; background: var(--bg); color: var(--gray); }
  .node-type.root-type { background: #e8f4fd; color: var(--blue); }
  .node-type.sub-type { background: #f0f0f0; color: #666; }
  .node-title { font-size: 14px; font-weight: 600; margin-bottom: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  .node-subtitle { font-size: 12px; color: var(--gray); margin-bottom: 12px; }
  .node-stats { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
  .node-stat { background: #f9f9fb; border-radius: 6px; padding: 8px; }
  .node-stat .stat-label { font-size: 10px; color: var(--gray); margin-bottom: 2px; }
  .node-stat .stat-value { font-size: 13px; font-weight: 600; }
  .node-footer { margin-top: 10px; padding-top: 10px; border-top: 1px solid #f0f0f0; display: flex; justify-content: space-between; align-items: center; }
  .confidence-bar { width: 60px; height: 4px; background: #e5e5e7; border-radius: 2px; overflow: hidden; }
  .confidence-fill { height: 100%; border-radius: 2px; }
  .confidence-fill.high { background: var(--green); width: 92%; }
  .confidence-fill.mid { background: var(--orange); width: 75%; }
  .node-action { font-size: 11px; color: var(--blue); cursor: pointer; font-weight: 500; }
  .connections { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0; }
  .connection-line { fill: none; stroke: #d2d2d7; stroke-width: 2; }
  .connection-line.anomaly { stroke: var(--red); stroke-dasharray: 6 3; }
  .legend { position: fixed; bottom: 24px; left: calc(var(--sidebar-width) + 24px); background: #fff; border: 1px solid var(--border); border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); padding: 12px 16px; display: none; gap: 16px; font-size: 12px; transition: left 0.3s; }
  .legend.show { display: flex; }
  .legend-item { display: flex; align-items: center; gap: 6px; }
  .legend-dot { width: 10px; height: 10px; border-radius: 50%; border: 2px solid; }
  .legend-dot.normal { border-color: var(--blue); }
  .legend-dot.warning { border-color: var(--orange); background: #fff3cd; }
  .legend-dot.error { border-color: var(--red); background: #f8d7da; }

  /* ===== Compare Page ===== */
  .compare-page { display: none; min-height: 100vh; background: var(--bg); overflow-y: auto; }
  .compare-selector { display: flex; gap: 16px; padding: 0 24px 16px; align-items: center; }
  .compare-dropdown { flex: 1; padding: 12px 16px; border: 2px solid var(--border); border-radius: 12px; font-size: 14px; background: #fff; cursor: pointer; outline: none; appearance: none; -webkit-appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2386868b' d='M6 8L1 3h10z'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 16px center; }
  .compare-dropdown:focus { border-color: var(--blue); }
  .compare-vs { font-size: 20px; font-weight: 700; color: var(--gray); padding: 0 8px; }
  .compare-chart-section { padding: 0 24px 16px; }
  .compare-bar-chart { background: #fff; border: 1px solid var(--border); border-radius: 12px; padding: 20px; }
  .bar-row { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; font-size: 12px; }
  .bar-label { width: 80px; text-align: right; color: var(--gray); font-weight: 500; }
  .bar-track { flex: 1; height: 24px; background: #f0f0f2; border-radius: 6px; position: relative; overflow: hidden; }
  .bar-fill-a { position: absolute; top: 0; left: 0; height: 12px; border-radius: 6px 6px 0 0; }
  .bar-fill-b { position: absolute; bottom: 0; left: 0; height: 12px; border-radius: 0 0 6px 6px; }
  .bar-value { width: 80px; font-weight: 600; font-size: 11px; }
  .compare-table-wrap { padding: 0 24px 24px; }
  .compare-table { width: 100%; border-collapse: collapse; background: #fff; border: 1px solid var(--border); border-radius: 10px; overflow: hidden; }
  .compare-table th { padding: 10px 16px; font-size: 11px; font-weight: 600; color: var(--gray); background: #f9f9fb; border-bottom: 1px solid var(--border); text-align: left; }
  .compare-table td { padding: 12px 16px; border-bottom: 1px solid #f0f0f0; font-size: 13px; }
  .compare-table tbody tr:last-child td { border-bottom: none; }
  .diff-up { color: var(--red); font-weight: 600; }
  .diff-down { color: var(--green); font-weight: 600; }
  .diff-same { color: var(--gray); }

  /* ===== Report Page ===== */
  .report-page { display: none; min-height: 100vh; background: var(--bg); overflow-y: auto; }
  .report-summary-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; padding: 0 24px 16px; }
  .report-card { background: #fff; border: 1px solid var(--border); border-radius: 12px; padding: 20px; }
  .report-card-title { font-size: 14px; font-weight: 700; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
  .report-item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #f0f0f0; font-size: 13px; }
  .report-item:last-child { border-bottom: none; }
  .report-item-label { color: var(--gray); }
  .report-item-value { font-weight: 600; }
  .report-actions { padding: 0 24px 24px; display: flex; gap: 8px; }

  /* ===== History Page ===== */
  .history-page { display: none; min-height: 100vh; background: var(--bg); overflow-y: auto; }
  .history-list { padding: 0 24px 24px; display: flex; flex-direction: column; gap: 8px; }
  .history-item { background: #fff; border: 1px solid var(--border); border-radius: 10px; padding: 16px 20px; display: flex; align-items: center; gap: 16px; cursor: pointer; transition: all 0.15s; }
  .history-item:hover { border-color: var(--blue); }
  .history-item.unread { border-left: 3px solid var(--blue); background: #f8fbff; }
  .history-icon { width: 40px; height: 40px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 18px; flex-shrink: 0; }
  .history-content { flex: 1; }
  .history-title { font-size: 13px; font-weight: 600; margin-bottom: 2px; }
  .history-desc { font-size: 12px; color: var(--gray); }
  .history-time { font-size: 11px; color: #a1a1a6; white-space: nowrap; }
  .history-filter { display: flex; gap: 8px; padding: 0 24px 16px; justify-content: space-between; align-items: center; }
  .history-filter-tabs { display: flex; gap: 8px; }
  .history-filter-btn { padding: 6px 14px; border-radius: 20px; font-size: 12px; cursor: pointer; border: 1px solid var(--border); background: #fff; color: var(--gray); }
  .history-filter-btn.active { background: var(--dark); color: #fff; border-color: var(--dark); }

  /* ===== Insight Studio ===== */
  .insight-container { display: none; height: 100vh; background: var(--bg); }
  .insight-layout { display: flex; height: 100%; }
  .insight-sidebar { width: 260px; background: #fff; border-right: 1px solid var(--border); display: flex; flex-direction: column; }
  .insight-sidebar-header { padding: 16px; border-bottom: 1px solid var(--border); }
  .insight-new-chat-btn { width: 100%; padding: 10px; background: var(--blue); color: #fff; border: none; border-radius: 8px; font-size: 13px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 6px; }
  .insight-new-chat-btn:hover { background: #0077ED; }
  .insight-chat-list { flex: 1; overflow-y: auto; padding: 8px; }
  .insight-chat-item { padding: 10px 12px; border-radius: 8px; cursor: pointer; font-size: 13px; margin-bottom: 4px; transition: background 0.15s; display: flex; align-items: center; gap: 8px; }
  .insight-chat-item:hover { background: var(--bg); }
  .insight-chat-item.active { background: #e8f4fd; color: var(--blue); font-weight: 600; }
  .insight-chat-item-icon { font-size: 14px; }
  .insight-chat-item-text { flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
  .insight-chat-item-time { font-size: 10px; color: var(--gray); }
  .insight-main { flex: 1; display: flex; flex-direction: column; }
  .insight-body { flex: 1; display: flex; flex-direction: column; max-width: 860px; width: 100%; margin: 0 auto; padding: 24px 40px; overflow: hidden; }
  .insight-welcome { text-align: center; padding: 40px 0 24px; }
  .insight-welcome-icon { font-size: 48px; margin-bottom: 12px; }
  .insight-welcome-title { font-size: 22px; font-weight: 700; margin-bottom: 6px; }
  .insight-welcome-sub { font-size: 14px; color: var(--gray); }
  .insight-suggestions { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 24px; }
  .insight-suggestion { background: #fff; border: 1px solid var(--border); border-radius: 10px; padding: 14px 16px; cursor: pointer; transition: all 0.2s; display: flex; align-items: flex-start; gap: 10px; }
  .insight-suggestion:hover { border-color: var(--blue); background: #f8fbff; }
  .insight-suggestion-icon { font-size: 18px; flex-shrink: 0; }
  .insight-suggestion-text { font-size: 13px; color: #444; line-height: 1.4; }
  .chat-messages { flex: 1; overflow-y: auto; display: flex; flex-direction: column; gap: 16px; padding-bottom: 16px; }
  .chat-msg { display: flex; gap: 10px; max-width: 85%; }
  .chat-msg.user { align-self: flex-end; flex-direction: row-reverse; }
  .chat-msg.ai { align-self: flex-start; }
  .chat-avatar { width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; flex-shrink: 0; }
  .chat-avatar.ai-avatar { background: var(--blue); color: #fff; }
  .chat-avatar.user-avatar { background: #e5e5e7; color: #555; }
  .chat-bubble { padding: 12px 16px; border-radius: 16px; font-size: 13px; line-height: 1.6; }
  .chat-msg.ai .chat-bubble { background: #fff; border: 1px solid var(--border); border-top-left-radius: 4px; }
  .chat-msg.user .chat-bubble { background: var(--blue); color: #fff; border-top-right-radius: 4px; }
  .chat-bubble strong { font-weight: 600; }
  .chat-bubble .chat-table { width: 100%; border-collapse: collapse; margin: 8px 0; font-size: 12px; }
  .chat-bubble .chat-table th, .chat-bubble .chat-table td { padding: 6px 10px; border: 1px solid var(--border); text-align: left; }
  .chat-bubble .chat-table th { background: var(--bg); font-weight: 600; }
  .chat-meta { font-size: 10px; color: #a1a1a6; margin-top: 4px; padding: 0 4px; }
  .chat-msg.user .chat-meta { text-align: right; }
  .chat-input-area { padding: 16px 0 0; border-top: 1px solid var(--border); }
  .chat-input-wrap { display: flex; gap: 8px; background: #fff; border: 1px solid var(--border); border-radius: 12px; padding: 4px 4px 4px 16px; align-items: center; }
  .chat-input-wrap:focus-within { border-color: var(--blue); }
  .chat-input { flex: 1; border: none; outline: none; font-size: 13px; padding: 10px 0; background: transparent; }
  .chat-input::placeholder { color: #a1a1a6; }
  .chat-attach-btn { width: 36px; height: 36px; border-radius: 8px; border: none; background: transparent; cursor: pointer; font-size: 18px; color: var(--gray); }
  .chat-send-btn { width: 36px; height: 36px; border-radius: 8px; border: none; background: var(--blue); cursor: pointer; font-size: 16px; color: #fff; flex-shrink: 0; display: flex; align-items: center; justify-content: center; }
  .chat-context-bar { display: flex; gap: 8px; margin-bottom: 8px; font-size: 11px; }
  .context-chip { background: #e8f4fd; color: var(--blue); padding: 4px 10px; border-radius: 12px; display: flex; align-items: center; gap: 4px; }
  .context-chip .remove { cursor: pointer; font-size: 12px; opacity: 0.6; }

  /* ===== Model Management ===== */
  .model-page { display: none; min-height: 100vh; background: var(--bg); overflow-y: auto; padding: 20px 24px; }
  .model-page-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; }
  .model-page-title { font-size: 20px; font-weight: 700; }
  .model-page-sub { font-size: 13px; color: var(--gray); margin-top: 2px; }
  .model-add-btn { padding: 10px 20px; background: var(--blue); color: #fff; border: none; border-radius: 10px; font-size: 14px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 6px; }
  .formula-list { display: flex; flex-direction: column; gap: 12px; }
  .formula-card { background: #fff; border: 1px solid var(--border); border-radius: 12px; padding: 20px 24px; transition: box-shadow 0.2s; }
  .formula-card:hover { box-shadow: 0 2px 12px rgba(0,0,0,0.06); }
  .formula-card-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px; }
  .formula-name { font-size: 15px; font-weight: 700; }
  .formula-badge { font-size: 11px; padding: 2px 10px; border-radius: 10px; font-weight: 600; }
  .formula-badge.core { background: var(--blue); color: #fff; }
  .formula-badge.sub { background: #e8f0fe; color: var(--blue); }
  .formula-badge.rate { background: #fff3cd; color: #b8860b; }
  .formula-expression { background: var(--bg); border: 1px solid var(--border); border-radius: 8px; padding: 12px 16px; font-family: 'SF Mono', 'Consolas', monospace; font-size: 14px; margin-bottom: 10px; display: flex; align-items: center; gap: 8px; }
  .formula-expression code { flex: 1; background: none; font-family: inherit; font-size: inherit; }
  .formula-desc { font-size: 13px; color: var(--gray); line-height: 1.5; }
  .formula-actions { display: flex; gap: 8px; margin-top: 12px; justify-content: flex-end; }
  .formula-action-btn { padding: 6px 14px; border-radius: 6px; font-size: 12px; font-weight: 600; cursor: pointer; border: 1px solid var(--border); background: #fff; }
  .formula-action-btn.edit { color: var(--blue); border-color: var(--blue); }
  .formula-action-btn.delete { color: var(--red); border-color: var(--red); }
  .formula-var-list { display: flex; gap: 6px; flex-wrap: wrap; margin-top: 8px; }
  .formula-var { font-size: 11px; padding: 2px 8px; border-radius: 6px; background: #f0f6ff; color: var(--blue); font-weight: 500; }

  /* ===== Settings Page ===== */
  .settings-page { display: none; min-height: 100vh; background: var(--bg); overflow-y: auto; padding: 20px 24px; }
  .settings-section { background: #fff; border: 1px solid var(--border); border-radius: 12px; padding: 20px 24px; margin-bottom: 16px; }
  .settings-section-title { font-size: 15px; font-weight: 700; margin-bottom: 16px; }
  .settings-row { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #f0f0f0; }
  .settings-row:last-child { border-bottom: none; }
  .settings-row-label { font-size: 13px; font-weight: 500; }
  .settings-row-desc { font-size: 12px; color: var(--gray); }
  .settings-row-value { font-size: 13px; color: var(--gray); }
  .toggle-switch { width: 44px; height: 24px; background: #d2d2d7; border-radius: 12px; position: relative; cursor: pointer; transition: background 0.2s; }
  .toggle-switch.on { background: var(--green); }
  .toggle-switch::after { content: ''; position: absolute; top: 2px; left: 2px; width: 20px; height: 20px; background: #fff; border-radius: 50%; transition: transform 0.2s; box-shadow: 0 1px 3px rgba(0,0,0,0.2); }
  .toggle-switch.on::after { transform: translateX(20px); }

  /* ===== Modal ===== */
  .modal-overlay { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 100; justify-content: center; align-items: center; }
  .modal-overlay.active { display: flex; }
  .modal { background: #fff; border-radius: 16px; width: 560px; max-width: 90vw; max-height: 85vh; overflow: hidden; box-shadow: 0 20px 60px rgba(0,0,0,0.3); display: flex; flex-direction: column; }
  .modal-header { display: flex; justify-content: space-between; align-items: center; padding: 20px 24px; border-bottom: 1px solid var(--border); }
  .modal-header h2 { font-size: 17px; font-weight: 700; }
  .modal-body { padding: 24px; overflow-y: auto; flex: 1; }
  .modal-footer { padding: 16px 24px; border-top: 1px solid var(--border); display: flex; justify-content: flex-end; gap: 8px; }
  .form-field { margin-bottom: 16px; }
  .form-field label { display: block; font-size: 13px; font-weight: 600; margin-bottom: 6px; }
  .form-field input, .form-field select, .form-field textarea { width: 100%; padding: 10px 14px; border: 1.5px solid #d2d2d7; border-radius: 8px; font-size: 14px; outline: none; font-family: inherit; }
  .form-field input:focus, .form-field select:focus, .form-field textarea:focus { border-color: var(--blue); }
  .form-field textarea { min-height: 80px; resize: vertical; }

  /* ===== Popup (Excel Viewer) ===== */
  .popup-overlay { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 100; justify-content: center; align-items: center; }
  .popup-overlay.active { display: flex; }
  .popup { background: #fff; border-radius: 12px; width: 900px; max-height: 85vh; overflow: hidden; box-shadow: 0 20px 60px rgba(0,0,0,0.3); display: flex; flex-direction: column; }
  .popup-header { display: flex; justify-content: space-between; align-items: center; padding: 16px 20px; border-bottom: 1px solid var(--border); background: #f9f9fb; }
  .popup-header h2 { font-size: 15px; font-weight: 600; }
  .popup-body { overflow: auto; padding: 0; flex: 1; }
  .excel-wrapper { overflow: auto; max-height: 60vh; }
  .excel-table { width: 100%; border-collapse: collapse; font-size: 12px; }
  .excel-table th, .excel-table td { border: 1px solid #d2d2d7; padding: 6px 10px; text-align: left; white-space: nowrap; }
  .excel-table thead th { background: #f0f0f2; font-weight: 600; position: sticky; top: 0; z-index: 2; font-size: 11px; color: #666; }

  /* ===== Empty State ===== */
  .empty-state { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 60px 40px; text-align: center; color: var(--gray); }
  .empty-state-icon { font-size: 56px; margin-bottom: 16px; opacity: 0.5; }
  .empty-state-title { font-size: 16px; font-weight: 600; color: var(--dark); margin-bottom: 6px; }
  .empty-state-desc { font-size: 13px; margin-bottom: 20px; max-width: 320px; line-height: 1.5; }

  /* ===== Toast ===== */
  .toast-container { position: fixed; top: 20px; right: 20px; z-index: 200; display: flex; flex-direction: column; gap: 8px; }
  .toast { background: #fff; border: 1px solid var(--border); border-radius: 10px; padding: 12px 20px; box-shadow: 0 4px 16px rgba(0,0,0,0.12); display: flex; align-items: center; gap: 10px; font-size: 13px; min-width: 280px; animation: slideIn 0.3s ease; }
  @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
  .toast-icon { font-size: 18px; }
  .toast-success { border-left: 3px solid var(--green); }
  .toast-error { border-left: 3px solid var(--red); }
  .toast-info { border-left: 3px solid var(--blue); }

  /* ===== Loading Spinner ===== */
  .loading-overlay { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255,255,255,0.7); z-index: 150; justify-content: center; align-items: center; flex-direction: column; gap: 12px; }
  .loading-overlay.show { display: flex; }
  .spinner { width: 40px; height: 40px; border: 3px solid var(--border); border-top-color: var(--blue); border-radius: 50%; animation: spin 0.8s linear infinite; }
  @keyframes spin { to { transform: rotate(360deg); } }
  .loading-text { font-size: 14px; color: var(--gray); }

  /* ===== Help Guide Modal ===== */
  .help-content h3 { font-size: 15px; margin-bottom: 8px; }
  .help-content p { font-size: 13px; color: #555; line-height: 1.6; margin-bottom: 16px; }
  .help-step { display: flex; gap: 12px; margin-bottom: 16px; }
  .help-step-num { width: 28px; height: 28px; border-radius: 50%; background: var(--blue); color: #fff; display: flex; align-items: center; justify-content: center; font-size: 13px; font-weight: 700; flex-shrink: 0; }
  .help-step-text { font-size: 13px; line-height: 1.5; }

  /* Share Modal */
  .share-link-wrap { display: flex; gap: 8px; margin-bottom: 16px; }
  .share-link-input { flex: 1; padding: 10px 14px; border: 1.5px solid #d2d2d7; border-radius: 8px; font-size: 13px; background: #f9f9fb; }

  /* Notification Settings */
  .notif-settings { padding: 0 24px 24px; }
  .notif-settings-card { background: #fff; border: 1px solid var(--border); border-radius: 12px; padding: 20px; }
</style>
</head>
<body>

<!-- Toast Container -->
<div class="toast-container" id="toastContainer"></div>

<!-- Loading Overlay -->
<div class="loading-overlay" id="loadingOverlay">
  <div class="spinner"></div>
  <div class="loading-text">Ï≤òÎ¶¨ Ï§ë...</div>
</div>

<!-- ===== Login Screen ===== -->
<div class="login-overlay" id="loginOverlay">
  <div class="login-card">
    <div class="login-logo">HD</div>
    <div class="login-title">Í≤¨Ï†ÅÏÑú Î∂ÑÏÑù ÏãúÏä§ÌÖú</div>
    <div class="login-subtitle">Íµ¨Îß§ÏõêÍ∞Ä AI Î∂ÑÏÑù ÌîåÎû´Ìèº</div>
    <div class="login-form-wrap" id="loginForm">
      <div class="login-field">
        <label>ÏïÑÏù¥Îîî</label>
        <input type="text" id="loginId" placeholder="ÏÇ¨Î≤à ÎòêÎäî ÏïÑÏù¥Îîî ÏûÖÎ†•" autocomplete="off">
      </div>
      <div class="login-field">
        <label>ÎπÑÎ∞ÄÎ≤àÌò∏</label>
        <input type="password" id="loginPw" placeholder="ÎπÑÎ∞ÄÎ≤àÌò∏ ÏûÖÎ†•">
      </div>
      <button class="login-btn" id="loginBtn" onclick="handleLogin()">Î°úÍ∑∏Ïù∏</button>
      <div class="login-error" id="loginError"></div>
      <div class="login-links">
        <a onclick="showForgotPassword()">ÎπÑÎ∞ÄÎ≤àÌò∏ Ï∞æÍ∏∞</a>
        <a onclick="showForgotPassword()">ÎπÑÎ∞ÄÎ≤àÌò∏ Î≥ÄÍ≤Ω</a>
      </div>
      <div class="login-footer">¬© 2026 Íµ¨Îß§ÏõêÍ∞Ä AI ¬∑ Íµ¨Îß§Î≥∏Î∂Ä</div>
    </div>
    <div class="otp-wrap" id="otpForm">
      <div class="otp-phone-info"><strong id="otpPhone">010-****-5678</strong> Î°ú<br>Ïù∏Ï¶ùÎ≤àÌò∏Í∞Ä Î∞úÏÜ°ÎêòÏóàÏäµÎãàÎã§.</div>
      <div class="otp-inputs" id="otpInputs">
        <input type="text" maxlength="1" inputmode="numeric">
        <input type="text" maxlength="1" inputmode="numeric">
        <input type="text" maxlength="1" inputmode="numeric">
        <input type="text" maxlength="1" inputmode="numeric">
        <input type="text" maxlength="1" inputmode="numeric">
        <input type="text" maxlength="1" inputmode="numeric">
      </div>
      <div class="otp-timer">ÎÇ®ÏùÄ ÏãúÍ∞Ñ <span id="otpTimerText">03:00</span></div>
      <button class="otp-resend" onclick="resendOtp()">Ïù∏Ï¶ùÎ≤àÌò∏ Ïû¨Î∞úÏÜ°</button>
      <button class="login-btn" onclick="handleOtp()">Ïù∏Ï¶ù ÌôïÏù∏</button>
      <div class="login-error" id="otpError"></div>
      <div class="login-footer">¬© 2026 Íµ¨Îß§ÏõêÍ∞Ä AI ¬∑ Íµ¨Îß§Î≥∏Î∂Ä</div>
    </div>
  </div>
</div>

<!-- ===== Sidebar ===== -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-header">
    <div class="sidebar-logo-icon">AI</div>
    <span class="sidebar-logo-text">Íµ¨Îß§ÏõêÍ∞Ä AI</span>
    <button id="sidebarCollapseBtn" onclick="toggleSidebar()" style="margin-left:auto;width:28px;height:28px;border-radius:6px;border:none;background:#333;color:#fff;cursor:pointer;font-size:16px;display:flex;align-items:center;justify-content:center;">¬´</button>
  </div>
  <nav class="sidebar-nav">
    <div class="sidebar-section">Î©îÏù∏</div>
    <div class="sidebar-item active" data-page="dashboard" onclick="switchPage('dashboard')">
      <span class="sidebar-item-icon">üè†</span>
      <span class="sidebar-item-text">ÎåÄÏãúÎ≥¥Îìú</span>
    </div>
    <div class="sidebar-divider"></div>
    <div class="sidebar-section">Î∂ÑÏÑù</div>
    <div class="sidebar-item" data-page="parsing" onclick="switchPage('parsing')">
      <span class="sidebar-item-icon">üìÑ</span>
      <span class="sidebar-item-text">ÌååÏã± (ÏóÖÎ°úÎìú)</span>
      <span class="sidebar-item-badge blue">5</span>
    </div>
    <div class="sidebar-item" data-page="verification" onclick="switchPage('verification')">
      <span class="sidebar-item-icon">‚úÖ</span>
      <span class="sidebar-item-text">Í≤ÄÏ¶ù</span>
      <span class="sidebar-item-badge red">2</span>
    </div>
    <div class="sidebar-item" data-page="compare" onclick="switchPage('compare')">
      <span class="sidebar-item-icon">üîÑ</span>
      <span class="sidebar-item-text">Í≤¨Ï†ÅÏÑú ÎπÑÍµê</span>
    </div>
    <div class="sidebar-item" data-page="report" onclick="switchPage('report')">
      <span class="sidebar-item-icon">üìä</span>
      <span class="sidebar-item-text">Í≤ÄÏ¶ù Î¶¨Ìè¨Ìä∏</span>
    </div>
    <div class="sidebar-item" data-page="insight" onclick="switchPage('insight')">
      <span class="sidebar-item-icon">üí°</span>
      <span class="sidebar-item-text">Ïù∏ÏÇ¨Ïù¥Ìä∏ Ïä§ÌäúÎîîÏò§</span>
    </div>
    <div class="sidebar-divider"></div>
    <div class="sidebar-section">Í¥ÄÎ¶¨</div>
    <div class="sidebar-item" data-page="model" onclick="switchPage('model')">
      <span class="sidebar-item-icon">‚öôÔ∏è</span>
      <span class="sidebar-item-text">ÏõêÍ∞Ä Î™®Îç∏Í¥ÄÎ¶¨</span>
    </div>
    <div class="sidebar-item" data-page="history" onclick="switchPage('history')">
      <span class="sidebar-item-icon">üïê</span>
      <span class="sidebar-item-text">Ïù¥Î†• / ÏïåÎ¶º</span>
      <span class="sidebar-item-badge orange">3</span>
    </div>
    <div class="sidebar-item" data-page="settings" onclick="switchPage('settings')">
      <span class="sidebar-item-icon">üë§</span>
      <span class="sidebar-item-text">ÏÑ§Ï†ï</span>
    </div>
  </nav>
  <div class="sidebar-divider"></div>
  <div class="sidebar-item" onclick="handleLogout()" style="color:#ff6b6b;">
    <span class="sidebar-item-icon">üö™</span>
    <span class="sidebar-item-text">Î°úÍ∑∏ÏïÑÏõÉ</span>
  </div>
  <div class="sidebar-footer">
    <div class="sidebar-avatar">HY</div>
    <div class="sidebar-user-info">
      <div class="sidebar-user-name">HANY</div>
      <div class="sidebar-user-role">Íµ¨Îß§ Îã¥ÎãπÏûê</div>
    </div>
  </div>
</div>

<div class="main-wrapper" id="mainWrapper">

<!-- Top Header Bar (common) -->
<div class="top-header" id="topHeader">
  <div class="header-bell" onclick="switchPage('history')" title="ÏïåÎ¶º">
    üîî<div class="bell-dot"></div>
  </div>
  <div class="header-help" onclick="openHelpGuide()" title="ÎèÑÏõÄÎßê">‚ùì</div>
  <div class="header-user-btn" onclick="switchPage('settings')">
    <div class="header-user-avatar">HY</div>
    <span>HANY</span>
  </div>
</div>

<!-- ===== 1. Dashboard ===== -->
<div class="dashboard-page" id="dashboardPage">
  <div class="page-header">
    <div class="page-title">ÎåÄÏãúÎ≥¥Îìú</div>
    <div class="page-subtitle">Í≤¨Ï†ÅÏÑú Î∂ÑÏÑù ÌòÑÌô©ÏùÑ ÌïúÎààÏóê ÌôïÏù∏ÌïòÏÑ∏Ïöî</div>
  </div>

  <div class="dash-period-filter">
    <button class="period-btn" onclick="setPeriod(this)">Ïù¥Î≤àÏ£º</button>
    <button class="period-btn active" onclick="setPeriod(this)">Ïù¥Î≤àÎã¨</button>
    <button class="period-btn" onclick="setPeriod(this)">Î∂ÑÍ∏∞</button>
    <button class="period-btn" onclick="setPeriod(this)">Ï†ÑÏ≤¥</button>
  </div>

  <div class="dash-grid">
    <div class="dash-card" onclick="switchPage('parsing')">
      <div class="dash-card-label">üìÑ Ï¥ù Í≤¨Ï†ÅÏÑú</div>
      <div class="dash-card-value">47</div>
      <div class="dash-card-change neutral">Ïù¥Î≤à Îã¨ +12Í±¥</div>
    </div>
    <div class="dash-card" onclick="switchPage('verification')">
      <div class="dash-card-label">‚úÖ Í≤ÄÏ¶ù ÏôÑÎ£å</div>
      <div class="dash-card-value" style="color:var(--green);">38</div>
      <div class="dash-card-change neutral">ÏôÑÎ£åÏú® 80.9%</div>
    </div>
    <div class="dash-card" onclick="switchPage('verification')">
      <div class="dash-card-label">‚ö†Ô∏è Ïù¥ÏÉÅÏπò Í∞êÏßÄ</div>
      <div class="dash-card-value" style="color:var(--red);">7</div>
      <div class="dash-card-change up">Ï†ÑÏõî ÎåÄÎπÑ +2Í±¥</div>
    </div>
    <div class="dash-card" onclick="switchPage('report')">
      <div class="dash-card-label">üí∞ Ï†àÍ∞ê Í∏∞Ìöå</div>
      <div class="dash-card-value" style="color:var(--blue);">‚Ç©12.3M</div>
      <div class="dash-card-change down">AI Ï∂îÏ≤ú Í∏∞Ï§Ä</div>
    </div>
  </div>

  <div class="dash-quick-actions">
    <button class="dash-quick-btn primary-action" onclick="switchPage('parsing')">üìÅ ÏÉà Í≤¨Ï†ÅÏÑú ÏóÖÎ°úÎìú</button>
    <button class="dash-quick-btn" onclick="switchPage('insight')">üí° AI Î∂ÑÏÑù ÏãúÏûë</button>
    <button class="dash-quick-btn" onclick="switchPage('compare')">üîÑ Í≤¨Ï†ÅÏÑú ÎπÑÍµê</button>
    <button class="dash-quick-btn" onclick="switchPage('report')">üìä Î¶¨Ìè¨Ìä∏ Î≥¥Í∏∞</button>
  </div>

  <div class="dash-two-col">
    <div>
      <div class="dash-section-header">
        <div class="dash-section-title">ÏµúÍ∑º Î∂ÑÏÑù Í≤¨Ï†ÅÏÑú</div>
        <button class="btn" style="font-size:12px;" onclick="switchPage('parsing')">Ï†ÑÏ≤¥Î≥¥Í∏∞ ‚Üí</button>
      </div>
      <table class="dash-recent-table">
        <thead><tr><th>Î¨∏ÏÑúÎ™Ö</th><th>ÏÉÅÌÉú</th><th>Ïù¥ÏÉÅÏπò</th><th>ÏóÖÎ°úÎìúÏùº</th></tr></thead>
        <tbody>
          <tr onclick="switchPage('verification')"><td class="file-name">HEAD_LINING_ÏõêÍ∞ÄÍ≥ÑÏÇ∞ÏÑú.xlsx</td><td><span class="file-status fs-complete">‚úÖ ÏôÑÎ£å</span></td><td><span style="color:var(--red);font-weight:600;">2Í±¥</span></td><td>2026-02-18</td></tr>
          <tr onclick="switchPage('parsing')"><td class="file-name">CONSOLE_BOX_ÏõêÍ∞ÄÎ™ÖÏÑ∏.xlsx</td><td><span class="file-status fs-extracting">‚è≥ Ï∂îÏ∂úÏ§ë</span></td><td>‚Äî</td><td>2026-02-19</td></tr>
          <tr onclick="switchPage('verification')"><td class="file-name">DOOR_TRIM_Í≤¨Ï†ÅÏÑú.xlsx</td><td><span class="file-status fs-complete">‚úÖ ÏôÑÎ£å</span></td><td><span style="color:var(--gray);">0Í±¥</span></td><td>2026-02-17</td></tr>
          <tr><td class="file-name">BUMPER_ASSY_Q4Í≤¨Ï†Å.xlsx</td><td><span class="file-status fs-analyzing">üü£ Î∂ÑÏÑùÏôÑÎ£å</span></td><td><span style="color:var(--gray);">0Í±¥</span></td><td>2026-02-15</td></tr>
          <tr><td class="file-name">SEAT_COVER_ÏõêÍ∞ÄÎ∂ÑÏÑù.xlsx</td><td><span class="file-status fs-failed">‚ùå Ïã§Ìå®</span></td><td>‚Äî</td><td>2026-02-16</td></tr>
        </tbody>
      </table>
    </div>
    <div>
      <div class="dash-section-header"><div class="dash-section-title">ÏïåÎ¶º</div></div>
      <div class="dash-alerts">
        <div class="dash-alert" onclick="switchPage('verification')"><div class="dash-alert-icon">üî¥</div><div class="dash-alert-content"><div class="dash-alert-title">SKIN ÌëúÌîºÏû¨ Ïù¥ÏÉÅÏπò Í∞êÏßÄ</div><div class="dash-alert-desc">HEAD_LINING ‚Äî Í≥ºÍ±∞ ÎåÄÎπÑ +35% ÎÜíÏùå</div></div><div class="dash-alert-time">30Î∂Ñ Ï†Ñ</div></div>
        <div class="dash-alert" onclick="switchPage('parsing')"><div class="dash-alert-icon">‚úÖ</div><div class="dash-alert-content"><div class="dash-alert-title">DOOR_TRIM Ï∂îÏ∂ú ÏôÑÎ£å</div><div class="dash-alert-desc">18Í±¥ ÌååÏã± ¬∑ Ïù¥ÏÉÅÏπò ÏóÜÏùå</div></div><div class="dash-alert-time">1ÏãúÍ∞Ñ Ï†Ñ</div></div>
        <div class="dash-alert"><div class="dash-alert-icon">‚ö†Ô∏è</div><div class="dash-alert-content"><div class="dash-alert-title">SEAT_COVER Ï∂îÏ∂ú Ïã§Ìå®</div><div class="dash-alert-desc">Î≥ëÌï© ÏÖÄ Ï§ëÏ≤© Ïò§Î•ò ‚Äî Ïû¨ÏóÖÎ°úÎìú ÌïÑÏöî</div></div><div class="dash-alert-time">3ÏãúÍ∞Ñ Ï†Ñ</div></div>
        <div class="dash-alert" onclick="switchPage('compare')"><div class="dash-alert-icon">üìä</div><div class="dash-alert-content"><div class="dash-alert-title">Q3 ÎåÄÎπÑ ÏõêÍ∞Ä Î≥ÄÎèô Î¶¨Ìè¨Ìä∏</div><div class="dash-alert-desc">BUMPER ASSY Ïû¨Î£åÎπÑ +8.2% ÏÉÅÏäπ</div></div><div class="dash-alert-time">Ïñ¥Ï†ú</div></div>
      </div>
    </div>
  </div>

  <div class="dash-section">
    <div class="dash-section-header"><div class="dash-section-title">ÏõêÍ∞Ä Íµ¨ÏÑ± Ï∂îÏù¥</div></div>
    <div class="dash-chart-placeholder"><div class="chart-icon">üìà</div><div style="font-size:14px;font-weight:600;margin-bottom:4px;">ÏõîÎ≥Ñ ÏõêÍ∞Ä Íµ¨ÏÑ± Ï∂îÏù¥ Ï∞®Ìä∏</div><div style="font-size:12px;">Ïû¨Î£åÎπÑ ¬∑ Í∞ÄÍ≥µÎπÑ ¬∑ Ï†úÍ≤ΩÎπÑ ÎπÑÏú® Î≥ÄÌôîÎ•º ÏãúÍ∞ÅÌôîÌï©ÎãàÎã§</div></div>
  </div>
</div>

<!-- ===== 2. Parsing ===== -->
<div class="parsing-container" id="parsingPage">
  <div class="page-header">
    <div class="page-title">Í≤¨Ï†ÅÏÑú ÌååÏã±</div>
    <div class="page-subtitle">ÌååÏùºÏùÑ ÏóÖÎ°úÎìúÌïòÎ©¥ AIÍ∞Ä ÏûêÎèôÏúºÎ°ú Îç∞Ïù¥ÌÑ∞Î•º Ï∂îÏ∂úÌï©ÎãàÎã§</div>
  </div>
  <div class="upload-area" id="uploadArea">
    <div class="upload-icon">üìÅ</div>
    <div class="upload-text">ÌååÏùºÏùÑ ÎìúÎûòÍ∑∏ÌïòÍ±∞ÎÇò <strong>ÌÅ¥Î¶≠ÌïòÏó¨ ÏóÖÎ°úÎìú</strong></div>
    <div class="upload-formats">ÏßÄÏõê ÌòïÏãù: xls, xlsx, Ïù¥ÎØ∏ÏßÄ(jpg, png) ¬∑ ÏµúÎåÄ 50MB ¬∑ Îã§Ï§ë ÌååÏùº Í∞ÄÎä•</div>
  </div>
  <div class="upload-queue" id="uploadQueue">
    <div class="upload-queue-item"><span>üìÑ</span><span class="upload-queue-name">ÏÉàÌååÏùº_Í≤¨Ï†ÅÏÑú.xlsx</span><div class="upload-queue-progress"><div class="upload-queue-fill" style="width:45%"></div></div><span style="font-size:11px;color:var(--gray);">45%</span><button class="upload-queue-cancel" onclick="this.parentElement.remove(); showToast('info','ÏóÖÎ°úÎìúÍ∞Ä Ï∑®ÏÜåÎêòÏóàÏäµÎãàÎã§.')">‚úï</button></div>
  </div>
  <div class="parsing-search">
    <input class="parsing-search-input" placeholder="Î¨∏ÏÑúÎ™ÖÏúºÎ°ú Í≤ÄÏÉâ..." oninput="searchFiles(this.value)" />
    <button class="parsing-filter-btn">üîç ÏÉÅÏÑ∏Ï°∞Ìöå</button>
  </div>
  <div class="parsing-toolbar">
    <div class="select-all-wrap"><input type="checkbox" class="file-checkbox" id="selectAllFiles" onchange="toggleSelectAll(this.checked)"> <label for="selectAllFiles">Ï†ÑÏ≤¥ ÏÑ†ÌÉù</label></div>
    <button class="btn" onclick="showToast('info','ÏÑ†ÌÉùÎêú ÌååÏùºÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.')">üóë ÏùºÍ¥Ñ ÏÇ≠Ï†ú</button>
    <button class="btn" onclick="showToast('info','ÏÑ†ÌÉùÎêú ÌååÏùºÏùÑ Îã§Ïö¥Î°úÎìúÌï©ÎãàÎã§.')">üì• ÏùºÍ¥Ñ Îã§Ïö¥Î°úÎìú</button>
  </div>
  <div class="status-cards">
    <div class="status-card sc-all active" onclick="filterFiles('all')"><div class="status-card-count">5</div><div class="status-card-label">Ï†ÑÏ≤¥</div></div>
    <div class="status-card sc-extracting" onclick="filterFiles('extracting')"><div class="status-card-count">1</div><div class="status-card-label">Ï∂îÏ∂úÏ§ë</div></div>
    <div class="status-card sc-complete" onclick="filterFiles('complete')"><div class="status-card-count">2</div><div class="status-card-label">ÏôÑÎ£å</div></div>
    <div class="status-card sc-failed" onclick="filterFiles('failed')"><div class="status-card-count">1</div><div class="status-card-label">Ïã§Ìå®</div></div>
    <div class="status-card sc-analyzing" onclick="filterFiles('analyzing')"><div class="status-card-count">1</div><div class="status-card-label">Î∂ÑÏÑùÏôÑÎ£å</div></div>
  </div>
  <div class="file-list">
    <table class="file-table">
      <thead><tr><th style="width:30px;"><input type="checkbox" class="file-checkbox" onchange="toggleSelectAll(this.checked)"></th><th>Î¨∏ÏÑúÎ™Ö</th><th style="width:100px;">ÏÉÅÌÉú</th><th style="width:100px;">ÏßÑÌñâÎ•†</th><th style="width:80px;">ÌååÏã±Ìï≠Î™©</th><th style="width:80px;">Ïù¥ÏÉÅÏπò</th><th style="width:100px;">ÏóÖÎ°úÎìúÏùº</th><th style="width:160px;">Ïï°ÏÖò</th></tr></thead>
      <tbody id="fileTableBody">
        <tr class="file-row" data-status="extracting" onclick="openDrawer('extracting')"><td onclick="event.stopPropagation()"><input type="checkbox" class="file-checkbox"></td><td class="file-name">CONSOLE_BOX_ÏõêÍ∞ÄÎ™ÖÏÑ∏.xlsx</td><td><span class="file-status fs-extracting">‚è≥ Ï∂îÏ∂úÏ§ë</span></td><td><div class="file-progress"><div class="file-progress-fill" style="width:65%;background:var(--orange);"></div></div><span style="font-size:11px;color:var(--gray);">65%</span></td><td style="color:var(--gray);">‚Äî</td><td style="color:var(--gray);">‚Äî</td><td>2026-02-19</td><td><button class="file-action-btn disabled">ÏÉÅÏÑ∏Î≥¥Í∏∞</button></td></tr>
        <tr class="file-row" data-status="complete" onclick="openDrawer('complete')"><td onclick="event.stopPropagation()"><input type="checkbox" class="file-checkbox"></td><td class="file-name">HEAD_LINING_ÏõêÍ∞ÄÍ≥ÑÏÇ∞ÏÑú.xlsx</td><td><span class="file-status fs-complete">‚úÖ Ï∂îÏ∂úÏôÑÎ£å</span></td><td><div class="file-progress"><div class="file-progress-fill" style="width:100%;background:var(--green);"></div></div><span style="font-size:11px;color:var(--gray);">100%</span></td><td>24Í±¥</td><td><span style="color:var(--red);font-weight:600;">2Í±¥</span></td><td>2026-02-18</td><td><button class="file-action-btn primary" onclick="event.stopPropagation(); switchPage('verification')">Í≤ÄÏ¶ùÌïòÍ∏∞</button></td></tr>
        <tr class="file-row" data-status="complete"><td onclick="event.stopPropagation()"><input type="checkbox" class="file-checkbox"></td><td class="file-name">DOOR_TRIM_Í≤¨Ï†ÅÏÑú.xlsx</td><td><span class="file-status fs-complete">‚úÖ Ï∂îÏ∂úÏôÑÎ£å</span></td><td><div class="file-progress"><div class="file-progress-fill" style="width:100%;background:var(--green);"></div></div><span style="font-size:11px;color:var(--gray);">100%</span></td><td>18Í±¥</td><td><span style="color:var(--gray);">0Í±¥</span></td><td>2026-02-17</td><td><button class="file-action-btn primary">Í≤ÄÏ¶ùÌïòÍ∏∞</button></td></tr>
        <tr class="file-row" data-status="failed" onclick="openDrawer('failed')"><td onclick="event.stopPropagation()"><input type="checkbox" class="file-checkbox"></td><td class="file-name">SEAT_COVER_ÏõêÍ∞ÄÎ∂ÑÏÑù.xlsx</td><td><span class="file-status fs-failed">‚ùå Ï∂îÏ∂úÏã§Ìå®</span></td><td><div class="file-progress"><div class="file-progress-fill" style="width:30%;background:var(--red);"></div></div><span style="font-size:11px;color:var(--gray);">30%</span></td><td style="color:var(--gray);">‚Äî</td><td style="color:var(--gray);">‚Äî</td><td>2026-02-16</td><td><button class="file-action-btn" style="color:var(--red);border-color:var(--red);">Ïã§Ìå®ÏÇ¨Ïú†</button> <button class="file-action-btn" onclick="event.stopPropagation(); showToast('info','Ïû¨ÏãúÎèÑÎ•º ÏãúÏûëÌï©ÎãàÎã§...')">Ïû¨ÏãúÎèÑ</button></td></tr>
        <tr class="file-row" data-status="analyzing"><td onclick="event.stopPropagation()"><input type="checkbox" class="file-checkbox"></td><td class="file-name">BUMPER_ASSY_Q4Í≤¨Ï†Å.xlsx</td><td><span class="file-status fs-analyzing">üü£ Î∂ÑÏÑùÏôÑÎ£å</span></td><td><div class="file-progress"><div class="file-progress-fill" style="width:100%;background:var(--purple);"></div></div><span style="font-size:11px;color:var(--gray);">100%</span></td><td>32Í±¥</td><td><span style="color:var(--gray);">0Í±¥</span></td><td>2026-02-15</td><td><button class="file-action-btn primary">ÏÉÅÏÑ∏Î≥¥Í∏∞</button></td></tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Detail Drawer -->
<div class="detail-drawer" id="detailDrawer">
  <div id="drawer-extracting" style="display:none;flex-direction:column;height:100%;">
    <div class="drawer-header"><div><div style="font-size:15px;font-weight:600;">CONSOLE_BOX_ÏõêÍ∞ÄÎ™ÖÏÑ∏.xlsx</div><div style="font-size:12px;color:var(--gray);margin-top:2px;">Ï∂îÏ∂ú ÏßÑÌñâÏ§ë...</div></div><button class="popup-close" onclick="closeDrawer()">‚úï</button></div>
    <div class="drawer-body">
      <div class="drawer-section"><div class="drawer-section-title">ÌååÏùº Ï†ïÎ≥¥</div><div class="drawer-info-grid"><div class="drawer-info-item"><div class="drawer-info-label">ÌååÏùº ÌÅ¨Í∏∞</div><div class="drawer-info-value">2.4 MB</div></div><div class="drawer-info-item"><div class="drawer-info-label">ÏãúÌä∏ Ïàò</div><div class="drawer-info-value">3Í∞ú</div></div><div class="drawer-info-item"><div class="drawer-info-label">ÏóÖÎ°úÎìú ÏãúÍ∞Ñ</div><div class="drawer-info-value">14:32:15</div></div><div class="drawer-info-item"><div class="drawer-info-label">ÏòàÏÉÅ ÏôÑÎ£å</div><div class="drawer-info-value">~2Î∂Ñ</div></div></div></div>
      <div class="drawer-section"><div class="drawer-section-title">Ï∂îÏ∂ú ÏßÑÌñâ</div><div style="margin-bottom:12px;"><div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:4px;"><span>Ï†ÑÏ≤¥ ÏßÑÌñâÎ•†</span><span style="font-weight:600;color:var(--orange);">65%</span></div><div class="file-progress" style="width:100%;height:8px;"><div class="file-progress-fill" style="width:65%;background:linear-gradient(90deg,var(--orange),#ffb340);"></div></div></div><div style="font-size:12px;color:var(--gray);display:flex;flex-direction:column;gap:6px;"><div>‚úÖ Sheet 1 ‚Äî Íµ¨Ï°∞ Î∂ÑÏÑù ÏôÑÎ£å</div><div>‚úÖ Sheet 2 ‚Äî ÏÖÄ Îß§Ìïë ÏôÑÎ£å</div><div>‚è≥ Sheet 3 ‚Äî Îç∞Ïù¥ÌÑ∞ Í≤ÄÏ¶ù Ï§ë...</div></div></div>
      <div class="drawer-section"><div class="drawer-section-title">Ï∂îÏ∂ú Î°úÍ∑∏</div><div class="extraction-log"><div class="log-line"><span class="log-time">14:32:16</span> <span class="log-info">ÌååÏùº ÏóÖÎ°úÎìú ÏôÑÎ£å (2.4MB)</span></div><div class="log-line"><span class="log-time">14:32:18</span> <span class="log-ok">Sheet 1 Íµ¨Ï°∞ Î∂ÑÏÑù ÏãúÏûë</span></div><div class="log-line"><span class="log-time">14:32:45</span> <span class="log-ok">Sheet 1 ÌååÏã± ÏôÑÎ£å ‚Äî 12Í∞ú Ìï≠Î™©</span></div><div class="log-line"><span class="log-time">14:33:10</span> <span class="log-warn">Sheet 2 Î≥ëÌï©ÏÖÄ Í∞êÏßÄ ‚Äî ÏûêÎèô Î∂ÑÎ¶¨</span></div><div class="log-line"><span class="log-time">14:33:22</span> <span class="log-ok">Sheet 2 ÌååÏã± ÏôÑÎ£å ‚Äî 8Í∞ú Ìï≠Î™©</span></div><div class="log-line"><span class="log-time">14:33:23</span> <span class="log-info">Sheet 3 Îç∞Ïù¥ÌÑ∞ Í≤ÄÏ¶ù Ï§ë...</span></div></div></div>
    </div>
  </div>
  <div id="drawer-complete" style="display:none;flex-direction:column;height:100%;">
    <div class="drawer-header"><div><div style="font-size:15px;font-weight:600;">HEAD_LINING_ÏõêÍ∞ÄÍ≥ÑÏÇ∞ÏÑú.xlsx</div><div style="font-size:12px;color:var(--green);margin-top:2px;">‚úÖ Ï∂îÏ∂ú ÏôÑÎ£å</div></div><button class="popup-close" onclick="closeDrawer()">‚úï</button></div>
    <div class="drawer-body"><div class="drawer-section"><div class="drawer-section-title">Ï∂îÏ∂ú Í≤∞Í≥º ÏöîÏïΩ</div><div class="drawer-info-grid"><div class="drawer-info-item"><div class="drawer-info-label">ÌååÏã± Ìï≠Î™©</div><div class="drawer-info-value" style="color:var(--blue);">24Í±¥</div></div><div class="drawer-info-item"><div class="drawer-info-label">Ïù¥ÏÉÅÏπò</div><div class="drawer-info-value" style="color:var(--red);">2Í±¥</div></div><div class="drawer-info-item"><div class="drawer-info-label">Ïã†Î¢∞ÎèÑ</div><div class="drawer-info-value" style="color:var(--green);">92%</div></div><div class="drawer-info-item"><div class="drawer-info-label">ÏÜåÏöîÏãúÍ∞Ñ</div><div class="drawer-info-value">1Î∂Ñ 48Ï¥à</div></div></div></div></div>
    <div class="drawer-footer"><button class="btn btn-primary" style="flex:1;text-align:center;padding:10px;" onclick="closeDrawer(); switchPage('verification')">Í≤ÄÏ¶ùÌïòÍ∏∞ ‚Üí</button></div>
  </div>
  <div id="drawer-failed" style="display:none;flex-direction:column;height:100%;">
    <div class="drawer-header"><div><div style="font-size:15px;font-weight:600;">SEAT_COVER_ÏõêÍ∞ÄÎ∂ÑÏÑù.xlsx</div><div style="font-size:12px;color:var(--red);margin-top:2px;">‚ùå Ï∂îÏ∂ú Ïã§Ìå®</div></div><button class="popup-close" onclick="closeDrawer()">‚úï</button></div>
    <div class="drawer-body"><div class="drawer-section"><div class="drawer-section-title">Ïã§Ìå® Ï†ïÎ≥¥</div><div class="error-box"><div class="error-title">‚ö†Ô∏è ÌååÏã± Ïò§Î•ò ‚Äî ÏñëÏãù Ïù∏Ïãù Ïã§Ìå®</div><div class="error-detail">Sheet 1Ïùò ÏÖÄ Íµ¨Ï°∞Î•º Ïù∏ÏãùÌï† Ïàò ÏóÜÏäµÎãàÎã§.<br>ÏõêÏù∏: Î≥ëÌï© ÏÖÄÏù¥ Îã§Ï§ë Ï§ëÏ≤©(3Îã®Í≥Ñ Ïù¥ÏÉÅ)ÎêòÏñ¥ ÏûàÏñ¥ ÏûêÎèô ÌååÏã±Ïóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.<br><br><strong>Í∂åÏû• Ï°∞Ïπò:</strong><br>‚Ä¢ ÏóëÏÖÄ ÌååÏùºÏóêÏÑú Î∂àÌïÑÏöîÌïú Î≥ëÌï© ÏÖÄ Ìï¥Ï†ú ÌõÑ Ïû¨ÏóÖÎ°úÎìú<br>‚Ä¢ ÏàòÎèô Îß§Ìïë Î™®ÎìúÎ°ú Ï†ÑÌôòÌïòÏó¨ ÏßÅÏ†ë ÏòÅÏó≠ ÏßÄÏ†ï</div></div></div></div>
    <div class="drawer-footer"><button class="btn btn-outline" style="flex:1;text-align:center;padding:10px;">ÏàòÎèô Îß§Ìïë</button><button class="btn btn-primary" style="flex:1;text-align:center;padding:10px;" onclick="showToast('info','Ïû¨ÏãúÎèÑÎ•º ÏãúÏûëÌï©ÎãàÎã§...')">Ïû¨ÏãúÎèÑ</button></div>
  </div>
</div>
<div id="drawerOverlay" onclick="closeDrawer()" style="display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.3);z-index:59;"></div>

<!-- ===== 3. Verification ===== -->
<div class="header" id="verificationHeader" style="display:none;">
  <div class="header-left"><span class="breadcrumb">Í≤ÄÏ¶ù ></span><h1>HEAD_LINING_ÏõêÍ∞ÄÍ≥ÑÏÇ∞ÏÑú</h1></div>
  <div class="header-right">
    <button class="btn btn-outline" onclick="openPopup()">üìÑ ÏõêÎ≥∏Î≥¥Í∏∞</button>
    <button class="btn btn-outline" onclick="showToast('info','Ï¥àÍ∏∞ÌôîÎêòÏóàÏäµÎãàÎã§.')">Ï¥àÍ∏∞Ìôî</button>
    <button class="btn btn-outline" onclick="showToast('success','Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.')">Ï†ÄÏû•</button>
    <button class="btn btn-primary" onclick="showToast('success','Í≤ÄÏ¶ù ÏôÑÎ£å Î∞è ÌïôÏäµ Îç∞Ïù¥ÌÑ∞Í∞Ä Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.')">ÏôÑÎ£å & ÌïôÏäµ</button>
  </div>
</div>
<div class="status-bar" id="verificationStatusBar" style="display:none;">
  <div class="status-items">
    <div class="status-item"><span class="label">ÏàòÏ†ïÎêú Ìï≠Î™©</span><span class="value">1Í∞ú</span></div>
    <div class="status-item"><span class="label">Ïã†Î¢∞ÎèÑ</span><span class="value green">92%</span></div>
    <div class="status-item"><span class="label">ÌååÏã±Ìï≠Î™©</span><span class="value">24Í±¥</span></div>
    <div class="status-item"><span class="label">Ïù¥ÏÉÅÏπò</span><span class="value red">2Í±¥</span></div>
    <div class="status-item"><span class="label">ÌïòÏúÑ Í≤¨Ï†ÅÏÑú</span><span class="value">3Í∞ú</span></div>
  </div>
  <div class="view-tabs">
    <div class="view-tab active" onclick="switchVerificationTab('standard')">ÌëúÏ§Ä</div>
    <div class="view-tab" onclick="switchVerificationTab('list')">Î¶¨Ïä§Ìä∏</div>
    <div class="view-tab" onclick="switchVerificationTab('graph')">Í¥ÄÍ≥ÑÎèÑ</div>
  </div>
</div>

<div id="verificationPage" style="display:none;">
<!-- Standard View -->
<div class="standard-container" id="standardView" style="display:block;">
  <div style="padding:24px;">
    <div style="display:flex;gap:16px;margin-bottom:24px;">
      <div style="background:#fff;border:1px solid var(--border);border-radius:10px;padding:16px;flex:1;"><div style="font-size:11px;color:var(--gray);margin-bottom:4px;">E.O. NO.</div><div style="font-size:14px;font-weight:600;">EO-2024-1201</div></div>
      <div style="background:#fff;border:1px solid var(--border);border-radius:10px;padding:16px;flex:1;"><div style="font-size:11px;color:var(--gray);margin-bottom:4px;">ÌíàÎ≤à / ÌíàÎ™Ö</div><div style="font-size:14px;font-weight:600;">HL-2024-001 ¬∑ HEAD LINING</div></div>
      <div style="background:#fff;border:1px solid var(--border);border-radius:10px;padding:16px;flex:1;"><div style="font-size:11px;color:var(--gray);margin-bottom:4px;">ÌòëÎ†•ÏÇ¨ / Îã¥ÎãπÏûê</div><div style="font-size:14px;font-weight:600;">ÎåÄÌïú(Ï£º) ¬∑ ÍπÄÏ≤†Ïàò</div></div>
      <div style="background:#fff;border:1px solid var(--border);border-radius:10px;padding:16px;flex:0 0 140px;"><div style="font-size:11px;color:var(--gray);margin-bottom:4px;">ÏÉùÏÇ∞ÏõêÍ∞Ä</div><div style="font-size:18px;font-weight:700;color:var(--blue);">‚Ç©76,800</div></div>
    </div>

    <!-- Ïû¨Î£åÎπÑ -->
    <div class="std-group">
      <div class="std-group-header"><div class="std-group-title"><span class="std-group-icon" style="background:#e8f4fd;color:var(--blue);">‚Ö†</span>Ïû¨Î£åÎπÑ</div><div class="std-group-summary"><span class="std-summary-value">‚Ç©45,200</span><span class="std-summary-pct">58.9%</span><span class="badge badge-error">Ïù¥ÏÉÅÏπò 1</span></div></div>
      <table class="std-table"><thead><tr><th style="width:50px;">Î†àÎ≤®</th><th style="width:80px;">Íµ¨Î∂Ñ</th><th>ÌíàÎ™Ö</th><th>Í∑úÍ≤©</th><th style="width:50px;">Îã®ÏúÑ</th><th style="width:50px;">ÏàòÎüâ</th><th style="width:90px;">Îã®Í∞Ä</th><th style="width:90px;">Í∏àÏï°</th><th style="width:60px;">ÎπÑÏú®</th><th style="width:70px;">Ïã†Î¢∞ÎèÑ</th><th style="width:60px;">ÏÉÅÌÉú</th></tr></thead>
      <tbody>
        <tr><td><span class="level-badge l0">L0</span></td><td>ÏõêÏûêÏû¨</td><td class="std-cell-name">SUBSTRATE (Í∏∞Ïû¨) <span class="has-sub">üìé ÌïòÏúÑ Í≤¨Ï†ÅÏÑú</span></td><td>1200√ó800√ó3T</td><td>EA</td><td>1</td><td>18,500</td><td style="font-weight:600;">18,500</td><td>24.1%</td><td><div class="mini-confidence"><div class="mini-bar" style="width:95%;background:var(--green);"></div></div><span style="font-size:10px;">95%</span></td><td><span class="badge badge-ok">Ï†ïÏÉÅ</span></td></tr>
        <tr class="sub-row"><td><span class="level-badge l1">L1</span></td><td style="color:var(--gray);">ÏõêÏûêÏû¨</td><td class="std-cell-name" style="padding-left:28px;">‚îî BASE MATERIAL</td><td>PP+GF30</td><td>KG</td><td>2.4</td><td>5,000</td><td>12,000</td><td>15.6%</td><td><div class="mini-confidence"><div class="mini-bar" style="width:94%;background:var(--green);"></div></div><span style="font-size:10px;">94%</span></td><td><span class="badge badge-ok">Ï†ïÏÉÅ</span></td></tr>
        <tr class="sub-row"><td><span class="level-badge l1">L1</span></td><td style="color:var(--gray);">Í∞ÄÍ≥µÎπÑ</td><td class="std-cell-name" style="padding-left:28px;">‚îî ÏïïÏ∂ú ÏÑ±Ìòï</td><td></td><td>Ìöå</td><td>1</td><td>6,500</td><td>6,500</td><td>8.5%</td><td><div class="mini-confidence"><div class="mini-bar" style="width:94%;background:var(--green);"></div></div><span style="font-size:10px;">94%</span></td><td><span class="badge badge-ok">Ï†ïÏÉÅ</span></td></tr>
        <tr class="anomaly-row" style="position:relative;"><td><span class="level-badge l0">L0</span></td><td>ÏõêÏûêÏû¨</td><td class="std-cell-name">SKIN (ÌëúÌîºÏû¨) ‚ö†Ô∏è</td><td>PVC 0.8mm</td><td>M¬≤</td><td>1.2</td><td class="editable-cell" onclick="startInlineEdit(this, '18,917')">18,917</td><td class="editable-cell" style="font-weight:600;color:var(--red);" onclick="startInlineEdit(this, '22,700')">22,700</td><td>29.6%</td><td><div class="mini-confidence"><div class="mini-bar" style="width:75%;background:var(--orange);"></div></div><span style="font-size:10px;color:var(--orange);">75%</span></td><td><span class="badge badge-error" style="cursor:pointer;" onclick="toggleAnomalyReason(this)">Ïù¥ÏÉÅÏπò</span><div class="anomaly-reason">Í≥ºÍ±∞ 3Í∞ú Î∂ÑÍ∏∞ ÌèâÍ∑† Îã®Í∞Ä ‚Ç©14,200 ÎåÄÎπÑ +33.2% ÎÜíÏùå. ÎèôÏùº Í∑úÍ≤©(PVC 0.8mm) ÏãúÏû•Í∞Ä Î≤îÏúÑ: ‚Ç©13,500~‚Ç©16,800. ÌòÑÏû¨ Îã®Í∞ÄÍ∞Ä ÏÉÅÌïúÏùÑ Ï¥àÍ≥ºÌï©ÎãàÎã§.</div></td></tr>
        <tr><td><span class="level-badge l0">L0</span></td><td>ÏõêÏûêÏû¨</td><td class="std-cell-name">ADHESIVE (Ï†ëÏ∞©Ï†ú)</td><td>WATER BASE</td><td>KG</td><td>0.5</td><td>4,400</td><td style="font-weight:600;">2,200</td><td>2.9%</td><td><div class="mini-confidence"><div class="mini-bar" style="width:98%;background:var(--green);"></div></div><span style="font-size:10px;">98%</span></td><td><span class="badge badge-ok">Ï†ïÏÉÅ</span></td></tr>
        <tr><td><span class="level-badge l0">L0</span></td><td>Î∂ÄÏûêÏû¨</td><td class="std-cell-name">CLIP</td><td>PA66</td><td>EA</td><td>12</td><td>75</td><td>900</td><td>1.2%</td><td><div class="mini-confidence"><div class="mini-bar" style="width:98%;background:var(--green);"></div></div><span style="font-size:10px;">98%</span></td><td><span class="badge badge-ok">Ï†ïÏÉÅ</span></td></tr>
        <tr><td><span class="level-badge l0">L0</span></td><td>Î∂ÄÏûêÏû¨</td><td class="std-cell-name">PACKING (Ìè¨Ïû•Ïû¨)</td><td>Í≥®ÌåêÏßÄ</td><td>SET</td><td>1</td><td>900</td><td>900</td><td>1.2%</td><td><div class="mini-confidence"><div class="mini-bar" style="width:98%;background:var(--green);"></div></div><span style="font-size:10px;">98%</span></td><td><span class="badge badge-ok">Ï†ïÏÉÅ</span></td></tr>
      </tbody></table>
    </div>

    <!-- Í∞ÄÍ≥µÎπÑ -->
    <div class="std-group">
      <div class="std-group-header"><div class="std-group-title"><span class="std-group-icon" style="background:#e8fde8;color:var(--green);">‚Ö°</span>Í∞ÄÍ≥µÎπÑ</div><div class="std-group-summary"><span class="std-summary-value">‚Ç©23,100</span><span class="std-summary-pct">30.1%</span></div></div>
      <table class="std-table"><thead><tr><th style="width:50px;">Î†àÎ≤®</th><th style="width:80px;">Í≥µÏ†ï</th><th>Í≥µÏ†ïÎ™Ö</th><th>Í∑úÍ≤©</th><th style="width:50px;">Îã®ÏúÑ</th><th style="width:50px;">ÏàòÎüâ</th><th style="width:90px;">Îã®Í∞Ä</th><th style="width:90px;">Í∏àÏï°</th><th style="width:60px;">ÎπÑÏú®</th><th style="width:70px;">Ïã†Î¢∞ÎèÑ</th><th style="width:60px;">ÏÉÅÌÉú</th></tr></thead>
      <tbody>
        <tr><td><span class="level-badge l0">L0</span></td><td>ÏÑ±Ìòï</td><td>ÌîÑÎ†àÏä§ ÏÑ±Ìòï</td><td></td><td>Ìöå</td><td>1</td><td>8,500</td><td style="font-weight:600;">8,500</td><td>11.1%</td><td><div class="mini-confidence"><div class="mini-bar" style="width:96%;background:var(--green);"></div></div><span style="font-size:10px;">96%</span></td><td><span class="badge badge-ok">Ï†ïÏÉÅ</span></td></tr>
        <tr><td><span class="level-badge l0">L0</span></td><td>Ï†ëÏ∞©</td><td>Ï†ëÏ∞© Í≥µÏ†ï</td><td></td><td>Ìöå</td><td>1</td><td>6,200</td><td style="font-weight:600;">6,200</td><td>8.1%</td><td><div class="mini-confidence"><div class="mini-bar" style="width:94%;background:var(--green);"></div></div><span style="font-size:10px;">94%</span></td><td><span class="badge badge-ok">Ï†ïÏÉÅ</span></td></tr>
        <tr><td><span class="level-badge l0">L0</span></td><td>ÌõÑÏ≤òÎ¶¨</td><td>Ìä∏Î¶¨Î∞ç</td><td></td><td>Ìöå</td><td>1</td><td>5,400</td><td style="font-weight:600;">5,400</td><td>7.0%</td><td><div class="mini-confidence"><div class="mini-bar" style="width:92%;background:var(--green);"></div></div><span style="font-size:10px;">92%</span></td><td><span class="badge badge-ok">Ï†ïÏÉÅ</span></td></tr>
        <tr><td><span class="level-badge l0">L0</span></td><td>Í≤ÄÏÇ¨</td><td>Í≤ÄÏÇ¨/Ìè¨Ïû•</td><td></td><td>Ìöå</td><td>1</td><td>3,000</td><td style="font-weight:600;">3,000</td><td>3.9%</td><td><div class="mini-confidence"><div class="mini-bar" style="width:90%;background:var(--green);"></div></div><span style="font-size:10px;">90%</span></td><td><span class="badge badge-ok">Ï†ïÏÉÅ</span></td></tr>
      </tbody></table>
    </div>

    <!-- Ï†úÍ≤ΩÎπÑ -->
    <div class="std-group">
      <div class="std-group-header"><div class="std-group-title"><span class="std-group-icon" style="background:#fde8e8;color:var(--red);">‚Ö¢</span>Ï†úÍ≤ΩÎπÑ</div><div class="std-group-summary"><span class="std-summary-value">‚Ç©8,500</span><span class="std-summary-pct">11.1%</span><span class="badge badge-error">Ïù¥ÏÉÅÏπò 1</span></div></div>
      <table class="std-table"><thead><tr><th style="width:50px;">Î†àÎ≤®</th><th style="width:80px;">Íµ¨Î∂Ñ</th><th>Ìï≠Î™©</th><th colspan="4"></th><th style="width:90px;">Í∏àÏï°</th><th style="width:60px;">ÎπÑÏú®</th><th style="width:70px;">Ïã†Î¢∞ÎèÑ</th><th style="width:60px;">ÏÉÅÌÉú</th></tr></thead>
      <tbody>
        <tr><td><span class="level-badge l0">L0</span></td><td>Í∞êÍ∞ÄÏÉÅÍ∞Å</td><td>Í∞êÍ∞ÄÏÉÅÍ∞ÅÎπÑ</td><td colspan="4"></td><td style="font-weight:600;">3,200</td><td>4.2%</td><td><div class="mini-confidence"><div class="mini-bar" style="width:90%;background:var(--green);"></div></div><span style="font-size:10px;">90%</span></td><td><span class="badge badge-ok">Ï†ïÏÉÅ</span></td></tr>
        <tr><td><span class="level-badge l0">L0</span></td><td>Ïú†Ìã∏Î¶¨Ìã∞</td><td>Ï†ÑÎ†•ÎπÑ</td><td colspan="4"></td><td style="font-weight:600;">2,800</td><td>3.6%</td><td><div class="mini-confidence"><div class="mini-bar" style="width:88%;background:var(--green);"></div></div><span style="font-size:10px;">88%</span></td><td><span class="badge badge-ok">Ï†ïÏÉÅ</span></td></tr>
        <tr class="anomaly-row" style="position:relative;"><td><span class="level-badge l0">L0</span></td><td>Í∏∞ÌÉÄ</td><td>Í∏∞ÌÉÄ Í≤ΩÎπÑ ‚ö†Ô∏è</td><td colspan="4"></td><td class="editable-cell" style="font-weight:600;color:var(--red);" onclick="startInlineEdit(this, '2,500')">2,500</td><td>3.3%</td><td><div class="mini-confidence"><div class="mini-bar" style="width:72%;background:var(--orange);"></div></div><span style="font-size:10px;color:var(--orange);">72%</span></td><td><span class="badge badge-error" style="cursor:pointer;" onclick="toggleAnomalyReason(this)">Ïù¥ÏÉÅÏπò</span><div class="anomaly-reason">Í∏∞ÌÉÄ Í≤ΩÎπÑÍ∞Ä Ï†ÑÏ≤¥ Ï†úÍ≤ΩÎπÑÏùò 29.4%Î•º Ï∞®ÏßÄÌïòÍ≥† ÏûàÏñ¥ ÏùºÎ∞òÏ†Å Î≤îÏúÑ(10~20%)Î•º Ï¥àÍ≥ºÌï©ÎãàÎã§. ÏÑ∏Î∂Ä ÎÇ¥Ïó≠ ÌôïÏù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.</div></td></tr>
      </tbody></table>
    </div>

    <!-- ÏÜåÍ≥Ñ -->
    <div class="std-group">
      <div class="std-group-header std-total-header"><div class="std-group-title"><span class="std-group-icon" style="background:var(--dark);color:#fff;">Œ£</span>ÏÜåÍ≥Ñ (ÏÉùÏÇ∞ÏõêÍ∞Ä)</div><div class="std-group-summary"><span class="std-summary-value" style="font-size:18px;color:var(--blue);">‚Ç©76,800</span><span class="std-summary-pct">100%</span></div></div>
      <table class="std-table"><thead><tr><th>Íµ¨Î∂Ñ</th><th style="width:120px;">Í∏àÏï°</th><th style="width:80px;">ÎπÑÏú®</th><th style="width:200px;">Íµ¨ÏÑ±</th><th style="width:80px;">Ïù¥ÏÉÅÏπò</th></tr></thead>
      <tbody>
        <tr><td style="font-weight:600;">‚Ö†. Ïû¨Î£åÎπÑ</td><td style="font-weight:600;">‚Ç©45,200</td><td>58.9%</td><td><div class="cost-bar"><div class="cost-fill" style="width:58.9%;background:var(--blue);"></div></div></td><td><span style="color:var(--red);font-weight:600;">1Í±¥</span></td></tr>
        <tr><td style="font-weight:600;">‚Ö°. Í∞ÄÍ≥µÎπÑ</td><td style="font-weight:600;">‚Ç©23,100</td><td>30.1%</td><td><div class="cost-bar"><div class="cost-fill" style="width:30.1%;background:var(--green);"></div></div></td><td><span style="color:var(--gray);">0Í±¥</span></td></tr>
        <tr><td style="font-weight:600;">‚Ö¢. Ï†úÍ≤ΩÎπÑ</td><td style="font-weight:600;">‚Ç©8,500</td><td>11.1%</td><td><div class="cost-bar"><div class="cost-fill" style="width:11.1%;background:var(--orange);"></div></div></td><td><span style="color:var(--red);font-weight:600;">1Í±¥</span></td></tr>
        <tr style="background:#f0f4ff;font-weight:700;"><td>Ìï©Í≥Ñ</td><td style="color:var(--blue);font-size:15px;">‚Ç©76,800</td><td>100%</td><td><div class="cost-bar"><div class="cost-fill" style="width:58.9%;background:var(--blue);"></div><div class="cost-fill" style="width:30.1%;background:var(--green);"></div><div class="cost-fill" style="width:11.1%;background:var(--orange);"></div></div></td><td style="color:var(--red);">2Í±¥</td></tr>
      </tbody></table>
    </div>
  </div>
</div>

<!-- List View -->
<div class="list-container" id="listView">
  <div style="padding:24px;">
    <div class="list-group">
      <div class="std-group-header"><div class="std-group-title"><span class="std-group-icon" style="background:#e8f4fd;color:var(--blue);">‚Ö†</span>Ïû¨Î£åÎπÑ</div><div class="std-group-summary"><span class="std-summary-value">‚Ç©45,200</span><span class="std-summary-pct">58.9%</span><span class="badge badge-error">Ïù¥ÏÉÅÏπò 1</span></div></div>
      <div class="list-row list-row-header"><div></div><div>Íµ¨Î∂Ñ</div><div>ÌíàÎ™Ö</div><div>Í∑úÍ≤©</div><div>Îã®ÏúÑ</div><div>ÏàòÎüâ</div><div>Îã®Í∞Ä</div><div>Í∏àÏï°</div><div>ÎπÑÏú®</div><div>Ïã†Î¢∞ÎèÑ</div><div>ÏÉÅÌÉú</div></div>
      <div class="list-row" onclick="toggleAccordion(this)"><div><button class="accordion-toggle" data-target="sub-substrate">‚ñ∂</button></div><div>ÏõêÏûêÏû¨</div><div class="std-cell-name">SUBSTRATE (Í∏∞Ïû¨) <span class="has-sub">üìé ÌïòÏúÑ</span></div><div>1200√ó800√ó3T</div><div>EA</div><div>1</div><div>18,500</div><div style="font-weight:600;">18,500</div><div>24.1%</div><div><div class="mini-confidence"><div class="mini-bar" style="width:95%;background:var(--green);"></div></div><span style="font-size:10px;">95%</span></div><div><span class="badge badge-ok">Ï†ïÏÉÅ</span></div></div>
      <div class="accordion-children" id="sub-substrate">
        <div class="list-row"><div><button class="accordion-toggle no-child">‚ñ∂</button></div><div style="color:var(--gray);">Ïû¨Î£å</div><div><span class="child-connector">‚îî</span>BASE MATERIAL</div><div>PP+GF30</div><div>KG</div><div>2.4</div><div>5,000</div><div>12,000</div><div>15.6%</div><div><div class="mini-confidence"><div class="mini-bar" style="width:94%;background:var(--green);"></div></div><span style="font-size:10px;">94%</span></div><div><span class="badge badge-ok">Ï†ïÏÉÅ</span></div></div>
        <div class="list-row"><div><button class="accordion-toggle no-child">‚ñ∂</button></div><div style="color:var(--gray);">Í∞ÄÍ≥µ</div><div><span class="child-connector">‚îî</span>ÏïïÏ∂ú ÏÑ±Ìòï</div><div></div><div>Ìöå</div><div>1</div><div>6,500</div><div>6,500</div><div>8.5%</div><div><div class="mini-confidence"><div class="mini-bar" style="width:94%;background:var(--green);"></div></div><span style="font-size:10px;">94%</span></div><div><span class="badge badge-ok">Ï†ïÏÉÅ</span></div></div>
      </div>
      <div class="list-row anomaly-row"><div><button class="accordion-toggle no-child">‚ñ∂</button></div><div>ÏõêÏûêÏû¨</div><div class="std-cell-name">SKIN (ÌëúÌîºÏû¨) ‚ö†Ô∏è</div><div>PVC 0.8mm</div><div>M¬≤</div><div>1.2</div><div>18,917</div><div style="font-weight:600;color:var(--red);">22,700</div><div>29.6%</div><div><div class="mini-confidence"><div class="mini-bar" style="width:75%;background:var(--orange);"></div></div><span style="font-size:10px;color:var(--orange);">75%</span></div><div><span class="badge badge-error">Ïù¥ÏÉÅÏπò</span></div></div>
      <div class="list-row"><div><button class="accordion-toggle no-child">‚ñ∂</button></div><div>ÏõêÏûêÏû¨</div><div>ADHESIVE (Ï†ëÏ∞©Ï†ú)</div><div>WATER BASE</div><div>KG</div><div>0.5</div><div>4,400</div><div style="font-weight:600;">2,200</div><div>2.9%</div><div><div class="mini-confidence"><div class="mini-bar" style="width:98%;background:var(--green);"></div></div><span style="font-size:10px;">98%</span></div><div><span class="badge badge-ok">Ï†ïÏÉÅ</span></div></div>
    </div>
    <div class="list-group">
      <div class="std-group-header"><div class="std-group-title"><span class="std-group-icon" style="background:#e8fde8;color:var(--green);">‚Ö°</span>Í∞ÄÍ≥µÎπÑ</div><div class="std-group-summary"><span class="std-summary-value">‚Ç©23,100</span><span class="std-summary-pct">30.1%</span></div></div>
      <div class="list-row list-row-header"><div></div><div>Í≥µÏ†ï</div><div>Í≥µÏ†ïÎ™Ö</div><div></div><div>Îã®ÏúÑ</div><div>ÏàòÎüâ</div><div>Îã®Í∞Ä</div><div>Í∏àÏï°</div><div>ÎπÑÏú®</div><div>Ïã†Î¢∞ÎèÑ</div><div>ÏÉÅÌÉú</div></div>
      <div class="list-row"><div><button class="accordion-toggle no-child">‚ñ∂</button></div><div>ÏÑ±Ìòï</div><div>ÌîÑÎ†àÏä§ ÏÑ±Ìòï</div><div></div><div>Ìöå</div><div>1</div><div>8,500</div><div style="font-weight:600;">8,500</div><div>11.1%</div><div><div class="mini-confidence"><div class="mini-bar" style="width:96%;background:var(--green);"></div></div><span style="font-size:10px;">96%</span></div><div><span class="badge badge-ok">Ï†ïÏÉÅ</span></div></div>
      <div class="list-row"><div><button class="accordion-toggle no-child">‚ñ∂</button></div><div>Ï†ëÏ∞©</div><div>Ï†ëÏ∞© Í≥µÏ†ï</div><div></div><div>Ìöå</div><div>1</div><div>6,200</div><div style="font-weight:600;">6,200</div><div>8.1%</div><div><div class="mini-confidence"><div class="mini-bar" style="width:94%;background:var(--green);"></div></div><span style="font-size:10px;">94%</span></div><div><span class="badge badge-ok">Ï†ïÏÉÅ</span></div></div>
    </div>
  </div>
</div>

<!-- Graph View -->
<div class="canvas-container" id="graphView">
  <div class="graph">
    <svg class="connections" viewBox="0 0 1500 900">
      <path class="connection-line" d="M 620,155 C 620,230 230,230 230,310"/>
      <path class="connection-line" d="M 620,155 C 620,230 620,230 620,310"/>
      <path class="connection-line anomaly" d="M 620,155 C 620,230 1010,230 1010,310"/>
    </svg>
    <!-- Root Node -->
    <div class="node root" style="left:490px;top:40px;">
      <div class="node-header"><span class="node-type root-type">ÏµúÏ¢Ö Ï†úÌíà</span><div class="node-badge"><span class="badge badge-error">Ïù¥ÏÉÅÏπò 2</span></div></div>
      <div class="node-title">HEAD LINING</div>
      <div class="node-subtitle">HL-2024-001 ¬∑ ÎåÄÌïú(Ï£º)</div>
      <div class="node-stats">
        <div class="node-stat"><div class="stat-label">ÏÉùÏÇ∞ÏõêÍ∞Ä</div><div class="stat-value" style="color:var(--blue);">‚Ç©76,800</div></div>
        <div class="node-stat"><div class="stat-label">ÌååÏã±Ìï≠Î™©</div><div class="stat-value">24Í±¥</div></div>
      </div>
      <div class="node-footer"><div style="display:flex;align-items:center;gap:4px;"><div class="confidence-bar"><div class="confidence-fill high"></div></div><span style="font-size:10px;color:var(--gray);">92%</span></div><span class="node-action">ÏÉÅÏÑ∏ ‚Üí</span></div>
    </div>
    <!-- Child Nodes -->
    <div class="node" style="left:100px;top:310px;">
      <div class="node-header"><span class="node-type sub-type">ÌïòÏúÑ Î∂ÄÌíà</span></div>
      <div class="node-title">SUBSTRATE (Í∏∞Ïû¨)</div>
      <div class="node-subtitle">PP+GF30 ¬∑ 1200√ó800√ó3T</div>
      <div class="node-stats">
        <div class="node-stat"><div class="stat-label">Í∏àÏï°</div><div class="stat-value">‚Ç©18,500</div></div>
        <div class="node-stat"><div class="stat-label">ÎπÑÏú®</div><div class="stat-value">24.1%</div></div>
      </div>
      <div class="node-footer"><div style="display:flex;align-items:center;gap:4px;"><div class="confidence-bar"><div class="confidence-fill high"></div></div><span style="font-size:10px;color:var(--gray);">95%</span></div><span class="node-action">ÏÉÅÏÑ∏ ‚Üí</span></div>
    </div>
    <div class="node" style="left:490px;top:310px;">
      <div class="node-header"><span class="node-type sub-type">Í∞ÄÍ≥µÎπÑ</span></div>
      <div class="node-title">Í∞ÄÍ≥µÎπÑ Ìï©Í≥Ñ</div>
      <div class="node-subtitle">ÌîÑÎ†àÏä§+Ï†ëÏ∞©+Ìä∏Î¶¨Î∞ç+Í≤ÄÏÇ¨</div>
      <div class="node-stats">
        <div class="node-stat"><div class="stat-label">Í∏àÏï°</div><div class="stat-value">‚Ç©23,100</div></div>
        <div class="node-stat"><div class="stat-label">ÎπÑÏú®</div><div class="stat-value">30.1%</div></div>
      </div>
      <div class="node-footer"><div style="display:flex;align-items:center;gap:4px;"><div class="confidence-bar"><div class="confidence-fill high"></div></div><span style="font-size:10px;color:var(--gray);">94%</span></div><span class="node-action">ÏÉÅÏÑ∏ ‚Üí</span></div>
    </div>
    <div class="node has-anomaly" style="left:880px;top:310px;">
      <div class="node-header"><span class="node-type sub-type">ÏõêÏûêÏû¨</span><div class="node-badge"><span class="badge badge-error">Ïù¥ÏÉÅÏπò</span></div></div>
      <div class="node-title">SKIN (ÌëúÌîºÏû¨) ‚ö†Ô∏è</div>
      <div class="node-subtitle">PVC 0.8mm ¬∑ 1.2 M¬≤</div>
      <div class="node-stats">
        <div class="node-stat"><div class="stat-label">Í∏àÏï°</div><div class="stat-value" style="color:var(--red);">‚Ç©22,700</div></div>
        <div class="node-stat"><div class="stat-label">Í≥ºÍ±∞ÌèâÍ∑†</div><div class="stat-value">‚Ç©14,200</div></div>
      </div>
      <div class="node-footer"><div style="display:flex;align-items:center;gap:4px;"><div class="confidence-bar"><div class="confidence-fill mid"></div></div><span style="font-size:10px;color:var(--orange);">75%</span></div><span class="node-action">ÏàòÏ†ï ‚Üí</span></div>
    </div>
  </div>
  <div class="legend show">
    <div class="legend-item"><div class="legend-dot normal"></div>Ï†ïÏÉÅ Ìï≠Î™©</div>
    <div class="legend-item"><div class="legend-dot warning"></div>Ï£ºÏùò Ìï≠Î™©</div>
    <div class="legend-item"><div class="legend-dot error"></div>Ïù¥ÏÉÅÏπò Ìï≠Î™©</div>
  </div>
</div>
</div>

<!-- ===== 4. Compare Page ===== -->
<div class="compare-page" id="comparePage">
  <div class="page-header">
    <div class="page-title">Í≤¨Ï†ÅÏÑú ÎπÑÍµê</div>
    <div class="page-subtitle">Îëê Í≤¨Ï†ÅÏÑúÏùò ÏõêÍ∞Ä Ìï≠Î™©ÏùÑ ÎπÑÍµêÌï©ÎãàÎã§</div>
  </div>
  <div class="compare-selector">
    <select class="compare-dropdown" id="compareA" onchange="showToast('info','ÎπÑÍµê ÎåÄÏÉÅ AÍ∞Ä Î≥ÄÍ≤ΩÎêòÏóàÏäµÎãàÎã§.')">
      <option>HEAD_LINING_ÏõêÍ∞ÄÍ≥ÑÏÇ∞ÏÑú.xlsx (2026-02-18)</option>
      <option>DOOR_TRIM_Í≤¨Ï†ÅÏÑú.xlsx (2026-02-17)</option>
      <option>BUMPER_ASSY_Q4Í≤¨Ï†Å.xlsx (2026-02-15)</option>
      <option>CONSOLE_BOX_ÏõêÍ∞ÄÎ™ÖÏÑ∏.xlsx (2026-02-19)</option>
    </select>
    <div class="compare-vs">VS</div>
    <select class="compare-dropdown" id="compareB" onchange="showToast('info','ÎπÑÍµê ÎåÄÏÉÅ BÍ∞Ä Î≥ÄÍ≤ΩÎêòÏóàÏäµÎãàÎã§.')">
      <option>HEAD_LINING_Q3_ÏõêÍ∞ÄÍ≥ÑÏÇ∞ÏÑú.xlsx (2025-11-20)</option>
      <option>HEAD_LINING_Q2_ÏõêÍ∞ÄÍ≥ÑÏÇ∞ÏÑú.xlsx (2025-08-15)</option>
      <option>DOOR_TRIM_Q3_Í≤¨Ï†ÅÏÑú.xlsx (2025-11-18)</option>
    </select>
  </div>
  <div class="compare-chart-section">
    <div class="compare-bar-chart">
      <div style="font-size:14px;font-weight:700;margin-bottom:16px;">Ìï≠Î™©Î≥Ñ ÏõêÍ∞Ä ÎπÑÍµê</div>
      <div class="bar-row"><div class="bar-label">Ïû¨Î£åÎπÑ</div><div class="bar-track"><div class="bar-fill-a" style="width:60%;background:var(--blue);opacity:0.7;"></div><div class="bar-fill-b" style="width:55%;background:var(--blue);opacity:0.4;"></div></div><div class="bar-value" style="color:var(--red);">‚Ç©45,200 / ‚Ç©41,800 <br>+8.1%</div></div>
      <div class="bar-row"><div class="bar-label">Í∞ÄÍ≥µÎπÑ</div><div class="bar-track"><div class="bar-fill-a" style="width:30%;background:var(--green);opacity:0.7;"></div><div class="bar-fill-b" style="width:32%;background:var(--green);opacity:0.4;"></div></div><div class="bar-value" style="color:var(--green);">‚Ç©23,100 / ‚Ç©24,200 <br>-4.5%</div></div>
      <div class="bar-row"><div class="bar-label">Ï†úÍ≤ΩÎπÑ</div><div class="bar-track"><div class="bar-fill-a" style="width:11%;background:var(--orange);opacity:0.7;"></div><div class="bar-fill-b" style="width:10%;background:var(--orange);opacity:0.4;"></div></div><div class="bar-value" style="color:var(--red);">‚Ç©8,500 / ‚Ç©7,800 <br>+9.0%</div></div>
      <div style="display:flex;gap:16px;margin-top:12px;font-size:11px;color:var(--gray);"><div>‚ñ† ÌòÑÏû¨ (Q4)</div><div style="opacity:0.5;">‚ñ† Ïù¥Ï†Ñ (Q3)</div></div>
    </div>
  </div>
  <div class="compare-table-wrap">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
      <div style="font-size:14px;font-weight:700;">ÏÉÅÏÑ∏ ÎπÑÍµê ÌÖåÏù¥Î∏î</div>
      <button class="btn" onclick="showToast('success','ÎπÑÍµê Í≤∞Í≥ºÎ•º ExcelÎ°ú Îã§Ïö¥Î°úÎìúÌï©ÎãàÎã§.')">üì• Excel ÎÇ¥Î≥¥ÎÇ¥Í∏∞</button>
    </div>
    <table class="compare-table">
      <thead><tr><th>Ìï≠Î™©</th><th>Íµ¨Î∂Ñ</th><th style="text-align:right;">ÌòÑÏû¨ (A)</th><th style="text-align:right;">Ïù¥Ï†Ñ (B)</th><th style="text-align:right;">Ï∞®Ïù¥</th><th style="text-align:right;">Î≥ÄÎèôÎ•†</th></tr></thead>
      <tbody>
        <tr><td style="font-weight:600;">Ïû¨Î£åÎπÑ ÏÜåÍ≥Ñ</td><td>‚Äî</td><td style="text-align:right;font-weight:600;">‚Ç©45,200</td><td style="text-align:right;">‚Ç©41,800</td><td class="diff-up" style="text-align:right;">+‚Ç©3,400</td><td class="diff-up" style="text-align:right;">+8.1%</td></tr>
        <tr><td style="padding-left:24px;">SUBSTRATE (Í∏∞Ïû¨)</td><td>ÏõêÏûêÏû¨</td><td style="text-align:right;">‚Ç©18,500</td><td style="text-align:right;">‚Ç©18,000</td><td class="diff-up" style="text-align:right;">+‚Ç©500</td><td class="diff-up" style="text-align:right;">+2.8%</td></tr>
        <tr style="background:#fff8f8;"><td style="padding-left:24px;">SKIN (ÌëúÌîºÏû¨) ‚ö†Ô∏è</td><td>ÏõêÏûêÏû¨</td><td style="text-align:right;color:var(--red);font-weight:600;">‚Ç©22,700</td><td style="text-align:right;">‚Ç©16,800</td><td class="diff-up" style="text-align:right;font-weight:700;">+‚Ç©5,900</td><td class="diff-up" style="text-align:right;font-weight:700;">+35.1%</td></tr>
        <tr><td style="padding-left:24px;">ADHESIVE (Ï†ëÏ∞©Ï†ú)</td><td>ÏõêÏûêÏû¨</td><td style="text-align:right;">‚Ç©2,200</td><td style="text-align:right;">‚Ç©2,200</td><td class="diff-same" style="text-align:right;">‚Ç©0</td><td class="diff-same" style="text-align:right;">0%</td></tr>
        <tr><td style="padding-left:24px;">CLIP</td><td>Î∂ÄÏûêÏû¨</td><td style="text-align:right;">‚Ç©900</td><td style="text-align:right;">‚Ç©900</td><td class="diff-same" style="text-align:right;">‚Ç©0</td><td class="diff-same" style="text-align:right;">0%</td></tr>
        <tr><td style="font-weight:600;">Í∞ÄÍ≥µÎπÑ ÏÜåÍ≥Ñ</td><td>‚Äî</td><td style="text-align:right;font-weight:600;">‚Ç©23,100</td><td style="text-align:right;">‚Ç©24,200</td><td class="diff-down" style="text-align:right;">-‚Ç©1,100</td><td class="diff-down" style="text-align:right;">-4.5%</td></tr>
        <tr><td style="font-weight:600;">Ï†úÍ≤ΩÎπÑ ÏÜåÍ≥Ñ</td><td>‚Äî</td><td style="text-align:right;font-weight:600;">‚Ç©8,500</td><td style="text-align:right;">‚Ç©7,800</td><td class="diff-up" style="text-align:right;">+‚Ç©700</td><td class="diff-up" style="text-align:right;">+9.0%</td></tr>
        <tr style="background:#f0f4ff;font-weight:700;"><td>Ìï©Í≥Ñ (ÏÉùÏÇ∞ÏõêÍ∞Ä)</td><td></td><td style="text-align:right;color:var(--blue);">‚Ç©76,800</td><td style="text-align:right;">‚Ç©73,800</td><td class="diff-up" style="text-align:right;">+‚Ç©3,000</td><td class="diff-up" style="text-align:right;">+4.1%</td></tr>
      </tbody>
    </table>
  </div>
</div>

<!-- ===== 5. Report Page ===== -->
<div class="report-page" id="reportPage">
  <div class="page-header">
    <div class="page-title">Í≤ÄÏ¶ù Î¶¨Ìè¨Ìä∏</div>
    <div class="page-subtitle">HEAD_LINING_ÏõêÍ∞ÄÍ≥ÑÏÇ∞ÏÑú.xlsx Í≤ÄÏ¶ù Í≤∞Í≥º Î¶¨Ìè¨Ìä∏</div>
  </div>
  <div class="report-summary-grid">
    <div class="report-card">
      <div class="report-card-title">üìã Í≤ÄÏ¶ù ÏöîÏïΩ</div>
      <div class="report-item"><span class="report-item-label">Î¨∏ÏÑúÎ™Ö</span><span class="report-item-value">HEAD_LINING_ÏõêÍ∞ÄÍ≥ÑÏÇ∞ÏÑú.xlsx</span></div>
      <div class="report-item"><span class="report-item-label">ÌòëÎ†•ÏÇ¨</span><span class="report-item-value">ÎåÄÌïú(Ï£º)</span></div>
      <div class="report-item"><span class="report-item-label">ÌååÏã±Ìï≠Î™©</span><span class="report-item-value">24Í±¥</span></div>
      <div class="report-item"><span class="report-item-label">Ï†ÑÏ≤¥ Ïã†Î¢∞ÎèÑ</span><span class="report-item-value" style="color:var(--green);">92%</span></div>
      <div class="report-item"><span class="report-item-label">Í≤ÄÏ¶ù ÏôÑÎ£åÏùº</span><span class="report-item-value">2026-02-21</span></div>
    </div>
    <div class="report-card">
      <div class="report-card-title">üí∞ ÏõêÍ∞Ä Î∂ÑÏÑù</div>
      <div class="report-item"><span class="report-item-label">ÏÉùÏÇ∞ÏõêÍ∞Ä</span><span class="report-item-value" style="color:var(--blue);">‚Ç©76,800</span></div>
      <div class="report-item"><span class="report-item-label">Ïû¨Î£åÎπÑ</span><span class="report-item-value">‚Ç©45,200 (58.9%)</span></div>
      <div class="report-item"><span class="report-item-label">Í∞ÄÍ≥µÎπÑ</span><span class="report-item-value">‚Ç©23,100 (30.1%)</span></div>
      <div class="report-item"><span class="report-item-label">Ï†úÍ≤ΩÎπÑ</span><span class="report-item-value">‚Ç©8,500 (11.1%)</span></div>
      <div class="report-item"><span class="report-item-label">Ï†ÑÎ∂ÑÍ∏∞ ÎåÄÎπÑ</span><span class="report-item-value" style="color:var(--red);">+4.1%</span></div>
    </div>
    <div class="report-card">
      <div class="report-card-title">‚ö†Ô∏è Ïù¥ÏÉÅÏπò Í∞êÏßÄ (2Í±¥)</div>
      <div class="report-item"><span class="report-item-label">SKIN (ÌëúÌîºÏû¨)</span><span class="report-item-value" style="color:var(--red);">‚Ç©22,700 (+35.1%)</span></div>
      <div style="font-size:12px;color:var(--gray);padding:4px 0 8px;">Í≥ºÍ±∞ 3Î∂ÑÍ∏∞ ÌèâÍ∑† ‚Ç©14,200 ÎåÄÎπÑ Ï¥àÍ≥º. PVC 0.8mm ÏãúÏû•Í∞Ä Î≤îÏúÑ ‚Ç©13,500~‚Ç©16,800</div>
      <div class="report-item"><span class="report-item-label">Í∏∞ÌÉÄ Í≤ΩÎπÑ</span><span class="report-item-value" style="color:var(--red);">‚Ç©2,500 (ÎπÑÏú® Ï¥àÍ≥º)</span></div>
      <div style="font-size:12px;color:var(--gray);padding:4px 0;">Ï†úÍ≤ΩÎπÑ ÎÇ¥ Í∏∞ÌÉÄ Í≤ΩÎπÑ ÎπÑÏú® 29.4%Î°ú ÏùºÎ∞ò Î≤îÏúÑ(10~20%) Ï¥àÍ≥º</div>
    </div>
    <div class="report-card">
      <div class="report-card-title">üí° AI Ï∂îÏ≤ú</div>
      <div style="font-size:13px;line-height:1.6;color:#444;">
        <p style="margin-bottom:8px;">1. <strong>SKIN ÌëúÌîºÏû¨</strong>: ÎèôÏ¢Ö ÏóÖÏ≤¥ Í≤¨Ï†Å Ïû¨ÌôïÏù∏ Í∂åÏû•. ÏõêÏûêÏû¨ ÏãúÏÑ∏ Î≥ÄÎèô Ïó¨Î∂Ä ÌôïÏù∏ ÌïÑÏöî.</p>
        <p style="margin-bottom:8px;">2. <strong>Í∏∞ÌÉÄ Í≤ΩÎπÑ</strong>: ÏÑ∏Î∂Ä ÎÇ¥Ïó≠ ÏöîÏ≤≠ÌïòÏó¨ Ìï≠Î™©Î≥Ñ Í≤ÄÏ¶ù ÌïÑÏöî.</p>
        <p>3. Ï†ÑÏ≤¥Ï†ÅÏúºÎ°ú Í∞ÄÍ≥µÎπÑÎäî Ï†ÅÏ†ï Î≤îÏúÑ ÎÇ¥Ïù¥Î©∞, Ïû¨Î£åÎπÑ Ï§ëÏã¨ ÌòëÏÉÅÏù¥ Ìö®Í≥ºÏ†ÅÏùº Í≤ÉÏúºÎ°ú ÌåêÎã®Îê©ÎãàÎã§.</p>
      </div>
    </div>
  </div>
  <div class="report-actions">
    <button class="btn btn-primary" onclick="showLoading('PDF ÏÉùÏÑ± Ï§ë...', function(){showToast('success','PDF ÌååÏùºÏù¥ Îã§Ïö¥Î°úÎìúÎêòÏóàÏäµÎãàÎã§.')})">üì• PDF Îã§Ïö¥Î°úÎìú</button>
    <button class="btn btn-outline" onclick="showLoading('Excel ÏÉùÏÑ± Ï§ë...', function(){showToast('success','Excel ÌååÏùºÏù¥ Îã§Ïö¥Î°úÎìúÎêòÏóàÏäµÎãàÎã§.')})">üìä Excel Îã§Ïö¥Î°úÎìú</button>
    <button class="btn btn-outline" onclick="openShareModal()">üîó Î¶¨Ìè¨Ìä∏ Í≥µÏú†</button>
    <button class="btn btn-outline" onclick="showToast('info','Î¶¨Ìè¨Ìä∏Î•º Ïù∏ÏáÑÌï©ÎãàÎã§.')">üñ® Ïù∏ÏáÑ</button>
  </div>
</div>

<!-- ===== 6. Insight Studio ===== -->
<div class="insight-container" id="insightPage">
  <div class="insight-layout">
    <div class="insight-sidebar">
      <div class="insight-sidebar-header">
        <button class="insight-new-chat-btn" onclick="newInsightChat()">‚ûï ÏÉà ÎåÄÌôî</button>
      </div>
      <div class="insight-chat-list">
        <div class="insight-chat-item active" onclick="selectChat(this)"><span class="insight-chat-item-icon">üí¨</span><span class="insight-chat-item-text">HEAD LINING ÏõêÍ∞Ä Î∂ÑÏÑù</span><span class="insight-chat-item-time">Ïò§Îäò</span></div>
        <div class="insight-chat-item" onclick="selectChat(this)"><span class="insight-chat-item-icon">üí¨</span><span class="insight-chat-item-text">SKIN ÌëúÌîºÏû¨ Ïù¥ÏÉÅÏπò ÏõêÏù∏</span><span class="insight-chat-item-time">Ïñ¥Ï†ú</span></div>
        <div class="insight-chat-item" onclick="selectChat(this)"><span class="insight-chat-item-icon">üí¨</span><span class="insight-chat-item-text">Q3 ÎåÄÎπÑ ÏõêÍ∞Ä Î≥ÄÎèô Î∂ÑÏÑù</span><span class="insight-chat-item-time">2Ïùº Ï†Ñ</span></div>
        <div class="insight-chat-item" onclick="selectChat(this)"><span class="insight-chat-item-icon">üí¨</span><span class="insight-chat-item-text">Í∞ÄÍ≥µÎπÑ Ï†àÍ∞ê Î∞©Ïïà</span><span class="insight-chat-item-time">1Ï£º Ï†Ñ</span></div>
      </div>
    </div>
    <div class="insight-main">
      <div class="insight-body">
        <div class="insight-welcome" id="insightWelcome" style="display:none;">
          <div class="insight-welcome-icon">üí°</div>
          <div class="insight-welcome-title">Ïù∏ÏÇ¨Ïù¥Ìä∏ Ïä§ÌäúÎîîÏò§</div>
          <div class="insight-welcome-sub">ÏõêÍ∞Ä Îç∞Ïù¥ÌÑ∞Ïóê ÎåÄÌï¥ Î¨¥ÏóáÏù¥Îì† ÏßàÎ¨∏ÌïòÏÑ∏Ïöî</div>
        </div>
        <div class="insight-suggestions" id="insightSuggestions" style="display:none;">
          <div class="insight-suggestion" onclick="sendSuggestion('HEAD LINING ÏõêÍ∞Ä Íµ¨ÏÑ±ÏùÑ Î∂ÑÏÑùÌï¥Ï§ò')"><span class="insight-suggestion-icon">üìä</span><span class="insight-suggestion-text">HEAD LINING ÏõêÍ∞Ä Íµ¨ÏÑ±ÏùÑ Î∂ÑÏÑùÌï¥Ï§ò</span></div>
          <div class="insight-suggestion" onclick="sendSuggestion('SKIN ÌëúÌîºÏû¨ Ïù¥ÏÉÅÏπò ÏõêÏù∏Ïù¥ Î≠êÏïº?')"><span class="insight-suggestion-icon">‚ö†Ô∏è</span><span class="insight-suggestion-text">SKIN ÌëúÌîºÏû¨ Ïù¥ÏÉÅÏπò ÏõêÏù∏Ïù¥ Î≠êÏïº?</span></div>
          <div class="insight-suggestion" onclick="sendSuggestion('Ï†ÑÎ∂ÑÍ∏∞ ÎåÄÎπÑ ÏõêÍ∞Ä Î≥ÄÎèô ÏöîÏïΩÌï¥Ï§ò')"><span class="insight-suggestion-icon">üîÑ</span><span class="insight-suggestion-text">Ï†ÑÎ∂ÑÍ∏∞ ÎåÄÎπÑ ÏõêÍ∞Ä Î≥ÄÎèô ÏöîÏïΩÌï¥Ï§ò</span></div>
          <div class="insight-suggestion" onclick="sendSuggestion('ÏõêÍ∞Ä Ï†àÍ∞ê Í∞ÄÎä•Ìïú Ìï≠Î™© Ï∂îÏ≤úÌï¥Ï§ò')"><span class="insight-suggestion-icon">üí∞</span><span class="insight-suggestion-text">ÏõêÍ∞Ä Ï†àÍ∞ê Í∞ÄÎä•Ìïú Ìï≠Î™© Ï∂îÏ≤úÌï¥Ï§ò</span></div>
        </div>
        <div class="chat-context-bar"><div class="context-chip">üìÑ HEAD_LINING_ÏõêÍ∞ÄÍ≥ÑÏÇ∞ÏÑú <span class="remove" onclick="this.parentElement.remove()">‚úï</span></div></div>
        <div class="chat-messages" id="chatMessages">
          <div class="chat-msg user"><div class="chat-avatar user-avatar">HY</div><div><div class="chat-bubble">HEAD LINING ÏõêÍ∞Ä Íµ¨ÏÑ±ÏùÑ Î∂ÑÏÑùÌï¥Ï§ò</div><div class="chat-meta">Ïò§ÌõÑ 2:15</div></div></div>
          <div class="chat-msg ai"><div class="chat-avatar ai-avatar">AI</div><div><div class="chat-bubble"><strong>HEAD LINING ÏõêÍ∞Ä Î∂ÑÏÑù Í≤∞Í≥º</strong><br><br>Ï¥ù ÏÉùÏÇ∞ÏõêÍ∞Ä <strong>‚Ç©76,800</strong>Ïùò Íµ¨ÏÑ±:<br><br><table class="chat-table"><thead><tr><th>Íµ¨Î∂Ñ</th><th>Í∏àÏï°</th><th>ÎπÑÏú®</th><th>ÏÉÅÌÉú</th></tr></thead><tbody><tr><td>Ïû¨Î£åÎπÑ</td><td>‚Ç©45,200</td><td>58.9%</td><td>‚ö†Ô∏è Ïù¥ÏÉÅÏπò 1Í±¥</td></tr><tr><td>Í∞ÄÍ≥µÎπÑ</td><td>‚Ç©23,100</td><td>30.1%</td><td>‚úÖ Ï†ïÏÉÅ</td></tr><tr><td>Ï†úÍ≤ΩÎπÑ</td><td>‚Ç©8,500</td><td>11.1%</td><td>‚ö†Ô∏è Ïù¥ÏÉÅÏπò 1Í±¥</td></tr></tbody></table><br>üìå <strong>Ï£ºÏöî Î∞úÍ≤¨:</strong><br>‚Ä¢ SKIN ÌëúÌîºÏû¨ Îã®Í∞ÄÍ∞Ä Í≥ºÍ±∞ ÎåÄÎπÑ <strong style="color:var(--red);">+35.1%</strong> ÏÉÅÏäπ ‚Äî ÏãúÏû•Í∞Ä Î≤îÏúÑ Ï¥àÍ≥º<br>‚Ä¢ Í∏∞ÌÉÄ Í≤ΩÎπÑ ÎπÑÏú®Ïù¥ ÏùºÎ∞ò Î≤îÏúÑÎ•º Ï¥àÍ≥º<br>‚Ä¢ Í∞ÄÍ≥µÎπÑÎäî ÏóÖÏ¢Ö ÌèâÍ∑† Î≤îÏúÑ(25~35%) ÎÇ¥ Ï†ÅÏ†ï</div><div class="chat-meta">Ïò§ÌõÑ 2:15 ¬∑ AI</div></div></div>
        </div>
        <div class="chat-input-area">
          <div class="chat-input-wrap">
            <input class="chat-input" id="chatInput" placeholder="ÏõêÍ∞ÄÏóê ÎåÄÌï¥ ÏßàÎ¨∏ÌïòÏÑ∏Ïöî..." onkeypress="if(event.key==='Enter')sendChat()">
            <button class="chat-attach-btn" title="ÌååÏùº Ï≤®Î∂Ä">üìé</button>
            <button class="chat-send-btn" onclick="sendChat()" title="Ï†ÑÏÜ°">‚ñ∂</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ===== 7. Model Management ===== -->
<div class="model-page" id="modelPage">
  <div class="model-page-header">
    <div><div class="model-page-title">ÏõêÍ∞Ä Î™®Îç∏Í¥ÄÎ¶¨</div><div class="model-page-sub">ÏõêÍ∞Ä Íµ¨Ï°∞ ÏàòÏãù Î∞è Í∏∞Ï§ÄÏùÑ Í¥ÄÎ¶¨Ìï©ÎãàÎã§</div></div>
    <button class="model-add-btn" onclick="openFormulaModal('add')">Ôºã ÏÉà ÏàòÏãù Ï∂îÍ∞Ä</button>
  </div>
  <div class="formula-list">
    <div class="formula-card">
      <div class="formula-card-header"><span class="formula-name">ÏÉùÏÇ∞ÏõêÍ∞Ä</span><span class="formula-badge core">ÌïµÏã¨</span></div>
      <div class="formula-expression"><span>üìê</span><code>ÏÉùÏÇ∞ÏõêÍ∞Ä = Ïû¨Î£åÎπÑ + Í∞ÄÍ≥µÎπÑ + Ï†úÍ≤ΩÎπÑ</code></div>
      <div class="formula-desc">Ï†úÌíàÏùò Ï¥ù ÏÉùÏÇ∞ÏõêÍ∞ÄÎ•º ÏÇ∞Ï∂úÌïòÎäî ÌïµÏã¨ ÏàòÏãùÏûÖÎãàÎã§.</div>
      <div class="formula-var-list"><span class="formula-var">Ïû¨Î£åÎπÑ</span><span class="formula-var">Í∞ÄÍ≥µÎπÑ</span><span class="formula-var">Ï†úÍ≤ΩÎπÑ</span></div>
      <div class="formula-actions"><button class="formula-action-btn edit" onclick="openFormulaModal('edit')">‚úèÔ∏è Ìé∏Ïßë</button><button class="formula-action-btn delete" onclick="if(confirm('Ï†ïÎßê ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?'))showToast('error','ÌïµÏã¨ ÏàòÏãùÏùÄ ÏÇ≠Ï†úÌï† Ïàò ÏóÜÏäµÎãàÎã§.')">üóë ÏÇ≠Ï†ú</button></div>
    </div>
    <div class="formula-card">
      <div class="formula-card-header"><span class="formula-name">Ïû¨Î£åÎπÑ ÏÜåÍ≥Ñ</span><span class="formula-badge sub">ÌïòÏúÑ</span></div>
      <div class="formula-expression"><span>üìê</span><code>Ïû¨Î£åÎπÑ = Œ£(Îã®Í∞Ä √ó ÏàòÎüâ √ó (1 + Î°úÏä§Ïú®))</code></div>
      <div class="formula-desc">ÏõêÏûêÏû¨ Î∞è Î∂ÄÏûêÏû¨Ïùò Ìï©Í≥ÑÎ•º ÏÇ∞Ï∂úÌï©ÎãàÎã§. Î°úÏä§Ïú®ÏùÑ Î∞òÏòÅÌï©ÎãàÎã§.</div>
      <div class="formula-var-list"><span class="formula-var">Îã®Í∞Ä</span><span class="formula-var">ÏàòÎüâ</span><span class="formula-var">Î°úÏä§Ïú®</span></div>
      <div class="formula-actions"><button class="formula-action-btn edit" onclick="openFormulaModal('edit')">‚úèÔ∏è Ìé∏Ïßë</button><button class="formula-action-btn delete" onclick="if(confirm('ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?'))showToast('success','ÏàòÏãùÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.')">üóë ÏÇ≠Ï†ú</button></div>
    </div>
    <div class="formula-card">
      <div class="formula-card-header"><span class="formula-name">Í∞ÄÍ≥µÎπÑ Îã®Í∞Ä</span><span class="formula-badge sub">ÌïòÏúÑ</span></div>
      <div class="formula-expression"><span>üìê</span><code>Í∞ÄÍ≥µÎπÑ = (ÏÑ§ÎπÑÍ∞êÍ∞ÄÏÉÅÍ∞Å + Ïù∏Í±¥ÎπÑ) / ÏÉùÏÇ∞ÏàòÎüâ √ó CT</code></div>
      <div class="formula-desc">Í≥µÏ†ïÎ≥Ñ Í∞ÄÍ≥µÎπÑ Îã®Í∞ÄÎ•º ÏÇ∞Ï∂úÌï©ÎãàÎã§. CTÎäî ÏÇ¨Ïù¥ÌÅ¥ÌÉÄÏûÑ(Î∂Ñ)ÏûÖÎãàÎã§.</div>
      <div class="formula-var-list"><span class="formula-var">ÏÑ§ÎπÑÍ∞êÍ∞ÄÏÉÅÍ∞Å</span><span class="formula-var">Ïù∏Í±¥ÎπÑ</span><span class="formula-var">ÏÉùÏÇ∞ÏàòÎüâ</span><span class="formula-var">CT</span></div>
      <div class="formula-actions"><button class="formula-action-btn edit" onclick="openFormulaModal('edit')">‚úèÔ∏è Ìé∏Ïßë</button><button class="formula-action-btn delete" onclick="if(confirm('ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?'))showToast('success','ÏàòÏãùÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.')">üóë ÏÇ≠Ï†ú</button></div>
    </div>
    <div class="formula-card">
      <div class="formula-card-header"><span class="formula-name">Ï†úÍ≤ΩÎπÑÏú®</span><span class="formula-badge rate">ÎπÑÏú®</span></div>
      <div class="formula-expression"><span>üìê</span><code>Ï†úÍ≤ΩÎπÑÏú® = Ï†úÍ≤ΩÎπÑ / (Ïû¨Î£åÎπÑ + Í∞ÄÍ≥µÎπÑ) √ó 100</code></div>
      <div class="formula-desc">Ï†úÍ≤ΩÎπÑÏùò ÎπÑÏú®ÏùÑ ÏÇ∞Ï∂úÌï©ÎãàÎã§. ÏùºÎ∞òÏ†Å Î≤îÏúÑ: 8~15%</div>
      <div class="formula-var-list"><span class="formula-var">Ï†úÍ≤ΩÎπÑ</span><span class="formula-var">Ïû¨Î£åÎπÑ</span><span class="formula-var">Í∞ÄÍ≥µÎπÑ</span></div>
      <div class="formula-actions"><button class="formula-action-btn edit" onclick="openFormulaModal('edit')">‚úèÔ∏è Ìé∏Ïßë</button><button class="formula-action-btn delete" onclick="if(confirm('ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?'))showToast('success','ÏàòÏãùÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.')">üóë ÏÇ≠Ï†ú</button></div>
    </div>
  </div>
</div>

<!-- ===== 8. History Page ===== -->
<div class="history-page" id="historyPage">
  <div class="page-header">
    <div class="page-title">Ïù¥Î†• / ÏïåÎ¶º</div>
    <div class="page-subtitle">ÏãúÏä§ÌÖú ÌôúÎèô Ïù¥Î†•Í≥º ÏïåÎ¶ºÏùÑ ÌôïÏù∏Ìï©ÎãàÎã§</div>
  </div>
  <div class="history-filter">
    <div class="history-filter-tabs">
      <button class="history-filter-btn active" onclick="filterHistory(this,'all')">Ï†ÑÏ≤¥</button>
      <button class="history-filter-btn" onclick="filterHistory(this,'upload')">ÏóÖÎ°úÎìú</button>
      <button class="history-filter-btn" onclick="filterHistory(this,'verify')">Í≤ÄÏ¶ù</button>
      <button class="history-filter-btn" onclick="filterHistory(this,'compare')">ÎπÑÍµê</button>
      <button class="history-filter-btn" onclick="filterHistory(this,'system')">ÏãúÏä§ÌÖú</button>
    </div>
    <div style="display:flex;gap:8px;">
      <button class="btn" onclick="markAllRead()">‚úÖ Î™®Îëê ÏùΩÏùå</button>
      <button class="btn" onclick="openNotifSettings()">‚öôÔ∏è ÏïåÎ¶º ÏÑ§Ï†ï</button>
    </div>
  </div>
  <div class="history-list" id="historyList">
    <div class="history-item unread" onclick="markRead(this); switchPage('verification')"><div class="history-icon" style="background:#f8d7da;">üî¥</div><div class="history-content"><div class="history-title">SKIN ÌëúÌîºÏû¨ Ïù¥ÏÉÅÏπò Í∞êÏßÄ</div><div class="history-desc">HEAD_LINING ‚Äî Í≥ºÍ±∞ ÎåÄÎπÑ +35% ÎÜíÏùå</div></div><div class="history-time">30Î∂Ñ Ï†Ñ</div></div>
    <div class="history-item unread" onclick="markRead(this); switchPage('parsing')"><div class="history-icon" style="background:#d4edda;">‚úÖ</div><div class="history-content"><div class="history-title">DOOR_TRIM ÌååÏã± ÏôÑÎ£å</div><div class="history-desc">18Í±¥ Ï∂îÏ∂ú ¬∑ Ïù¥ÏÉÅÏπò ÏóÜÏùå</div></div><div class="history-time">1ÏãúÍ∞Ñ Ï†Ñ</div></div>
    <div class="history-item unread" onclick="markRead(this)"><div class="history-icon" style="background:#fff3cd;">‚ö†Ô∏è</div><div class="history-content"><div class="history-title">SEAT_COVER Ï∂îÏ∂ú Ïã§Ìå®</div><div class="history-desc">Î≥ëÌï© ÏÖÄ Ï§ëÏ≤© Ïò§Î•ò ‚Äî Ïû¨ÏóÖÎ°úÎìú ÌïÑÏöî</div></div><div class="history-time">3ÏãúÍ∞Ñ Ï†Ñ</div></div>
    <div class="history-item" onclick="switchPage('compare')"><div class="history-icon" style="background:#e8f4fd;">üìä</div><div class="history-content"><div class="history-title">Q3 ÎåÄÎπÑ ÏõêÍ∞Ä Î≥ÄÎèô Î¶¨Ìè¨Ìä∏ ÏÉùÏÑ±</div><div class="history-desc">BUMPER ASSY Ïû¨Î£åÎπÑ +8.2% ÏÉÅÏäπ</div></div><div class="history-time">Ïñ¥Ï†ú</div></div>
    <div class="history-item"><div class="history-icon" style="background:#e8daef;">üìÑ</div><div class="history-content"><div class="history-title">CONSOLE_BOX_ÏõêÍ∞ÄÎ™ÖÏÑ∏.xlsx ÏóÖÎ°úÎìú</div><div class="history-desc">ÌååÏùº ÌÅ¨Í∏∞: 2.4MB ¬∑ ÏãúÌä∏ 3Í∞ú</div></div><div class="history-time">Ïñ¥Ï†ú</div></div>
    <div class="history-item"><div class="history-icon" style="background:#e8f4fd;">‚úèÔ∏è</div><div class="history-content"><div class="history-title">HEAD_LINING Í≤ÄÏ¶ù ÏôÑÎ£å</div><div class="history-desc">HANY ÎãòÏù¥ Í≤ÄÏ¶ùÏùÑ ÏôÑÎ£åÌïòÍ≥† ÌïôÏäµ Îç∞Ïù¥ÌÑ∞Î•º Ï†ÄÏû•ÌñàÏäµÎãàÎã§</div></div><div class="history-time">2Ïùº Ï†Ñ</div></div>
    <div class="history-item"><div class="history-icon" style="background:#f0f0f0;">üîß</div><div class="history-content"><div class="history-title">ÏÉùÏÇ∞ÏõêÍ∞Ä ÏàòÏãù ÏóÖÎç∞Ïù¥Ìä∏</div><div class="history-desc">Í¥ÄÎ¶¨ÏûêÍ∞Ä Ï†úÍ≤ΩÎπÑÏú® Í∏∞Ï§ÄÍ∞íÏùÑ ÏàòÏ†ïÌñàÏäµÎãàÎã§</div></div><div class="history-time">3Ïùº Ï†Ñ</div></div>
  </div>
  <!-- Notification Settings (hidden by default) -->
  <div class="notif-settings" id="notifSettings" style="display:none;">
    <div class="notif-settings-card">
      <div style="font-size:15px;font-weight:700;margin-bottom:16px;">ÏïåÎ¶º ÏÑ§Ï†ï</div>
      <div class="settings-row"><div><div class="settings-row-label">Ïù¥ÏÉÅÏπò Í∞êÏßÄ ÏïåÎ¶º</div><div class="settings-row-desc">Ïù¥ÏÉÅÏπòÍ∞Ä Í∞êÏßÄÎêòÎ©¥ ÏïåÎ¶ºÏùÑ Î∞õÏäµÎãàÎã§</div></div><div class="toggle-switch on" onclick="this.classList.toggle('on')"></div></div>
      <div class="settings-row"><div><div class="settings-row-label">ÌååÏã± ÏôÑÎ£å ÏïåÎ¶º</div><div class="settings-row-desc">ÌååÏùº ÌååÏã±Ïù¥ ÏôÑÎ£åÎêòÎ©¥ ÏïåÎ¶ºÏùÑ Î∞õÏäµÎãàÎã§</div></div><div class="toggle-switch on" onclick="this.classList.toggle('on')"></div></div>
      <div class="settings-row"><div><div class="settings-row-label">ÌååÏã± Ïã§Ìå® ÏïåÎ¶º</div><div class="settings-row-desc">ÌååÏã± Ïã§Ìå® Ïãú ÏïåÎ¶ºÏùÑ Î∞õÏäµÎãàÎã§</div></div><div class="toggle-switch on" onclick="this.classList.toggle('on')"></div></div>
      <div class="settings-row"><div><div class="settings-row-label">ÏãúÏä§ÌÖú Í≥µÏßÄ</div><div class="settings-row-desc">ÏãúÏä§ÌÖú ÏóÖÎç∞Ïù¥Ìä∏, Ï†êÍ≤Ä Îì± Í≥µÏßÄÎ•º Î∞õÏäµÎãàÎã§</div></div><div class="toggle-switch" onclick="this.classList.toggle('on')"></div></div>
      <div style="margin-top:16px;text-align:right;"><button class="btn btn-primary" onclick="document.getElementById('notifSettings').style.display='none'; document.getElementById('historyList').style.display='flex'; showToast('success','ÏïåÎ¶º ÏÑ§Ï†ïÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.')">Ï†ÄÏû•</button></div>
    </div>
  </div>
</div>

<!-- ===== 9. Settings Page ===== -->
<div class="settings-page" id="settingsPage">
  <div class="page-header" style="padding:0 0 16px;">
    <div class="page-title">ÏÑ§Ï†ï</div>
    <div class="page-subtitle">Í≥ÑÏ†ï Î∞è ÏãúÏä§ÌÖú ÏÑ§Ï†ïÏùÑ Í¥ÄÎ¶¨Ìï©ÎãàÎã§</div>
  </div>
  <div class="settings-section">
    <div class="settings-section-title">üë§ ÌîÑÎ°úÌïÑ Ï†ïÎ≥¥</div>
    <div class="settings-row"><div><div class="settings-row-label">Ïù¥Î¶Ñ</div></div><div class="settings-row-value">HANY</div></div>
    <div class="settings-row"><div><div class="settings-row-label">ÏÇ¨Î≤à</div></div><div class="settings-row-value">HM20210345</div></div>
    <div class="settings-row"><div><div class="settings-row-label">ÏÜåÏÜç</div></div><div class="settings-row-value">Íµ¨Îß§Î≥∏Î∂Ä / Íµ¨Îß§1ÌåÄ</div></div>
    <div class="settings-row"><div><div class="settings-row-label">Ïó≠Ìï†</div></div><div class="settings-row-value">Íµ¨Îß§ Îã¥ÎãπÏûê</div></div>
    <div class="settings-row"><div><div class="settings-row-label">Ïù¥Î©îÏùº</div></div><div class="settings-row-value">hany@mobis.co.kr</div></div>
  </div>
  <div class="settings-section">
    <div class="settings-section-title">üîí Î≥¥Ïïà</div>
    <div class="settings-row"><div><div class="settings-row-label">ÎπÑÎ∞ÄÎ≤àÌò∏ Î≥ÄÍ≤Ω</div><div class="settings-row-desc">ÎßàÏßÄÎßâ Î≥ÄÍ≤Ω: 2026-01-15</div></div><button class="btn" onclick="showToast('info','ÎπÑÎ∞ÄÎ≤àÌò∏ Î≥ÄÍ≤Ω ÌôîÎ©¥ÏúºÎ°ú Ïù¥ÎèôÌï©ÎãàÎã§.')">Î≥ÄÍ≤Ω</button></div>
    <div class="settings-row"><div><div class="settings-row-label">2Ï∞® Ïù∏Ï¶ù (OTP)</div><div class="settings-row-desc">Îì±Î°ùÎêú Î≤àÌò∏: 010-****-5678</div></div><div class="toggle-switch on" onclick="this.classList.toggle('on')"></div></div>
    <div class="settings-row"><div><div class="settings-row-label">Î°úÍ∑∏Ïù∏ Í∏∞Î°ù</div><div class="settings-row-desc">ÏµúÍ∑º Î°úÍ∑∏Ïù∏: 2026-02-21 08:30</div></div><button class="btn">ÏÉÅÏÑ∏Î≥¥Í∏∞</button></div>
  </div>
  <div class="settings-section">
    <div class="settings-section-title">üîî ÏïåÎ¶º ÏÑ§Ï†ï</div>
    <div class="settings-row"><div><div class="settings-row-label">Ïù¥ÏÉÅÏπò Í∞êÏßÄ ÏïåÎ¶º</div></div><div class="toggle-switch on" onclick="this.classList.toggle('on')"></div></div>
    <div class="settings-row"><div><div class="settings-row-label">ÌååÏã± ÏôÑÎ£å ÏïåÎ¶º</div></div><div class="toggle-switch on" onclick="this.classList.toggle('on')"></div></div>
    <div class="settings-row"><div><div class="settings-row-label">Ïù¥Î©îÏùº ÏïåÎ¶º</div></div><div class="toggle-switch" onclick="this.classList.toggle('on')"></div></div>
  </div>
</div>

</div><!-- end main-wrapper -->

<!-- ===== Modals ===== -->

<!-- Formula Add/Edit Modal -->
<div class="modal-overlay" id="formulaModal">
  <div class="modal">
    <div class="modal-header"><h2 id="formulaModalTitle">ÏÉà ÏàòÏãù Ï∂îÍ∞Ä</h2><button class="popup-close" onclick="closeModal('formulaModal')">‚úï</button></div>
    <div class="modal-body">
      <div class="form-field"><label>ÏàòÏãùÎ™Ö</label><input type="text" placeholder="Ïòà: ÏÉùÏÇ∞ÏõêÍ∞Ä" value=""></div>
      <div class="form-field"><label>Ïπ¥ÌÖåÍ≥†Î¶¨</label><select><option>ÌïµÏã¨</option><option>ÌïòÏúÑ</option><option>ÎπÑÏú®</option></select></div>
      <div class="form-field"><label>ÏàòÏãù</label><textarea placeholder="Ïòà: Ïû¨Î£åÎπÑ + Í∞ÄÍ≥µÎπÑ + Ï†úÍ≤ΩÎπÑ"></textarea></div>
      <div class="form-field"><label>Î≥ÄÏàò (ÏâºÌëú Íµ¨Î∂Ñ)</label><input type="text" placeholder="Ïòà: Ïû¨Î£åÎπÑ, Í∞ÄÍ≥µÎπÑ, Ï†úÍ≤ΩÎπÑ"></div>
      <div class="form-field"><label>ÏÑ§Î™Ö</label><textarea placeholder="Ïù¥ ÏàòÏãùÏóê ÎåÄÌïú ÏÑ§Î™ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî"></textarea></div>
    </div>
    <div class="modal-footer"><button class="btn" onclick="closeModal('formulaModal')">Ï∑®ÏÜå</button><button class="btn btn-primary" onclick="closeModal('formulaModal'); showToast('success','ÏàòÏãùÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.')">Ï†ÄÏû•</button></div>
  </div>
</div>

<!-- Share Modal -->
<div class="modal-overlay" id="shareModal">
  <div class="modal" style="width:480px;">
    <div class="modal-header"><h2>Î¶¨Ìè¨Ìä∏ Í≥µÏú†</h2><button class="popup-close" onclick="closeModal('shareModal')">‚úï</button></div>
    <div class="modal-body">
      <div style="margin-bottom:16px;"><div style="font-size:13px;font-weight:600;margin-bottom:8px;">Í≥µÏú† ÎßÅÌÅ¨</div><div class="share-link-wrap"><input class="share-link-input" value="https://costai.mobis.co.kr/report/HL-2024-001" readonly><button class="btn btn-primary" onclick="navigator.clipboard.writeText('https://costai.mobis.co.kr/report/HL-2024-001'); showToast('success','ÎßÅÌÅ¨Í∞Ä Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§.')">Î≥µÏÇ¨</button></div></div>
      <div><div style="font-size:13px;font-weight:600;margin-bottom:8px;">Ïù¥Î©îÏùºÎ°ú Î∞úÏÜ°</div><div class="form-field" style="margin-bottom:8px;"><input type="email" placeholder="ÏàòÏã†Ïûê Ïù¥Î©îÏùº ÏûÖÎ†•"></div><button class="btn btn-primary" onclick="closeModal('shareModal'); showToast('success','Ïù¥Î©îÏùºÏù¥ Î∞úÏÜ°ÎêòÏóàÏäµÎãàÎã§.')">üìß Î∞úÏÜ°</button></div>
    </div>
  </div>
</div>

<!-- Help Guide Modal -->
<div class="modal-overlay" id="helpModal">
  <div class="modal" style="width:600px;">
    <div class="modal-header"><h2>‚ùì ÎèÑÏõÄÎßê Í∞ÄÏù¥Îìú</h2><button class="popup-close" onclick="closeModal('helpModal')">‚úï</button></div>
    <div class="modal-body help-content">
      <h3>Í≤¨Ï†ÅÏÑú Î∂ÑÏÑù ÏãúÏä§ÌÖú ÏÇ¨Ïö© Í∞ÄÏù¥Îìú</h3>
      <div class="help-step"><div class="help-step-num">1</div><div class="help-step-text"><strong>ÌååÏùº ÏóÖÎ°úÎìú</strong>: ÌååÏã± ÌôîÎ©¥ÏóêÏÑú Excel ÌååÏùºÏùÑ ÎìúÎûòÍ∑∏Ïï§ÎìúÎ°≠ÌïòÍ±∞ÎÇò ÌÅ¥Î¶≠ÌïòÏó¨ ÏóÖÎ°úÎìúÌï©ÎãàÎã§. Îã§Ï§ë ÌååÏùºÏùÑ ÎèôÏãúÏóê ÏóÖÎ°úÎìúÌï† Ïàò ÏûàÏäµÎãàÎã§.</div></div>
      <div class="help-step"><div class="help-step-num">2</div><div class="help-step-text"><strong>ÏûêÎèô ÌååÏã±</strong>: AIÍ∞Ä Í≤¨Ï†ÅÏÑúÏùò ÏõêÍ∞Ä Íµ¨Ï°∞Î•º ÏûêÎèôÏúºÎ°ú Î∂ÑÏÑùÌïòÍ≥† Ìï≠Î™©ÏùÑ Ï∂îÏ∂úÌï©ÎãàÎã§. ÏßÑÌñâ ÏÉÅÌÉúÎäî Ïã§ÏãúÍ∞ÑÏúºÎ°ú ÌôïÏù∏Ìï† Ïàò ÏûàÏäµÎãàÎã§.</div></div>
      <div class="help-step"><div class="help-step-num">3</div><div class="help-step-text"><strong>Í≤ÄÏ¶ù</strong>: Ï∂îÏ∂úÎêú Îç∞Ïù¥ÌÑ∞Î•º ÌëúÏ§ÄÎ∑∞, Î¶¨Ïä§Ìä∏Î∑∞, Í¥ÄÍ≥ÑÎèÑ 3Í∞ÄÏßÄ ÌôîÎ©¥ÏúºÎ°ú ÌôïÏù∏Ìï©ÎãàÎã§. Ïù¥ÏÉÅÏπò Ìï≠Î™©ÏùÄ Îπ®Í∞ÑÏÉâÏúºÎ°ú ÌëúÏãúÎêòÎ©∞, ÌÅ¥Î¶≠ÌïòÎ©¥ AI ÌåêÎã® Í∑ºÍ±∞Î•º ÌôïÏù∏Ìï† Ïàò ÏûàÏäµÎãàÎã§.</div></div>
      <div class="help-step"><div class="help-step-num">4</div><div class="help-step-text"><strong>ÎπÑÍµê</strong>: Í≥ºÍ±∞ Í≤¨Ï†ÅÏÑúÏôÄ ÎπÑÍµêÌïòÏó¨ Ìï≠Î™©Î≥Ñ Î≥ÄÎèôÎ•†ÏùÑ ÌôïÏù∏Ìï©ÎãàÎã§.</div></div>
      <div class="help-step"><div class="help-step-num">5</div><div class="help-step-text"><strong>Î¶¨Ìè¨Ìä∏</strong>: Í≤ÄÏ¶ù Í≤∞Í≥ºÎ•º PDF/ExcelÎ°ú Îã§Ïö¥Î°úÎìúÌïòÍ±∞ÎÇò Í≥µÏú†Ìï† Ïàò ÏûàÏäµÎãàÎã§.</div></div>
      <div class="help-step"><div class="help-step-num">6</div><div class="help-step-text"><strong>Ïù∏ÏÇ¨Ïù¥Ìä∏ Ïä§ÌäúÎîîÏò§</strong>: AIÏóêÍ≤å ÏõêÍ∞ÄÏóê ÎåÄÌï¥ ÏûêÏú†Î°≠Í≤å ÏßàÎ¨∏ÌïòÏÑ∏Ïöî. Ï†àÍ∞ê Í∏∞Ìöå, Ïù¥ÏÉÅÏπò ÏõêÏù∏, ÏãúÏû• ÎèôÌñ• Îì±ÏùÑ Î∂ÑÏÑùÌï¥Ï§çÎãàÎã§.</div></div>
    </div>
  </div>
</div>

<!-- Forgot Password Modal -->
<div class="modal-overlay" id="forgotPwModal">
  <div class="modal" style="width:440px;">
    <div class="modal-header"><h2>ÎπÑÎ∞ÄÎ≤àÌò∏ Ï∞æÍ∏∞</h2><button class="popup-close" onclick="closeModal('forgotPwModal')">‚úï</button></div>
    <div class="modal-body">
      <p style="font-size:13px;color:var(--gray);margin-bottom:16px;">Îì±Î°ùÎêú ÏÇ¨Î≤àÍ≥º Ïù¥Î©îÏùºÏùÑ ÏûÖÎ†•ÌïòÏãúÎ©¥ ÎπÑÎ∞ÄÎ≤àÌò∏ Ïû¨ÏÑ§Ï†ï ÎßÅÌÅ¨Î•º Î≥¥ÎÇ¥ÎìúÎ¶ΩÎãàÎã§.</p>
      <div class="form-field"><label>ÏÇ¨Î≤à</label><input type="text" placeholder="ÏÇ¨Î≤à ÏûÖÎ†•"></div>
      <div class="form-field"><label>Ïù¥Î©îÏùº</label><input type="email" placeholder="Îì±Î°ùÎêú Ïù¥Î©îÏùº ÏûÖÎ†•"></div>
    </div>
    <div class="modal-footer"><button class="btn" onclick="closeModal('forgotPwModal')">Ï∑®ÏÜå</button><button class="btn btn-primary" onclick="closeModal('forgotPwModal'); showToast('success','ÎπÑÎ∞ÄÎ≤àÌò∏ Ïû¨ÏÑ§Ï†ï ÎßÅÌÅ¨Í∞Ä Ïù¥Î©îÏùºÎ°ú Î∞úÏÜ°ÎêòÏóàÏäµÎãàÎã§.')">Ï†ÑÏÜ°</button></div>
  </div>
</div>

<!-- Excel Popup -->
<div class="popup-overlay" id="excelPopup">
  <div class="popup">
    <div class="popup-header"><h2>üìÑ ÏõêÎ≥∏ Î≥¥Í∏∞ ‚Äî HEAD_LINING_ÏõêÍ∞ÄÍ≥ÑÏÇ∞ÏÑú.xlsx</h2><button class="popup-close" onclick="closePopup()">‚úï</button></div>
    <div class="popup-body"><div class="excel-wrapper"><table class="excel-table"><thead><tr><th></th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th><th>F</th><th>G</th></tr></thead><tbody><tr><td class="row-header">1</td><td colspan="7" style="text-align:center;font-weight:700;font-size:14px;">Ïõê Í∞Ä Í≥Ñ ÏÇ∞ ÏÑú</td></tr><tr><td class="row-header">2</td><td>E.O. NO.</td><td colspan="2">EO-2024-1201</td><td>ÌíàÎ≤à</td><td colspan="3">HL-2024-001</td></tr><tr><td class="row-header">3</td><td>ÌíàÎ™Ö</td><td colspan="2">HEAD LINING</td><td>ÌòëÎ†•ÏÇ¨</td><td colspan="3">ÎåÄÌïú(Ï£º)</td></tr><tr><td class="row-header">4</td><td style="font-weight:600;background:#e8f4fd;">Íµ¨Î∂Ñ</td><td style="font-weight:600;background:#e8f4fd;">ÌíàÎ™Ö</td><td style="font-weight:600;background:#e8f4fd;">Í∑úÍ≤©</td><td style="font-weight:600;background:#e8f4fd;">Îã®ÏúÑ</td><td style="font-weight:600;background:#e8f4fd;">ÏàòÎüâ</td><td style="font-weight:600;background:#e8f4fd;">Îã®Í∞Ä</td><td style="font-weight:600;background:#e8f4fd;">Í∏àÏï°</td></tr><tr><td class="row-header">5</td><td>ÏõêÏûêÏû¨</td><td style="background:#d4edda;">SUBSTRATE</td><td>1200√ó800√ó3T</td><td>EA</td><td>1</td><td>18,500</td><td style="background:#d4edda;">18,500</td></tr><tr><td class="row-header">6</td><td>ÏõêÏûêÏû¨</td><td style="background:#f8d7da;">SKIN (ÌëúÌîºÏû¨)</td><td>PVC 0.8mm</td><td>M¬≤</td><td>1.2</td><td style="background:#f8d7da;">18,917</td><td style="background:#f8d7da;">22,700</td></tr><tr><td class="row-header">7</td><td>ÏõêÏûêÏû¨</td><td>ADHESIVE</td><td>WATER BASE</td><td>KG</td><td>0.5</td><td>4,400</td><td>2,200</td></tr></tbody></table></div></div>
  </div>
</div>

<script>
// ===== Toast =====
function showToast(type, msg) {
  const c = document.getElementById('toastContainer');
  const icons = { success: '‚úÖ', error: '‚ùå', info: '‚ÑπÔ∏è' };
  const t = document.createElement('div');
  t.className = 'toast toast-' + type;
  t.innerHTML = '<span class="toast-icon">' + (icons[type]||'‚ÑπÔ∏è') + '</span><span>' + msg + '</span>';
  c.appendChild(t);
  setTimeout(() => { t.style.opacity = '0'; t.style.transform = 'translateX(100%)'; setTimeout(() => t.remove(), 300); }, 3000);
}

// ===== Loading =====
function showLoading(text, cb) {
  const o = document.getElementById('loadingOverlay');
  if (text) o.querySelector('.loading-text').textContent = text;
  o.classList.add('show');
  setTimeout(() => { o.classList.remove('show'); if (cb) cb(); }, 1500);
}

// ===== Login =====
let loginAttempts = 0;
function handleLogin() {
  const id = document.getElementById('loginId').value;
  const pw = document.getElementById('loginPw').value;
  const err = document.getElementById('loginError');
  if (!id || !pw) { err.textContent = 'ÏïÑÏù¥ÎîîÏôÄ ÎπÑÎ∞ÄÎ≤àÌò∏Î•º Î™®Îëê ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.'; err.classList.add('show'); return; }
  if (id === 'wrong') { loginAttempts++; err.textContent = 'ÏïÑÏù¥Îîî ÎòêÎäî ÎπÑÎ∞ÄÎ≤àÌò∏Í∞Ä ÏùºÏπòÌïòÏßÄ ÏïäÏäµÎãàÎã§. (' + loginAttempts + '/5Ìöå)'; err.classList.add('show'); if (loginAttempts >= 5) { err.textContent = 'Í≥ÑÏ†ïÏù¥ Ïû†Í≤ºÏäµÎãàÎã§. Í¥ÄÎ¶¨ÏûêÏóêÍ≤å Î¨∏ÏùòÌïòÏÑ∏Ïöî.'; } return; }
  err.classList.remove('show');
  document.getElementById('loginForm').classList.add('hidden');
  document.getElementById('otpForm').classList.add('active');
  startOtpTimer();
  setTimeout(() => document.querySelector('#otpInputs input').focus(), 100);
}

let otpInterval;
function startOtpTimer() {
  let sec = 180;
  clearInterval(otpInterval);
  otpInterval = setInterval(() => {
    sec--;
    const m = Math.floor(sec/60), s = sec%60;
    document.getElementById('otpTimerText').textContent = String(m).padStart(2,'0') + ':' + String(s).padStart(2,'0');
    if (sec <= 0) { clearInterval(otpInterval); document.getElementById('otpError').textContent = 'Ïù∏Ï¶ùÎ≤àÌò∏Í∞Ä ÎßåÎ£åÎêòÏóàÏäµÎãàÎã§. Ïû¨Î∞úÏÜ°Ìï¥Ï£ºÏÑ∏Ïöî.'; document.getElementById('otpError').classList.add('show'); }
  }, 1000);
}

function resendOtp() { startOtpTimer(); showToast('info', 'Ïù∏Ï¶ùÎ≤àÌò∏Í∞Ä Ïû¨Î∞úÏÜ°ÎêòÏóàÏäµÎãàÎã§.'); document.getElementById('otpError').classList.remove('show'); }

function handleOtp() {
  const inputs = document.querySelectorAll('#otpInputs input');
  const code = Array.from(inputs).map(i => i.value).join('');
  if (code.length < 6) { document.getElementById('otpError').textContent = '6ÏûêÎ¶¨ Ïù∏Ï¶ùÎ≤àÌò∏Î•º Î™®Îëê ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.'; document.getElementById('otpError').classList.add('show'); return; }
  clearInterval(otpInterval);
  document.getElementById('loginOverlay').classList.add('hidden');
  showToast('success', 'Î°úÍ∑∏Ïù∏ ÏÑ±Í≥µ! ÌôòÏòÅÌï©ÎãàÎã§, HANYÎãò.');
  switchPage('dashboard');
}

// OTP auto-focus
document.querySelectorAll('#otpInputs input').forEach((inp, i, arr) => {
  inp.addEventListener('input', () => { if (inp.value && i < arr.length - 1) arr[i+1].focus(); });
  inp.addEventListener('keydown', (e) => { if (e.key === 'Backspace' && !inp.value && i > 0) arr[i-1].focus(); });
});

// Enter key on login
document.getElementById('loginPw').addEventListener('keypress', (e) => { if (e.key === 'Enter') handleLogin(); });

function showForgotPassword() { document.getElementById('forgotPwModal').classList.add('active'); }

// ===== Sidebar =====
function toggleSidebar() {
  const sb = document.getElementById('sidebar');
  const btn = document.getElementById('sidebarCollapseBtn');
  sb.classList.toggle('collapsed');
  document.body.classList.toggle('sidebar-collapsed');
  btn.textContent = sb.classList.contains('collapsed') ? '¬ª' : '¬´';
}

function handleLogout() {
  if (confirm('Î°úÍ∑∏ÏïÑÏõÉ ÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
    document.getElementById('loginOverlay').classList.remove('hidden');
    document.getElementById('loginForm').classList.remove('hidden');
    document.getElementById('otpForm').classList.remove('active');
    document.getElementById('loginId').value = '';
    document.getElementById('loginPw').value = '';
    document.getElementById('loginError').classList.remove('show');
    showToast('info', 'Î°úÍ∑∏ÏïÑÏõÉÎêòÏóàÏäµÎãàÎã§.');
  }
}

// ===== Page Navigation =====
function switchPage(page) {
  // Hide all pages
  ['dashboardPage','parsingPage','verificationPage','comparePage','reportPage','insightPage','modelPage','historyPage','settingsPage'].forEach(id => {
    const el = document.getElementById(id);
    if (el) { el.style.display = 'none'; if (el.classList.contains('insight-container')) el.classList.remove('active'); }
  });
  document.getElementById('verificationHeader').style.display = 'none';
  document.getElementById('verificationStatusBar').style.display = 'none';
  document.querySelector('.legend').classList.remove('show');

  // Show target
  const pageMap = {
    dashboard: 'dashboardPage', parsing: 'parsingPage', verification: 'verificationPage',
    compare: 'comparePage', report: 'reportPage', insight: 'insightPage',
    model: 'modelPage', history: 'historyPage', settings: 'settingsPage'
  };
  const target = document.getElementById(pageMap[page]);
  if (target) {
    if (page === 'insight') { target.style.display = 'block'; target.classList.add('active'); }
    else if (page === 'dashboard' || page === 'parsing' || page === 'compare' || page === 'report' || page === 'history' || page === 'model' || page === 'settings') { target.style.display = 'block'; }
    else { target.style.display = 'block'; }
  }
  if (page === 'verification') {
    document.getElementById('verificationHeader').style.display = 'flex';
    document.getElementById('verificationStatusBar').style.display = 'flex';
  }

  // Update sidebar
  document.querySelectorAll('.sidebar-item').forEach(i => i.classList.remove('active'));
  const si = document.querySelector('.sidebar-item[data-page="'+page+'"]');
  if (si) si.classList.add('active');
}

// ===== Verification Tabs =====
function switchVerificationTab(tab) {
  document.querySelectorAll('.view-tab').forEach(t => t.classList.remove('active'));
  event.target.classList.add('active');
  document.getElementById('standardView').style.display = tab === 'standard' ? 'block' : 'none';
  document.getElementById('listView').style.display = tab === 'list' ? 'block' : 'none';
  document.getElementById('graphView').style.display = tab === 'graph' ? 'block' : 'none';
  document.querySelector('.legend').classList.toggle('show', tab === 'graph');
}

// ===== Inline Editing =====
function startInlineEdit(cell, originalValue) {
  if (cell.querySelector('input')) return;
  const current = cell.textContent.trim();
  const input = document.createElement('input');
  input.className = 'inline-edit-input';
  input.value = current;
  input.type = 'text';
  cell.textContent = '';
  cell.appendChild(input);
  input.focus();
  input.select();
  input.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') { cell.textContent = input.value; showToast('success', 'Í∞íÏù¥ ÏàòÏ†ïÎêòÏóàÏäµÎãàÎã§: ' + input.value); }
    if (e.key === 'Escape') { cell.textContent = originalValue || current; }
  });
  input.addEventListener('blur', () => { if (cell.querySelector('input')) cell.textContent = input.value || current; });
}

// ===== Anomaly Reason =====
function toggleAnomalyReason(badge) {
  const reason = badge.parentElement.querySelector('.anomaly-reason');
  if (reason) { reason.classList.toggle('show'); }
}

// Close anomaly reasons on click outside
document.addEventListener('click', (e) => {
  if (!e.target.closest('.badge-error') && !e.target.closest('.anomaly-reason')) {
    document.querySelectorAll('.anomaly-reason.show').forEach(r => r.classList.remove('show'));
  }
});

// ===== Parsing =====
function filterFiles(status) {
  document.querySelectorAll('.status-card').forEach(c => c.classList.remove('active'));
  event.target.closest('.status-card').classList.add('active');
  document.querySelectorAll('.file-row').forEach(row => {
    row.style.display = (status === 'all' || row.dataset.status === status) ? '' : 'none';
  });
}

function searchFiles(query) {
  const q = query.toLowerCase();
  document.querySelectorAll('.file-row').forEach(row => {
    const name = row.querySelector('.file-name').textContent.toLowerCase();
    row.style.display = name.includes(q) ? '' : 'none';
  });
}

function toggleSelectAll(checked) {
  document.querySelectorAll('.file-table .file-checkbox').forEach(cb => cb.checked = checked);
}

// ===== Drawer =====
function openDrawer(type) {
  document.querySelectorAll('#detailDrawer > div').forEach(d => d.style.display = 'none');
  const target = document.getElementById('drawer-' + type);
  if (target) target.style.display = 'flex';
  document.getElementById('detailDrawer').classList.add('open');
  document.getElementById('drawerOverlay').style.display = 'block';
}
function closeDrawer() {
  document.getElementById('detailDrawer').classList.remove('open');
  document.getElementById('drawerOverlay').style.display = 'none';
}

// ===== Upload drag & drop =====
const uploadArea = document.getElementById('uploadArea');
if (uploadArea) {
  uploadArea.addEventListener('dragover', (e) => { e.preventDefault(); uploadArea.classList.add('drag-over'); });
  uploadArea.addEventListener('dragleave', () => uploadArea.classList.remove('drag-over'));
  uploadArea.addEventListener('drop', (e) => {
    e.preventDefault(); uploadArea.classList.remove('drag-over');
    const files = e.dataTransfer.files;
    if (files.length) {
      document.getElementById('uploadQueue').classList.add('show');
      showToast('info', files.length + 'Í∞ú ÌååÏùºÏù¥ ÏóÖÎ°úÎìú ÌÅêÏóê Ï∂îÍ∞ÄÎêòÏóàÏäµÎãàÎã§.');
    }
  });
  uploadArea.addEventListener('click', () => {
    showToast('info', 'ÌååÏùº ÏÑ†ÌÉù Ï∞ΩÏù¥ Ïó¥Î¶ΩÎãàÎã§. (Îç∞Î™®)');
    document.getElementById('uploadQueue').classList.add('show');
  });
}

// ===== Accordion =====
function toggleAccordion(row) {
  const btn = row.querySelector('.accordion-toggle');
  if (!btn || btn.classList.contains('no-child')) return;
  const target = document.getElementById(btn.dataset.target);
  if (target) { target.classList.toggle('open'); btn.classList.toggle('open'); }
}

// ===== Popups =====
function openPopup() { document.getElementById('excelPopup').classList.add('active'); }
function closePopup() { document.getElementById('excelPopup').classList.remove('active'); }

// ===== Modals =====
function openFormulaModal(mode) {
  document.getElementById('formulaModalTitle').textContent = mode === 'add' ? 'ÏÉà ÏàòÏãù Ï∂îÍ∞Ä' : 'ÏàòÏãù Ìé∏Ïßë';
  document.getElementById('formulaModal').classList.add('active');
}
function openShareModal() { document.getElementById('shareModal').classList.add('active'); }
function openHelpGuide() { document.getElementById('helpModal').classList.add('active'); }
function closeModal(id) { document.getElementById(id).classList.remove('active'); }

// Close modals on overlay click
document.querySelectorAll('.modal-overlay').forEach(overlay => {
  overlay.addEventListener('click', (e) => { if (e.target === overlay) overlay.classList.remove('active'); });
});

// ===== Dashboard =====
function setPeriod(btn) {
  document.querySelectorAll('.period-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  showToast('info', btn.textContent + ' Í∏∞Í∞ÑÏúºÎ°ú ÌïÑÌÑ∞ÎßÅÎê©ÎãàÎã§.');
}

// ===== History =====
function filterHistory(btn, type) {
  document.querySelectorAll('.history-filter-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  showToast('info', (type === 'all' ? 'Ï†ÑÏ≤¥' : type) + ' Ïù¥Î†•ÏùÑ ÌëúÏãúÌï©ÎãàÎã§.');
}
function markRead(item) { item.classList.remove('unread'); }
function markAllRead() {
  document.querySelectorAll('.history-item.unread').forEach(i => i.classList.remove('unread'));
  showToast('success', 'Î™®Îì† ÏïåÎ¶ºÏùÑ ÏùΩÏùå Ï≤òÎ¶¨ÌñàÏäµÎãàÎã§.');
  document.querySelector('.bell-dot').style.display = 'none';
}
function openNotifSettings() {
  document.getElementById('historyList').style.display = 'none';
  document.getElementById('notifSettings').style.display = 'block';
}

// ===== Insight Studio =====
function sendChat() {
  const input = document.getElementById('chatInput');
  const msg = input.value.trim();
  if (!msg) return;
  const container = document.getElementById('chatMessages');
  const now = new Date();
  const time = now.getHours().toString().padStart(2,'0') + ':' + now.getMinutes().toString().padStart(2,'0');
  container.innerHTML += '<div class="chat-msg user"><div class="chat-avatar user-avatar">HY</div><div><div class="chat-bubble">' + msg + '</div><div class="chat-meta">' + time + '</div></div></div>';
  input.value = '';
  container.scrollTop = container.scrollHeight;
  // Simulate AI response
  setTimeout(() => {
    container.innerHTML += '<div class="chat-msg ai"><div class="chat-avatar ai-avatar">AI</div><div><div class="chat-bubble">Î∂ÑÏÑù Ï§ëÏûÖÎãàÎã§... Ïû†ÏãúÎßå Í∏∞Îã§Î†§Ï£ºÏÑ∏Ïöî.<br><br>ÏöîÏ≤≠ÌïòÏã† "<strong>' + msg + '</strong>"Ïóê ÎåÄÌïú Î∂ÑÏÑù Í≤∞Í≥ºÎ•º Ï§ÄÎπÑÌïòÍ≥† ÏûàÏäµÎãàÎã§. ÏõêÍ∞Ä Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ÏôÄ Í≥ºÍ±∞ Ïù¥Î†•ÏùÑ Ï¢ÖÌï©ÌïòÏó¨ ÎãµÎ≥ÄÎìúÎ¶¨Í≤†ÏäµÎãàÎã§.</div><div class="chat-meta">' + time + ' ¬∑ AI</div></div></div>';
    container.scrollTop = container.scrollHeight;
  }, 1000);
}
function sendSuggestion(text) {
  document.getElementById('chatInput').value = text;
  sendChat();
}
function newInsightChat() {
  document.getElementById('chatMessages').innerHTML = '';
  document.getElementById('insightWelcome').style.display = 'block';
  document.getElementById('insightSuggestions').style.display = 'grid';
  showToast('info', 'ÏÉà ÎåÄÌôîÍ∞Ä ÏãúÏûëÎêòÏóàÏäµÎãàÎã§.');
}
function selectChat(item) {
  document.querySelectorAll('.insight-chat-item').forEach(i => i.classList.remove('active'));
  item.classList.add('active');
  document.getElementById('insightWelcome').style.display = 'none';
  document.getElementById('insightSuggestions').style.display = 'none';
  showToast('info', 'ÎåÄÌôîÎ•º Î∂àÎü¨ÏôîÏäµÎãàÎã§.');
}

// ===== Init =====
document.addEventListener('DOMContentLoaded', () => {
  // Show dashboard by default (behind login)
  switchPage('dashboard');
});
</script>
</body>
</html>
