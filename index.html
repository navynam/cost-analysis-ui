<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ê²¬ì ì„œ ê´€ê³„ë„ ë·° - ì™€ì´ì–´í”„ë ˆì„</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  :root { --sidebar-width: 260px; }
  body { font-family: 'Pretendard', -apple-system, sans-serif; background: #f5f5f7; color: #1d1d1f; }
  body.sidebar-collapsed { --sidebar-width: 60px; }

  /* ===== Login & 2FA Screens ===== */
  .login-overlay {
    position: fixed; top: 0; left: 0; right: 0; bottom: 0;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    z-index: 9999;
    display: flex; align-items: center; justify-content: center;
    transition: opacity 0.4s ease;
  }
  .login-overlay.hidden { opacity: 0; pointer-events: none; }
  .login-card {
    background: #fff;
    border-radius: 20px;
    padding: 48px 40px;
    width: 420px;
    max-width: 90vw;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    text-align: center;
  }
  .login-logo {
    width: 56px; height: 56px;
    background: #0071e3;
    border-radius: 14px;
    display: inline-flex; align-items: center; justify-content: center;
    font-size: 24px; color: #fff; font-weight: 700;
    margin-bottom: 20px;
  }
  .login-title {
    font-size: 22px; font-weight: 700; color: #1d1d1f;
    margin-bottom: 6px;
  }
  .login-subtitle {
    font-size: 14px; color: #86868b;
    margin-bottom: 32px;
  }
  .login-field {
    width: 100%; margin-bottom: 16px; text-align: left;
  }
  .login-field label {
    display: block; font-size: 13px; font-weight: 600;
    color: #1d1d1f; margin-bottom: 6px;
  }
  .login-field input {
    width: 100%; padding: 12px 14px;
    border: 1.5px solid #d2d2d7; border-radius: 10px;
    font-size: 15px; color: #1d1d1f;
    outline: none; transition: border-color 0.2s;
  }
  .login-field input:focus { border-color: #0071e3; }
  .login-field input::placeholder { color: #a1a1a6; }
  .login-btn {
    width: 100%; padding: 14px;
    background: #0071e3; color: #fff;
    border: none; border-radius: 12px;
    font-size: 16px; font-weight: 600;
    cursor: pointer; transition: background 0.2s;
    margin-top: 8px;
  }
  .login-btn:hover { background: #0077ED; }
  .login-btn:active { background: #005BB5; }
  .login-error {
    color: #ff3b30; font-size: 13px;
    margin-top: 8px; display: none;
  }
  .login-footer {
    margin-top: 24px; font-size: 12px; color: #a1a1a6;
  }

  /* 2FA */
  .otp-wrap { display: none; }
  .otp-wrap.active { display: block; }
  .login-form-wrap { display: block; }
  .login-form-wrap.hidden { display: none; }

  .otp-phone-info {
    font-size: 14px; color: #1d1d1f;
    margin-bottom: 24px; line-height: 1.6;
  }
  .otp-phone-info strong { color: #0071e3; }
  .otp-inputs {
    display: flex; gap: 10px; justify-content: center;
    margin-bottom: 24px;
  }
  .otp-inputs input {
    width: 48px; height: 56px;
    text-align: center; font-size: 22px; font-weight: 700;
    border: 1.5px solid #d2d2d7; border-radius: 10px;
    outline: none; transition: border-color 0.2s;
  }
  .otp-inputs input:focus { border-color: #0071e3; }
  .otp-timer {
    font-size: 13px; color: #86868b;
    margin-bottom: 20px;
  }
  .otp-timer span { color: #0071e3; font-weight: 600; }
  .otp-resend {
    background: none; border: none;
    color: #0071e3; font-size: 13px;
    cursor: pointer; text-decoration: underline;
    margin-bottom: 24px; display: inline-block;
  }

  /* Sidebar - LNB */
  .sidebar {
    position: fixed;
    top: 0; left: 0; bottom: 0;
    width: var(--sidebar-width);
    background: #1d1d1f;
    color: #fff;
    z-index: 50;
    transform: translateX(0);
    transition: width 0.3s ease;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  .sidebar.collapsed {
    width: 60px;
  }
  .sidebar.collapsed .sidebar-logo-text,
  .sidebar.collapsed .sidebar-item-text,
  .sidebar.collapsed .sidebar-item-badge,
  .sidebar.collapsed .sidebar-user-info,
  .sidebar.collapsed .sidebar-section {
    display: none;
  }
  .sidebar.collapsed .sidebar-header {
    justify-content: center;
    padding: 16px 0;
    gap: 0;
  }
  .sidebar.collapsed .sidebar-logo-icon { display: none; }
  .sidebar.collapsed .sidebar-item {
    justify-content: center;
    padding: 12px 0;
    border-left: none;
  }
  .sidebar.collapsed .sidebar-footer {
    justify-content: center;
    padding: 14px 0;
  }
  .sidebar.collapsed .sidebar-toggle .toggle-text { display: none; }

  /* Main content offset */
  .main-wrapper {
    margin-left: var(--sidebar-width);
    transition: margin-left 0.3s ease;
  }
  .sidebar.expanded { transform: translateX(0); }

  .sidebar-header {
    padding: 16px;
    border-bottom: 1px solid #333;
    display: flex;
    align-items: center;
    gap: 10px;
    min-height: 56px;
    cursor: pointer;
  }
  .sidebar-logo-icon {
    width: 28px; height: 28px;
    background: #0071e3;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    flex-shrink: 0;
  }
  .sidebar-logo-text {
    font-size: 15px;
    font-weight: 700;
    white-space: nowrap;
    opacity: 1;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .sidebar-nav { flex: 1; padding: 8px 0; overflow-y: auto; overflow-x: hidden; }
  .sidebar-section {
    padding: 12px 16px 4px;
    font-size: 10px;
    font-weight: 600;
    color: #666;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    white-space: nowrap;
    overflow: hidden;
  }
  .sidebar-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 16px;
    font-size: 13px;
    color: #a1a1a6;
    cursor: pointer;
    transition: all 0.15s;
    border-left: 3px solid transparent;
    white-space: nowrap;
    overflow: hidden;
    position: relative;
  }
  .sidebar-item:hover { background: #2a2a2c; color: #fff; }
  .sidebar-item.active {
    background: #2a2a2c;
    color: #fff;
    border-left-color: #0071e3;
  }
  .sidebar-item-icon {
    width: 24px;
    text-align: center;
    font-size: 17px;
    flex-shrink: 0;
  }
  .sidebar-item-text {
    opacity: 1;
    transition: opacity 0.2s;
    flex: 1;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .sidebar-item-badge {
    font-size: 10px;
    padding: 1px 7px;
    border-radius: 10px;
    font-weight: 600;
    flex-shrink: 0;
  }
  .sidebar-item-badge.blue { background: #0071e3; color: #fff; }
  .sidebar-item-badge.red { background: #ff3b30; color: #fff; }

  .sidebar-divider {
    height: 1px;
    background: #333;
    margin: 8px 12px;
  }
  .sidebar.expanded .sidebar-divider { margin: 8px 20px; }

  .sidebar-footer {
    padding: 14px 16px;
    border-top: 1px solid #333;
    display: flex;
    align-items: center;
    gap: 10px;
    overflow: hidden;
  }
  .sidebar-avatar {
    width: 32px; height: 32px;
    border-radius: 50%;
    background: #0071e3;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 13px;
    font-weight: 600;
    flex-shrink: 0;
  }
  .sidebar-user-info {
    font-size: 12px;
    white-space: nowrap;
    overflow: hidden;
  }
  .sidebar-user-name { font-weight: 600; }
  .sidebar-user-role { color: #86868b; font-size: 11px; }

  /* Toggle button */
  .sidebar-toggle {
    padding: 10px;
    border-top: 1px solid #333;
    display: flex;
    justify-content: center;
    cursor: pointer;
    color: #666;
    font-size: 14px;
    transition: all 0.15s;
  }
  .sidebar-toggle:hover { color: #fff; background: #2a2a2c; }
  .sidebar.expanded .sidebar-toggle .toggle-icon { transform: rotate(180deg); }
  .toggle-icon { transition: transform 0.25s; }

  .sidebar-tooltip { display: none; }

  /* Hamburger */
  .hamburger {
    width: 32px; height: 32px;
    border-radius: 6px;
    border: 1px solid #e5e5e7;
    background: #fff;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 4px;
    padding: 6px;
    flex-shrink: 0;
  }
  .hamburger:hover { background: #f5f5f7; }
  .hamburger span {
    display: block;
    width: 16px;
    height: 2px;
    background: #1d1d1f;
    border-radius: 1px;
  }

  /* Main content offset */
  .main-wrapper {
    transition: margin-left 0.3s ease;
  }

  /* Overlay */
  .sidebar-overlay.active { display: block; }

  /* Overlay - only on small screens */
  .sidebar-overlay {
    display: none;
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.3);
    z-index: 49;
  }

  /* Header */
  .header {
    background: #fff;
    border-bottom: 1px solid #e5e5e7;
    padding: 16px 24px;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  .header-left { display: flex; align-items: center; gap: 16px; }
  .header-left h1 { font-size: 16px; font-weight: 600; }
  .breadcrumb { font-size: 13px; color: #86868b; }
  .header-right { display: flex; gap: 8px; }

  /* Status Bar */
  .status-bar {
    background: #fff;
    border-bottom: 1px solid #e5e5e7;
    padding: 12px 24px;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  .status-items { display: flex; gap: 24px; }
  .status-item { display: flex; align-items: center; gap: 6px; font-size: 13px; }
  .status-item .label { color: #86868b; }
  .status-item .value { font-weight: 600; }
  .status-item .value.green { color: #34c759; }
  .status-item .value.red { color: #ff3b30; }
  .status-item .value.yellow { color: #ff9500; }

  /* View Tabs */
  .view-tabs { display: flex; gap: 4px; }
  .view-tab {
    padding: 6px 14px;
    border-radius: 6px;
    font-size: 13px;
    cursor: pointer;
    border: 1px solid #e5e5e7;
    background: #fff;
    color: #86868b;
  }
  .view-tab.active {
    background: #1d1d1f;
    color: #fff;
    border-color: #1d1d1f;
  }

  /* Buttons */
  .btn {
    padding: 6px 16px;
    border-radius: 6px;
    font-size: 13px;
    cursor: pointer;
    border: 1px solid #e5e5e7;
    background: #fff;
  }
  .btn-primary { background: #0071e3; color: #fff; border-color: #0071e3; }
  .btn-outline { background: transparent; }

  /* Canvas */
  .canvas-container {
    position: relative;
    width: 100%;
    height: calc(100vh - 130px);
    overflow: auto;
    padding: 40px;
  }

  /* Graph */
  .graph {
    position: relative;
    width: 1500px;
    height: 900px;
    margin: 0 auto;
  }

  /* Node */
  .node {
    position: absolute;
    background: #fff;
    border: 2px solid #e5e5e7;
    border-radius: 12px;
    padding: 16px;
    width: 260px;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: 0 1px 3px rgba(0,0,0,0.08);
  }
  .node:hover {
    border-color: #0071e3;
    box-shadow: 0 4px 12px rgba(0,113,227,0.15);
    transform: translateY(-2px);
  }
  .node.root { border-color: #0071e3; border-width: 2px; }
  .node.has-anomaly { border-color: #ff3b30; }
  .node.has-warning { border-color: #ff9500; }

  .node-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 10px;
  }
  .node-type {
    font-size: 11px;
    font-weight: 600;
    padding: 2px 8px;
    border-radius: 4px;
    background: #f5f5f7;
    color: #86868b;
  }
  .node-type.root-type { background: #e8f4fd; color: #0071e3; }
  .node-type.sub-type { background: #f0f0f0; color: #666; }

  .node-badge {
    display: flex;
    gap: 4px;
  }
  .badge {
    font-size: 10px;
    padding: 2px 6px;
    border-radius: 4px;
    font-weight: 600;
  }
  .badge-ok { background: #d4edda; color: #34c759; }
  .badge-warn { background: #fff3cd; color: #ff9500; }
  .badge-error { background: #f8d7da; color: #ff3b30; }

  .node-title {
    font-size: 14px;
    font-weight: 600;
    margin-bottom: 4px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .node-subtitle {
    font-size: 12px;
    color: #86868b;
    margin-bottom: 12px;
  }

  .node-stats {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px;
  }
  .node-stat {
    background: #f9f9fb;
    border-radius: 6px;
    padding: 8px;
  }
  .node-stat .stat-label {
    font-size: 10px;
    color: #86868b;
    margin-bottom: 2px;
  }
  .node-stat .stat-value {
    font-size: 13px;
    font-weight: 600;
  }

  .node-footer {
    margin-top: 10px;
    padding-top: 10px;
    border-top: 1px solid #f0f0f0;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .confidence-bar {
    width: 60px;
    height: 4px;
    background: #e5e5e7;
    border-radius: 2px;
    overflow: hidden;
  }
  .confidence-fill {
    height: 100%;
    border-radius: 2px;
  }
  .confidence-fill.high { background: #34c759; width: 92%; }
  .confidence-fill.mid { background: #ff9500; width: 75%; }
  .confidence-fill.low { background: #ff3b30; width: 45%; }

  .node-action {
    font-size: 11px;
    color: #0071e3;
    cursor: pointer;
    font-weight: 500;
  }

  /* Connection Lines (SVG) */
  .connections {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 0;
  }
  .connection-line {
    fill: none;
    stroke: #d2d2d7;
    stroke-width: 2;
  }
  .connection-line.anomaly {
    stroke: #ff3b30;
    stroke-dasharray: 6 3;
  }

  .node { z-index: 1; }

  /* Mini map */
  .minimap {
    position: fixed;
    bottom: 24px;
    right: 24px;
    width: 180px;
    height: 120px;
    background: #fff;
    border: 1px solid #e5e5e7;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    padding: 8px;
  }
  .minimap-label {
    font-size: 10px;
    color: #86868b;
    margin-bottom: 4px;
  }

  /* Legend */
  .legend {
    position: fixed;
    bottom: 24px;
    left: 24px;
    background: #fff;
    border: 1px solid #e5e5e7;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    padding: 12px 16px;
    display: flex;
    gap: 16px;
    font-size: 12px;
  }
  .legend-item { display: flex; align-items: center; gap: 6px; }
  .legend-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    border: 2px solid;
  }
  .legend-dot.normal { border-color: #0071e3; }
  .legend-dot.warning { border-color: #ff9500; background: #fff3cd; }
  .legend-dot.error { border-color: #ff3b30; background: #f8d7da; }

  /* Toolbar */
  .canvas-toolbar {
    position: fixed;
    top: 50%;
    right: 24px;
    transform: translateY(-50%);
    background: #fff;
    border: 1px solid #e5e5e7;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  .toolbar-btn {
    padding: 10px 12px;
    border: none;
    background: #fff;
    cursor: pointer;
    font-size: 16px;
    border-bottom: 1px solid #f0f0f0;
  }
  .toolbar-btn:last-child { border-bottom: none; }
  .toolbar-btn:hover { background: #f5f5f7; }

  /* Tooltip */
  .tooltip {
    position: absolute;
    top: -8px;
    right: -220px;
    width: 200px;
    background: #1d1d1f;
    color: #fff;
    border-radius: 8px;
    padding: 12px;
    font-size: 12px;
    display: none;
    z-index: 10;
  }
  .node:hover .tooltip { display: block; }
  .tooltip-row { display: flex; justify-content: space-between; margin-bottom: 4px; }
  .tooltip-label { color: #a1a1a6; }

  /* Expand/Collapse */
  .expand-btn {
    position: absolute;
    bottom: -12px;
    left: 50%;
    transform: translateX(-50%);
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: #fff;
    border: 2px solid #e5e5e7;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    cursor: pointer;
    z-index: 2;
  }
  .expand-btn:hover { border-color: #0071e3; color: #0071e3; }

  /* Annotation */
  .annotation {
    position: absolute;
    background: #fffde7;
    border: 1px solid #ffe082;
    border-radius: 6px;
    padding: 8px 12px;
    font-size: 11px;
    color: #8d6e0f;
    max-width: 200px;
    z-index: 3;
  }
  .annotation::before {
    content: 'ğŸ’¡';
    margin-right: 4px;
  }

  /* Excel Popup Overlay */
  .popup-overlay {
    display: none;
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.5);
    z-index: 100;
    justify-content: center;
    align-items: center;
  }
  .popup-overlay.active { display: flex; }

  .popup {
    background: #fff;
    border-radius: 12px;
    width: 900px;
    max-height: 85vh;
    overflow: hidden;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    display: flex;
    flex-direction: column;
  }
  .popup-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 20px;
    border-bottom: 1px solid #e5e5e7;
    background: #f9f9fb;
  }
  .popup-header h2 { font-size: 15px; font-weight: 600; }
  .popup-header-right { display: flex; align-items: center; gap: 10px; }
  .popup-close {
    width: 28px; height: 28px;
    border-radius: 50%;
    border: none;
    background: #e5e5e7;
    cursor: pointer;
    font-size: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .popup-close:hover { background: #d2d2d7; }

  .popup-toolbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 20px;
    border-bottom: 1px solid #f0f0f0;
    font-size: 12px;
    color: #86868b;
  }
  .popup-toolbar-left { display: flex; gap: 12px; align-items: center; }
  .popup-tab {
    padding: 4px 10px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 12px;
    color: #86868b;
  }
  .popup-tab.active { background: #1d1d1f; color: #fff; }

  .popup-body {
    overflow: auto;
    padding: 0;
    flex: 1;
  }

  /* Excel Table */
  .excel-wrapper {
    overflow: auto;
    max-height: 60vh;
  }
  .excel-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 12px;
  }
  .excel-table th,
  .excel-table td {
    border: 1px solid #d2d2d7;
    padding: 6px 10px;
    text-align: left;
    white-space: nowrap;
  }
  .excel-table thead th {
    background: #f0f0f2;
    font-weight: 600;
    position: sticky;
    top: 0;
    z-index: 2;
    font-size: 11px;
    color: #666;
  }
  .excel-table .row-header {
    background: #f9f9fb;
    font-weight: 600;
    color: #444;
    min-width: 40px;
    text-align: center;
  }
  .excel-table .cell-highlight {
    background: #fff3cd !important;
    outline: 2px solid #ff9500;
    outline-offset: -1px;
  }
  .excel-table .cell-highlight-green {
    background: #d4edda !important;
    outline: 2px solid #34c759;
    outline-offset: -1px;
  }
  .excel-table .cell-highlight-red {
    background: #f8d7da !important;
    outline: 2px solid #ff3b30;
    outline-offset: -1px;
  }
  .excel-table .cell-merged {
    text-align: center;
    font-weight: 600;
    background: #f5f5f7;
  }
  .excel-table .cell-empty {
    background: #fafafa;
  }
  .excel-table tr:hover td:not(.row-header):not(th) {
    background: #f0f4ff;
  }

  /* Highlight indicator */
  .highlight-legend {
    display: flex;
    gap: 16px;
    padding: 10px 20px;
    border-top: 1px solid #f0f0f0;
    font-size: 11px;
    color: #86868b;
    background: #f9f9fb;
  }
  .hl-item { display: flex; align-items: center; gap: 4px; }
  .hl-dot { width: 12px; height: 12px; border-radius: 2px; border: 2px solid; }
  .hl-dot.hl-mapped { background: #d4edda; border-color: #34c759; }
  .hl-dot.hl-selected { background: #fff3cd; border-color: #ff9500; }
  .hl-dot.hl-anomaly { background: #f8d7da; border-color: #ff3b30; }

  /* Mapping indicator in popup */
  .mapping-tag {
    display: inline-block;
    font-size: 9px;
    padding: 1px 5px;
    border-radius: 3px;
    margin-left: 4px;
    font-weight: 600;
    vertical-align: middle;
  }
  .mapping-tag.mapped { background: #d4edda; color: #1b7a3d; }
  .mapping-tag.anomaly { background: #f8d7da; color: #c62828; }

  /* Standard View Styles */
  .standard-container {
    overflow-y: auto;
    height: calc(100vh - 130px);
    background: #f5f5f7;
  }
  .std-group {
    background: #fff;
    border: 1px solid #e5e5e7;
    border-radius: 10px;
    margin-bottom: 16px;
    overflow: hidden;
  }
  .std-group-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 14px 20px;
    background: #f9f9fb;
    border-bottom: 1px solid #e5e5e7;
  }
  .std-total-header { background: #f0f4ff; }
  .std-group-title {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 14px;
    font-weight: 600;
  }
  .std-group-icon {
    width: 26px; height: 26px;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: 700;
  }
  .std-group-summary {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .std-summary-value { font-size: 16px; font-weight: 700; }
  .std-summary-pct { font-size: 13px; color: #86868b; }

  .std-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 12px;
  }
  .std-table th {
    padding: 8px 12px;
    text-align: left;
    font-size: 11px;
    font-weight: 600;
    color: #86868b;
    background: #fafafa;
    border-bottom: 1px solid #e5e5e7;
  }
  .std-table td {
    padding: 10px 12px;
    border-bottom: 1px solid #f0f0f0;
  }
  .std-table tbody tr:hover { background: #f8f9ff; }
  .std-table tbody tr:last-child td { border-bottom: none; }

  .std-cell-name { font-weight: 500; }
  .has-sub {
    font-size: 10px;
    color: #0071e3;
    background: #e8f4fd;
    padding: 1px 6px;
    border-radius: 3px;
    margin-left: 6px;
    cursor: pointer;
  }
  .anomaly-icon { margin-left: 4px; }

  .sub-row td { color: #666; background: #fafcff; }
  .anomaly-row { background: #fff8f8 !important; }
  .anomaly-row td { background: #fff8f8; }

  .level-badge {
    display: inline-block;
    font-size: 10px;
    font-weight: 700;
    padding: 2px 6px;
    border-radius: 4px;
  }
  .level-badge.l0 { background: #e8edf3; color: #555; }
  .level-badge.l1 { background: #dce6f7; color: #0071e3; }

  .mini-confidence {
    width: 40px;
    height: 3px;
    background: #e5e5e7;
    border-radius: 2px;
    display: inline-block;
    vertical-align: middle;
    margin-right: 4px;
    overflow: hidden;
  }
  .mini-bar { height: 100%; border-radius: 2px; }

  .cost-bar {
    display: flex;
    height: 8px;
    background: #e5e5e7;
    border-radius: 4px;
    overflow: hidden;
  }
  .cost-fill { height: 100%; }

  /* Insight Studio */
  .insight-container {
    display: none;
    height: 100vh;
    background: #f5f5f7;
    flex-direction: column;
  }
  .insight-container.active { display: flex; }

  .insight-header-bar {
    padding: 16px 40px 0;
    display: flex;
    align-items: center;
    gap: 12px;
    background: #f5f5f7;
  }

  .insight-body {
    flex: 1;
    display: flex;
    flex-direction: column;
    max-width: 860px;
    width: 100%;
    margin: 0 auto;
    padding: 24px 40px;
    overflow: hidden;
  }

  .insight-welcome {
    text-align: center;
    padding: 40px 0 24px;
  }
  .insight-welcome-icon { font-size: 48px; margin-bottom: 12px; }
  .insight-welcome-title { font-size: 22px; font-weight: 700; margin-bottom: 6px; }
  .insight-welcome-sub { font-size: 14px; color: #86868b; }

  .insight-suggestions {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-bottom: 24px;
  }
  .insight-suggestion {
    background: #fff;
    border: 1px solid #e5e5e7;
    border-radius: 10px;
    padding: 14px 16px;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: flex-start;
    gap: 10px;
  }
  .insight-suggestion:hover { border-color: #0071e3; background: #f8fbff; }
  .insight-suggestion-icon { font-size: 18px; flex-shrink: 0; margin-top: 1px; }
  .insight-suggestion-text { font-size: 13px; color: #444; line-height: 1.4; }

  .chat-messages {
    flex: 1;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 16px;
    padding-bottom: 16px;
  }

  .chat-msg {
    display: flex;
    gap: 10px;
    max-width: 85%;
  }
  .chat-msg.user { align-self: flex-end; flex-direction: row-reverse; }
  .chat-msg.ai { align-self: flex-start; }

  .chat-avatar {
    width: 32px; height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    flex-shrink: 0;
  }
  .chat-avatar.ai-avatar { background: #0071e3; color: #fff; }
  .chat-avatar.user-avatar { background: #e5e5e7; color: #555; }

  .chat-bubble {
    padding: 12px 16px;
    border-radius: 16px;
    font-size: 13px;
    line-height: 1.6;
  }
  .chat-msg.ai .chat-bubble {
    background: #fff;
    border: 1px solid #e5e5e7;
    border-top-left-radius: 4px;
  }
  .chat-msg.user .chat-bubble {
    background: #0071e3;
    color: #fff;
    border-top-right-radius: 4px;
  }

  .chat-bubble strong { font-weight: 600; }
  .chat-bubble .chat-table {
    width: 100%;
    border-collapse: collapse;
    margin: 8px 0;
    font-size: 12px;
  }
  .chat-bubble .chat-table th,
  .chat-bubble .chat-table td {
    padding: 6px 10px;
    border: 1px solid #e5e5e7;
    text-align: left;
  }
  .chat-bubble .chat-table th { background: #f5f5f7; font-weight: 600; }

  .chat-meta {
    font-size: 10px;
    color: #a1a1a6;
    margin-top: 4px;
    padding: 0 4px;
  }
  .chat-msg.user .chat-meta { text-align: right; }

  .chat-input-area {
    padding: 16px 0 0;
    border-top: 1px solid #e5e5e7;
  }
  .chat-input-wrap {
    display: flex;
    gap: 8px;
    background: #fff;
    border: 1px solid #e5e5e7;
    border-radius: 12px;
    padding: 4px 4px 4px 16px;
    align-items: center;
    transition: border-color 0.2s;
  }
  .chat-input-wrap:focus-within { border-color: #0071e3; }
  .chat-input {
    flex: 1;
    border: none;
    outline: none;
    font-size: 13px;
    padding: 10px 0;
    background: transparent;
  }
  .chat-input::placeholder { color: #a1a1a6; }
  .chat-attach-btn {
    width: 36px; height: 36px;
    border-radius: 8px;
    border: none;
    background: transparent;
    cursor: pointer;
    font-size: 18px;
    color: #86868b;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .chat-attach-btn:hover { background: #f5f5f7; }
  .chat-send-btn {
    width: 36px; height: 36px;
    border-radius: 8px;
    border: none;
    background: #0071e3;
    cursor: pointer;
    font-size: 16px;
    color: #fff;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }
  .chat-send-btn:hover { background: #005bb5; }

  .chat-context-bar {
    display: flex;
    gap: 8px;
    margin-bottom: 8px;
    font-size: 11px;
  }
  .context-chip {
    background: #e8f4fd;
    color: #0071e3;
    padding: 4px 10px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    gap: 4px;
    cursor: default;
  }
  .context-chip .remove {
    cursor: pointer;
    font-size: 12px;
    opacity: 0.6;
  }
  .context-chip .remove:hover { opacity: 1; }

  /* Parsing Page */
  .parsing-container {
    display: none;
    min-height: 100vh;
    background: #f5f5f7;
    overflow-y: auto;
  }
  .parsing-header-area {
    padding: 20px 24px 0;
  }
  .parsing-title { font-size: 20px; font-weight: 700; margin-bottom: 2px; }
  .parsing-subtitle { font-size: 13px; color: #86868b; margin-bottom: 16px; }

  .parsing-search {
    display: flex; gap: 10px; margin-bottom: 16px;
  }
  .parsing-search-input {
    flex: 1; padding: 10px 16px; border: 1px solid #e5e5e7; border-radius: 8px;
    font-size: 13px; background: #fff; outline: none;
  }
  .parsing-search-input:focus { border-color: #0071e3; }
  .parsing-filter-btn {
    padding: 10px 16px; border: 1px solid #e5e5e7; border-radius: 8px;
    background: #fff; font-size: 13px; cursor: pointer; display: flex; align-items: center; gap: 6px;
  }

  /* Status cards */
  .status-cards {
    display: flex; gap: 12px; margin-bottom: 16px; padding: 0 24px;
  }
  .status-card {
    flex: 1; background: #fff; border: 1px solid #e5e5e7; border-radius: 10px;
    padding: 16px; cursor: pointer; transition: all 0.2s; text-align: center;
  }
  .status-card:hover { border-color: #0071e3; box-shadow: 0 2px 8px rgba(0,113,227,0.1); }
  .status-card.active { border-color: #0071e3; background: #f0f6ff; }
  .status-card-count { font-size: 28px; font-weight: 700; margin-bottom: 4px; }
  .status-card-label { font-size: 12px; color: #86868b; }
  .sc-all .status-card-count { color: #1d1d1f; }
  .sc-extracting .status-card-count { color: #ff9500; }
  .sc-validating .status-card-count { color: #0071e3; }
  .sc-complete .status-card-count { color: #34c759; }
  .sc-failed .status-card-count { color: #ff3b30; }
  .sc-analyzing .status-card-count { color: #af52de; }

  /* File list */
  .file-list { padding: 0 24px 24px; }
  .file-table {
    width: 100%; border-collapse: collapse; background: #fff;
    border: 1px solid #e5e5e7; border-radius: 10px; overflow: hidden;
  }
  .file-table th {
    padding: 12px 16px; text-align: left; font-size: 11px; font-weight: 600;
    color: #86868b; background: #f9f9fb; border-bottom: 1px solid #e5e5e7;
  }
  .file-table td {
    padding: 14px 16px; border-bottom: 1px solid #f0f0f0; font-size: 13px;
  }
  .file-table tbody tr { cursor: pointer; transition: background 0.15s; }
  .file-table tbody tr:hover { background: #f8f9ff; }
  .file-table tbody tr:last-child td { border-bottom: none; }

  .file-name { font-weight: 600; }
  .file-status {
    display: inline-flex; align-items: center; gap: 5px;
    font-size: 12px; font-weight: 600; padding: 3px 10px; border-radius: 12px;
    white-space: nowrap; min-width: 80px; justify-content: center;
  }
  .fs-extracting { background: #fff3cd; color: #b8860b; }
  .fs-validating { background: #cce5ff; color: #004085; }
  .fs-complete { background: #d4edda; color: #155724; }
  .fs-failed { background: #f8d7da; color: #721c24; }
  .fs-analyzing { background: #e8daef; color: #6c3483; }

  .file-progress {
    width: 80px; height: 6px; background: #e5e5e7; border-radius: 3px; overflow: hidden;
  }
  .file-progress-fill { height: 100%; border-radius: 3px; transition: width 0.3s; }

  .file-actions { display: flex; gap: 6px; }
  .file-action-btn {
    padding: 4px 10px; border: 1px solid #e5e5e7; border-radius: 6px;
    background: #fff; font-size: 11px; cursor: pointer; color: #555;
  }
  .file-action-btn:hover { border-color: #0071e3; color: #0071e3; }
  .file-action-btn.primary { background: #0071e3; color: #fff; border-color: #0071e3; }
  .file-action-btn.disabled { opacity: 0.4; pointer-events: none; }

  /* Upload area */
  .upload-area {
    border: 2px dashed #d2d2d7; border-radius: 12px; padding: 32px;
    text-align: center; margin: 0 24px 16px; background: #fff;
    cursor: pointer; transition: all 0.2s;
  }
  .upload-area:hover { border-color: #0071e3; background: #f8fbff; }
  .upload-icon { font-size: 40px; margin-bottom: 12px; }
  .upload-text { font-size: 14px; color: #86868b; margin-bottom: 8px; }
  .upload-text strong { color: #0071e3; }
  .upload-formats { font-size: 11px; color: #a1a1a6; }

  /* Detail drawer */
  .detail-drawer {
    position: fixed; top: 0; right: 0; bottom: 0; width: 480px;
    background: #fff; box-shadow: -4px 0 20px rgba(0,0,0,0.1);
    z-index: 60; transform: translateX(480px); transition: transform 0.3s ease;
    display: flex; flex-direction: column;
  }
  .detail-drawer.open { transform: translateX(0); }
  .drawer-header {
    padding: 20px; border-bottom: 1px solid #e5e5e7;
    display: flex; justify-content: space-between; align-items: center;
  }
  .drawer-body { flex: 1; overflow-y: auto; padding: 20px; }
  .drawer-section { margin-bottom: 20px; }
  .drawer-section-title { font-size: 12px; font-weight: 600; color: #86868b; margin-bottom: 8px; }
  .drawer-info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
  .drawer-info-item { background: #f9f9fb; border-radius: 8px; padding: 10px; }
  .drawer-info-label { font-size: 10px; color: #86868b; margin-bottom: 2px; }
  .drawer-info-value { font-size: 13px; font-weight: 600; }
  .drawer-footer { padding: 16px 20px; border-top: 1px solid #e5e5e7; display: flex; gap: 8px; }
  .drawer-footer .btn { flex: 1; text-align: center; padding: 10px; }

  .extraction-log {
    background: #1d1d1f; border-radius: 8px; padding: 12px; font-family: monospace;
    font-size: 11px; color: #a1a1a6; max-height: 200px; overflow-y: auto;
  }
  .log-line { margin-bottom: 4px; }
  .log-time { color: #666; }
  .log-ok { color: #34c759; }
  .log-warn { color: #ff9500; }
  .log-err { color: #ff3b30; }
  .log-info { color: #0071e3; }

  .error-box {
    background: #fff8f8; border: 1px solid #f8d7da; border-radius: 8px; padding: 12px;
  }
  .error-title { font-size: 12px; font-weight: 600; color: #ff3b30; margin-bottom: 6px; }
  .error-detail { font-size: 12px; color: #666; }

  /* List View */
  .list-container {
    overflow-y: auto;
    height: calc(100vh - 130px);
    background: #f5f5f7;
    display: none;
  }
  .list-group {
    background: #fff;
    border: 1px solid #e5e5e7;
    border-radius: 10px;
    margin-bottom: 16px;
    overflow: hidden;
  }
  .list-row {
    display: grid;
    grid-template-columns: 36px 80px 1fr 100px 60px 50px 90px 90px 60px 70px 60px;
    align-items: center;
    padding: 10px 16px;
    border-bottom: 1px solid #f0f0f0;
    font-size: 12px;
    cursor: default;
  }
  .list-row:last-child { border-bottom: none; }
  .list-row:hover { background: #f8f9ff; }
  .list-row.anomaly-row { background: #fff8f8; }
  .list-row.anomaly-row:hover { background: #fff0f0; }
  .list-row-header {
    background: #fafafa;
    font-size: 11px;
    font-weight: 600;
    color: #86868b;
    cursor: default;
  }
  .list-row-header:hover { background: #fafafa; }

  .accordion-toggle {
    width: 22px; height: 22px;
    border-radius: 4px;
    border: 1px solid #d2d2d7;
    background: #fff;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 11px;
    transition: all 0.2s;
    color: #666;
  }
  .accordion-toggle:hover { border-color: #0071e3; color: #0071e3; }
  .accordion-toggle.open { background: #0071e3; color: #fff; border-color: #0071e3; transform: rotate(90deg); }
  .accordion-toggle.no-child { visibility: hidden; }

  .accordion-children {
    display: none;
    background: #f8faff;
    border-top: 1px solid #eef0f5;
  }
  .accordion-children.open { display: block; }
  .accordion-children .list-row {
    padding-left: 52px;
    background: #f8faff;
    border-bottom: 1px solid #eef0f5;
  }
  .accordion-children .list-row:hover { background: #eff3ff; }
  .child-connector {
    color: #0071e3;
    font-size: 11px;
    margin-right: 4px;
  }

  /* Sub-level nested */
  .accordion-children .accordion-children .list-row {
    padding-left: 80px;
    background: #f2f5fc;
  }
  /* ===== Model Management Page ===== */
  .model-page {
    display: none;
    min-height: 100vh;
    background: #f5f5f7;
    padding: 20px 24px;
  }
  .model-page-header {
    display: flex; align-items: center; justify-content: space-between;
    margin-bottom: 20px;
  }
  .model-page-title { font-size: 20px; font-weight: 700; }
  .model-page-sub { font-size: 13px; color: #86868b; margin-top: 2px; }
  .model-add-btn {
    padding: 10px 20px; background: #0071e3; color: #fff;
    border: none; border-radius: 10px; font-size: 14px; font-weight: 600;
    cursor: pointer; display: flex; align-items: center; gap: 6px;
  }
  .model-add-btn:hover { background: #0077ED; }

  .formula-list { display: flex; flex-direction: column; gap: 12px; }
  .formula-card {
    background: #fff; border: 1px solid #e5e5e7; border-radius: 12px;
    padding: 20px 24px; transition: box-shadow 0.2s;
  }
  .formula-card:hover { box-shadow: 0 2px 12px rgba(0,0,0,0.06); }
  .formula-card-header {
    display: flex; align-items: center; justify-content: space-between;
    margin-bottom: 12px;
  }
  .formula-name {
    font-size: 15px; font-weight: 700; color: #1d1d1f;
  }
  .formula-badge {
    font-size: 11px; padding: 2px 10px; border-radius: 10px;
    font-weight: 600;
  }
  .formula-badge.core { background: #0071e3; color: #fff; }
  .formula-badge.sub { background: #e8f0fe; color: #0071e3; }
  .formula-badge.rate { background: #fff3cd; color: #b8860b; }

  .formula-expression {
    background: #f5f5f7; border: 1px solid #e5e5e7; border-radius: 8px;
    padding: 12px 16px; font-family: 'SF Mono', 'Consolas', monospace;
    font-size: 14px; color: #1d1d1f; margin-bottom: 10px;
    display: flex; align-items: center; gap: 8px;
  }
  .formula-expression code {
    flex: 1; background: none; font-family: inherit; font-size: inherit;
  }
  .formula-desc {
    font-size: 13px; color: #86868b; line-height: 1.5;
  }
  .formula-actions {
    display: flex; gap: 8px; margin-top: 12px; justify-content: flex-end;
  }
  .formula-action-btn {
    padding: 6px 14px; border-radius: 6px; font-size: 12px; font-weight: 600;
    cursor: pointer; border: 1px solid #e5e5e7; background: #fff; color: #1d1d1f;
    transition: all 0.15s;
  }
  .formula-action-btn:hover { background: #f5f5f7; }
  .formula-action-btn.edit { color: #0071e3; border-color: #0071e3; }
  .formula-action-btn.delete { color: #ff3b30; border-color: #ff3b30; }
  .formula-action-btn.delete:hover { background: #fff5f5; }

  .formula-var-list {
    display: flex; gap: 6px; flex-wrap: wrap; margin-top: 8px;
  }
  .formula-var {
    font-size: 11px; padding: 2px 8px; border-radius: 6px;
    background: #f0f6ff; color: #0071e3; font-weight: 500;
  }
</style>
</head>
<body>

<!-- ===== Login Screen ===== -->
<div class="login-overlay" id="loginOverlay">
  <div class="login-card">
    <div class="login-logo">HD</div>
    <div class="login-title">ê²¬ì ì„œ ë¶„ì„ ì‹œìŠ¤í…œ</div>
    <div class="login-subtitle">í˜„ëŒ€ëª¨ë¹„ìŠ¤ êµ¬ë§¤ì›ê°€ AI ë¶„ì„ í”Œë«í¼</div>

    <!-- 1ì°¨ ì¸ì¦: ID/PW -->
    <div class="login-form-wrap" id="loginForm">
      <div class="login-field">
        <label>ì•„ì´ë””</label>
        <input type="text" id="loginId" placeholder="ì‚¬ë²ˆ ë˜ëŠ” ì•„ì´ë”” ì…ë ¥" autocomplete="off">
      </div>
      <div class="login-field">
        <label>ë¹„ë°€ë²ˆí˜¸</label>
        <input type="password" id="loginPw" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥">
      </div>
      <button class="login-btn" onclick="handleLogin()">ë¡œê·¸ì¸</button>
      <div class="login-error" id="loginError">ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
      <div class="login-footer">Â© 2026 í˜„ëŒ€ëª¨ë¹„ìŠ¤ Â· êµ¬ë§¤ë³¸ë¶€</div>
    </div>

    <!-- 2ì°¨ ì¸ì¦: íœ´ëŒ€í° OTP -->
    <div class="otp-wrap" id="otpForm">
      <div class="otp-phone-info">
        <strong id="otpPhone">010-****-5678</strong> ë¡œ<br>ì¸ì¦ë²ˆí˜¸ê°€ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.
      </div>
      <div class="otp-inputs" id="otpInputs">
        <input type="text" maxlength="1" inputmode="numeric" autofocus>
        <input type="text" maxlength="1" inputmode="numeric">
        <input type="text" maxlength="1" inputmode="numeric">
        <input type="text" maxlength="1" inputmode="numeric">
        <input type="text" maxlength="1" inputmode="numeric">
        <input type="text" maxlength="1" inputmode="numeric">
      </div>
      <div class="otp-timer">ë‚¨ì€ ì‹œê°„ <span id="otpTimerText">03:00</span></div>
      <button class="otp-resend" onclick="resendOtp()">ì¸ì¦ë²ˆí˜¸ ì¬ë°œì†¡</button>
      <button class="login-btn" onclick="handleOtp()">ì¸ì¦ í™•ì¸</button>
      <div class="login-error" id="otpError">ì¸ì¦ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
      <div class="login-footer">Â© 2026 í˜„ëŒ€ëª¨ë¹„ìŠ¤ Â· êµ¬ë§¤ë³¸ë¶€</div>
    </div>
  </div>
</div>

<!-- Sidebar LNB -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-header">
    <div class="sidebar-logo-icon" style="cursor:pointer;">AI</div>
    <span class="sidebar-logo-text">êµ¬ë§¤ì›ê°€ AI</span>
    <button id="sidebarCollapseBtn" style="margin-left:auto;width:28px;height:28px;border-radius:6px;border:none;background:#333;color:#fff;cursor:pointer;font-size:16px;display:flex;align-items:center;justify-content:center;transition:transform 0.3s;">Â«</button>
  </div>
  <nav class="sidebar-nav">
    <div class="sidebar-section">ë¶„ì„</div>
    <div class="sidebar-item" data-page="parsing" onclick="switchPage('parsing')">
      <span class="sidebar-item-icon">ğŸ“„</span>
      <span class="sidebar-item-text">íŒŒì‹±</span>
      <span class="sidebar-item-badge blue">5</span>
    </div>
    <div class="sidebar-item active" data-page="verification" onclick="switchPage('verification')">
      <span class="sidebar-item-icon">âœ…</span>
      <span class="sidebar-item-text">ê²€ì¦</span>
      <span class="sidebar-item-badge red">2</span>
    </div>
    <div class="sidebar-item" data-page="insight" onclick="switchPage('insight')">
      <span class="sidebar-item-icon">ğŸ’¡</span>
      <span class="sidebar-item-text">ì¸ì‚¬ì´íŠ¸ ìŠ¤íŠœë””ì˜¤</span>
      
    </div>

    <div class="sidebar-divider"></div>

    <div class="sidebar-section">ê´€ë¦¬</div>
    <div class="sidebar-item" data-page="model" onclick="switchPage('model')">
      <span class="sidebar-item-icon">âš™ï¸</span>
      <span class="sidebar-item-text">êµ¬ë§¤ì›ê°€ ëª¨ë¸ê´€ë¦¬</span>
      
    </div>
    <div class="sidebar-item">
      <span class="sidebar-item-icon">ğŸ”§</span>
      <span class="sidebar-item-text">ì„¤ì •</span>
      
    </div>
  </nav>
  <div class="sidebar-divider"></div>
  <div class="sidebar-item" onclick="handleLogout()" style="color:#ff6b6b;">
    <span class="sidebar-item-icon">ğŸšª</span>
    <span class="sidebar-item-text">ë¡œê·¸ì•„ì›ƒ</span>
  </div>
  <div class="sidebar-footer">
    <div class="sidebar-avatar">HY</div>
    <div class="sidebar-user-info">
      <div class="sidebar-user-name">HANY</div>
      <div class="sidebar-user-role">ê´€ë¦¬ì</div>
    </div>
  </div>
</div>
<div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

<div class="main-wrapper" id="mainWrapper">

<!-- Header -->
<div class="header">
  <div class="header-left">
    <span class="breadcrumb">ê²€ì¦ ></span>
    <h1>ê²¬ì ì„œ_2026-02-10_í˜„ëŒ€ëª¨ë¹„ìŠ¤</h1>
  </div>
  <div class="header-right">
    <button class="btn btn-outline">ì´ˆê¸°í™”</button>
    <button class="btn btn-outline">ì €ì¥</button>
    <button class="btn btn-primary">ì™„ë£Œ & í•™ìŠµ</button>
  </div>
</div>

<!-- Status Bar -->
<div class="status-bar">
  <div class="status-items">
    <div class="status-item">
      <span class="label">ìˆ˜ì •ëœ í•­ëª©</span>
      <span class="value">1ê°œ</span>
    </div>
    <div class="status-item">
      <span class="label">ì‹ ë¢°ë„</span>
      <span class="value green">92%</span>
    </div>
    <div class="status-item">
      <span class="label">íŒŒì‹±í•­ëª©</span>
      <span class="value">24ê±´</span>
    </div>
    <div class="status-item">
      <span class="label">ì´ìƒì¹˜</span>
      <span class="value red">2ê±´</span>
    </div>
    <div class="status-item">
      <span class="label">í•˜ìœ„ ê²¬ì ì„œ</span>
      <span class="value">3ê°œ</span>
    </div>
  </div>
  <div style="display:flex; gap:12px; align-items:center;">
    <div class="view-tabs">
      <div class="view-tab">í‘œì¤€</div>
      <div class="view-tab">ë¦¬ìŠ¤íŠ¸</div>
      <div class="view-tab active">ê´€ê³„ë„</div>
    </div>
    <button class="btn" style="font-size:12px;">ğŸ“„ ì›ë³¸ë³´ê¸°</button>
  </div>
</div>

<!-- Insight Studio -->
<div class="insight-container" id="insightPage">
  <div class="insight-header-bar">
    <span class="breadcrumb" style="font-size:13px;color:#86868b;">ì¸ì‚¬ì´íŠ¸ ìŠ¤íŠœë””ì˜¤</span>
  </div>

  <div class="insight-body">
    <div class="insight-welcome">
      <div class="insight-welcome-icon">ğŸ’¡</div>
      <div class="insight-welcome-title">ì¸ì‚¬ì´íŠ¸ ìŠ¤íŠœë””ì˜¤</div>
      <div class="insight-welcome-sub">êµ¬ë§¤ì›ê°€ ë°ì´í„°ë¥¼ AIì—ê²Œ ì§ˆë¬¸í•˜ê³  ì¸ì‚¬ì´íŠ¸ë¥¼ ì–»ìœ¼ì„¸ìš”</div>
    </div>

    <div class="insight-suggestions">
      <div class="insight-suggestion" onclick="sendSuggestion(this)">
        <span class="insight-suggestion-icon">ğŸ“Š</span>
        <span class="insight-suggestion-text">HEAD LINING ê²¬ì ì„œì—ì„œ ì¬ë£Œë¹„ ë¹„ì¤‘ì´ ë†’ì€ í•­ëª©ì„ ë¶„ì„í•´ì¤˜</span>
      </div>
      <div class="insight-suggestion" onclick="sendSuggestion(this)">
        <span class="insight-suggestion-icon">ğŸ”</span>
        <span class="insight-suggestion-text">ìµœê·¼ ê²¬ì ì„œì—ì„œ ì´ìƒì¹˜ë¡œ íƒì§€ëœ í•­ëª©ë“¤ì„ ìš”ì•½í•´ì¤˜</span>
      </div>
      <div class="insight-suggestion" onclick="sendSuggestion(this)">
        <span class="insight-suggestion-icon">ğŸ“ˆ</span>
        <span class="insight-suggestion-text">SKIN í‘œí”¼ì¬ ë‹¨ê°€ ì¶”ì´ë¥¼ ê³¼ê±° ê²¬ì ê³¼ ë¹„êµí•´ì¤˜</span>
      </div>
      <div class="insight-suggestion" onclick="sendSuggestion(this)">
        <span class="insight-suggestion-icon">ğŸ’°</span>
        <span class="insight-suggestion-text">ëŒ€í•œ(ì£¼) í˜‘ë ¥ì‚¬ì˜ ê°€ê³µë¹„ êµ¬ì¡°ê°€ ì ì •í•œì§€ í‰ê°€í•´ì¤˜</span>
      </div>
    </div>

    <!-- Chat Messages -->
    <div class="chat-messages" id="chatMessages">
      <!-- Sample conversation -->
      <div class="chat-msg user">
        <div class="chat-avatar user-avatar">HY</div>
        <div>
          <div class="chat-bubble">HEAD LINING ê²¬ì ì„œì—ì„œ ì¬ë£Œë¹„ ë¹„ì¤‘ì´ ë†’ì€ í•­ëª©ì„ ë¶„ì„í•´ì¤˜</div>
          <div class="chat-meta">ì˜¤í›„ 2:45</div>
        </div>
      </div>

      <div class="chat-msg ai">
        <div class="chat-avatar ai-avatar">AI</div>
        <div>
          <div class="chat-bubble">
            <strong>HEAD LINING ì›ê°€ê³„ì‚°ì„œ â€” ì¬ë£Œë¹„ ë¶„ì„</strong><br><br>
            ì „ì²´ ìƒì‚°ì›ê°€ â‚©76,800 ì¤‘ ì¬ë£Œë¹„ê°€ <strong>â‚©45,200 (58.9%)</strong>ë¡œ ê°€ì¥ í° ë¹„ì¤‘ì„ ì°¨ì§€í•©ë‹ˆë‹¤.<br><br>
            <table class="chat-table">
              <thead>
                <tr><th>í•­ëª©</th><th>ê¸ˆì•¡</th><th>ë¹„ì¤‘</th><th>ìƒíƒœ</th></tr>
              </thead>
              <tbody>
                <tr><td>SKIN (í‘œí”¼ì¬)</td><td style="color:#ff3b30;font-weight:600;">â‚©22,700</td><td>29.6%</td><td>âš ï¸ ì´ìƒì¹˜</td></tr>
                <tr><td>SUBSTRATE (ê¸°ì¬)</td><td>â‚©18,500</td><td>24.1%</td><td>âœ… ì •ìƒ</td></tr>
                <tr><td>ADHESIVE</td><td>â‚©2,200</td><td>2.9%</td><td>âœ… ì •ìƒ</td></tr>
                <tr><td>CLIP + PACKING</td><td>â‚©1,800</td><td>2.3%</td><td>âœ… ì •ìƒ</td></tr>
              </tbody>
            </table>
            <br>
            <strong>ğŸ” ì£¼ìš” ì¸ì‚¬ì´íŠ¸:</strong><br>
            â€¢ SKIN í‘œí”¼ì¬ê°€ ì¬ë£Œë¹„ì˜ <strong>50.2%</strong>ë¥¼ ì°¨ì§€í•˜ë©°, ê³¼ê±° í‰ê·  ëŒ€ë¹„ <strong>+35% ë†’ìŒ</strong><br>
            â€¢ PVC 0.8mm ë‹¨ê°€ â‚©18,917/MÂ²ëŠ” ì‹œì¥ í‰ê· (â‚©14,000~16,000) ëŒ€ë¹„ ìƒìœ„ê¶Œ<br>
            â€¢ ì›ìì¬ ê°€ê²© ì¸ìƒ ë˜ëŠ” í˜‘ë ¥ì‚¬ ë‹¨ê°€ ì¬í˜‘ìƒ ê²€í† ë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤
          </div>
          <div class="chat-meta">ì˜¤í›„ 2:45 Â· HEAD_LINING_ì›ê°€ê³„ì‚°ì„œ.xlsx ê¸°ë°˜</div>
        </div>
      </div>

      <div class="chat-msg user">
        <div class="chat-avatar user-avatar">HY</div>
        <div>
          <div class="chat-bubble">SKIN ë‹¨ê°€ë¥¼ ì‹œì¥ í‰ê· ìœ¼ë¡œ ì¡°ì •í•˜ë©´ ì›ê°€ê°€ ì–¼ë§ˆë‚˜ ì¤„ì–´?</div>
          <div class="chat-meta">ì˜¤í›„ 2:46</div>
        </div>
      </div>

      <div class="chat-msg ai">
        <div class="chat-avatar ai-avatar">AI</div>
        <div>
          <div class="chat-bubble">
            <strong>SKIN ë‹¨ê°€ ì¡°ì • ì‹œë®¬ë ˆì´ì…˜</strong><br><br>
            í˜„ì¬ ë‹¨ê°€ â‚©18,917/MÂ² â†’ ì‹œì¥ í‰ê·  â‚©15,000/MÂ²ë¡œ ì¡°ì • ì‹œ:<br><br>
            â€¢ SKIN ê¸ˆì•¡: â‚©22,700 â†’ <strong style="color:#34c759;">â‚©18,000</strong> (â–¼â‚©4,700)<br>
            â€¢ ì¬ë£Œë¹„ í•©ê³„: â‚©45,200 â†’ <strong style="color:#34c759;">â‚©40,500</strong><br>
            â€¢ ìƒì‚°ì›ê°€: â‚©76,800 â†’ <strong style="color:#34c759;">â‚©72,100</strong><br><br>
            ğŸ“‰ <strong>â‚©4,700 ì ˆê° (6.1% ê°ì†Œ)</strong><br><br>
            ì—°ê°„ ìƒì‚°ëŸ‰ 10,000ëŒ€ ê¸°ì¤€ ì•½ <strong>â‚©4,700ë§Œì›</strong> ì ˆê° íš¨ê³¼ì…ë‹ˆë‹¤.
          </div>
          <div class="chat-meta">ì˜¤í›„ 2:46 Â· ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼</div>
        </div>
      </div>
    </div>

    <!-- Chat Input -->
    <div class="chat-input-area">
      <div class="chat-context-bar">
        <div class="context-chip">ğŸ“„ HEAD_LINING_ì›ê°€ê³„ì‚°ì„œ.xlsx <span class="remove">âœ•</span></div>
        <div class="context-chip">ğŸ“„ DOOR_TRIM_ê²¬ì ì„œ.xlsx <span class="remove">âœ•</span></div>
      </div>
      <div class="chat-input-wrap">
        <input class="chat-input" placeholder="êµ¬ë§¤ì›ê°€ì— ëŒ€í•´ ë¬´ì—‡ì´ë“  ì§ˆë¬¸í•˜ì„¸ìš”..." id="chatInput" />
        <button class="chat-attach-btn" title="íŒŒì¼ ì²¨ë¶€">ğŸ“</button>
        <button class="chat-send-btn" title="ì „ì†¡" onclick="sendChat()">â†‘</button>
      </div>
    </div>
  </div>
</div>

<!-- Parsing Page -->
<!-- Model Management Page -->
<div class="model-page" id="modelPage">
  <div class="model-page-header">
    <div>
      <div class="model-page-title">êµ¬ë§¤ì›ê°€ ëª¨ë¸ê´€ë¦¬</div>
      <div class="model-page-sub">ê²¬ì ì„œ ë¶„ì„ì— ì‚¬ìš©ë˜ëŠ” ì›ê°€ ê³„ì‚° ìˆ˜ì‹ì„ ê´€ë¦¬í•©ë‹ˆë‹¤</div>
    </div>
    <button class="model-add-btn" onclick="addFormula()">â• ìˆ˜ì‹ ì¶”ê°€</button>
  </div>

  <div class="formula-list" id="formulaList">
    <!-- 1. í•µì‹¬ ìˆ˜ì‹ -->
    <div class="formula-card">
      <div class="formula-card-header">
        <span class="formula-name">êµ¬ë§¤ì›ê°€</span>
        <span class="formula-badge core">í•µì‹¬</span>
      </div>
      <div class="formula-expression">
        <code>êµ¬ë§¤ì›ê°€ = ì¬ë£Œë¹„ + ê°€ê³µë¹„ + ì œê²½ë¹„ + ì´ìœ¤</code>
      </div>
      <div class="formula-desc">ìµœì¢… êµ¬ë§¤ì›ê°€ë¥¼ ì‚°ì¶œí•˜ëŠ” ê¸°ë³¸ ìˆ˜ì‹. ëª¨ë“  ê²¬ì ì„œ ê²€ì¦ì˜ ê¸°ì¤€ì´ ë©ë‹ˆë‹¤.</div>
      <div class="formula-var-list">
        <span class="formula-var">ì¬ë£Œë¹„</span>
        <span class="formula-var">ê°€ê³µë¹„</span>
        <span class="formula-var">ì œê²½ë¹„</span>
        <span class="formula-var">ì´ìœ¤</span>
      </div>
      <div class="formula-actions">
        <button class="formula-action-btn edit">âœï¸ ìˆ˜ì •</button>
        <button class="formula-action-btn delete">ğŸ—‘ ì‚­ì œ</button>
      </div>
    </div>

    <!-- 2. ìƒì‚°ì›ê°€ -->
    <div class="formula-card">
      <div class="formula-card-header">
        <span class="formula-name">ìƒì‚°ì›ê°€</span>
        <span class="formula-badge core">í•µì‹¬</span>
      </div>
      <div class="formula-expression">
        <code>ìƒì‚°ì›ê°€ = ì¬ë£Œë¹„ + ê°€ê³µë¹„ + ì œê²½ë¹„</code>
      </div>
      <div class="formula-desc">ì´ìœ¤ì„ ì œì™¸í•œ ìˆœìˆ˜ ìƒì‚° ë¹„ìš©. ì›ê°€ ë¶„ì„ì˜ ê¸°ë³¸ ë‹¨ìœ„ì…ë‹ˆë‹¤.</div>
      <div class="formula-var-list">
        <span class="formula-var">ì¬ë£Œë¹„</span>
        <span class="formula-var">ê°€ê³µë¹„</span>
        <span class="formula-var">ì œê²½ë¹„</span>
      </div>
      <div class="formula-actions">
        <button class="formula-action-btn edit">âœï¸ ìˆ˜ì •</button>
        <button class="formula-action-btn delete">ğŸ—‘ ì‚­ì œ</button>
      </div>
    </div>

    <!-- 3. ì¬ë£Œë¹„ -->
    <div class="formula-card">
      <div class="formula-card-header">
        <span class="formula-name">ì¬ë£Œë¹„</span>
        <span class="formula-badge sub">í•˜ìœ„í•­ëª©</span>
      </div>
      <div class="formula-expression">
        <code>ì¬ë£Œë¹„ = ì£¼ì¬ë£Œë¹„ + ë¶€ì¬ë£Œë¹„ + ì™¸ì£¼ê°€ê³µë¹„</code>
      </div>
      <div class="formula-desc">ì œí’ˆ ìƒì‚°ì— ì§ì ‘ íˆ¬ì…ë˜ëŠ” ì›ì¬ë£Œ ë¹„ìš©ì˜ í•©ê³„.</div>
      <div class="formula-var-list">
        <span class="formula-var">ì£¼ì¬ë£Œë¹„</span>
        <span class="formula-var">ë¶€ì¬ë£Œë¹„</span>
        <span class="formula-var">ì™¸ì£¼ê°€ê³µë¹„</span>
      </div>
      <div class="formula-actions">
        <button class="formula-action-btn edit">âœï¸ ìˆ˜ì •</button>
        <button class="formula-action-btn delete">ğŸ—‘ ì‚­ì œ</button>
      </div>
    </div>

    <!-- 4. ê°€ê³µë¹„ -->
    <div class="formula-card">
      <div class="formula-card-header">
        <span class="formula-name">ê°€ê³µë¹„</span>
        <span class="formula-badge sub">í•˜ìœ„í•­ëª©</span>
      </div>
      <div class="formula-expression">
        <code>ê°€ê³µë¹„ = ì§ì ‘ë…¸ë¬´ë¹„ + ì§ì ‘ê²½ë¹„ + ê°„ì ‘ë…¸ë¬´ë¹„ + ê°„ì ‘ê²½ë¹„</code>
      </div>
      <div class="formula-desc">ì œí’ˆì„ ê°€ê³µÂ·ì œì¡°í•˜ëŠ” ë° ì†Œìš”ë˜ëŠ” ì¸ê±´ë¹„ ë° ê²½ë¹„.</div>
      <div class="formula-var-list">
        <span class="formula-var">ì§ì ‘ë…¸ë¬´ë¹„</span>
        <span class="formula-var">ì§ì ‘ê²½ë¹„</span>
        <span class="formula-var">ê°„ì ‘ë…¸ë¬´ë¹„</span>
        <span class="formula-var">ê°„ì ‘ê²½ë¹„</span>
      </div>
      <div class="formula-actions">
        <button class="formula-action-btn edit">âœï¸ ìˆ˜ì •</button>
        <button class="formula-action-btn delete">ğŸ—‘ ì‚­ì œ</button>
      </div>
    </div>

    <!-- 5. ì œê²½ë¹„ -->
    <div class="formula-card">
      <div class="formula-card-header">
        <span class="formula-name">ì œê²½ë¹„</span>
        <span class="formula-badge sub">í•˜ìœ„í•­ëª©</span>
      </div>
      <div class="formula-expression">
        <code>ì œê²½ë¹„ = ê°€ê³µë¹„ Ã— ì œê²½ë¹„ìœ¨</code>
      </div>
      <div class="formula-desc">ê°€ê³µë¹„ ëŒ€ë¹„ ì¼ì • ë¹„ìœ¨ë¡œ ì‚°ì¶œë˜ëŠ” ì œì¡° ê°„ì ‘ë¹„.</div>
      <div class="formula-var-list">
        <span class="formula-var">ê°€ê³µë¹„</span>
        <span class="formula-var">ì œê²½ë¹„ìœ¨</span>
      </div>
      <div class="formula-actions">
        <button class="formula-action-btn edit">âœï¸ ìˆ˜ì •</button>
        <button class="formula-action-btn delete">ğŸ—‘ ì‚­ì œ</button>
      </div>
    </div>

    <!-- 6. ì´ìœ¤ -->
    <div class="formula-card">
      <div class="formula-card-header">
        <span class="formula-name">ì´ìœ¤</span>
        <span class="formula-badge rate">ë¹„ìœ¨</span>
      </div>
      <div class="formula-expression">
        <code>ì´ìœ¤ = ìƒì‚°ì›ê°€ Ã— ì´ìœ¤ìœ¨</code>
      </div>
      <div class="formula-desc">ê³µê¸‰ìì˜ ì ì • ì´ìœ¤. ì¼ë°˜ì ìœ¼ë¡œ ìƒì‚°ì›ê°€ì˜ ì¼ì • ë¹„ìœ¨ë¡œ ì‚°ì •.</div>
      <div class="formula-var-list">
        <span class="formula-var">ìƒì‚°ì›ê°€</span>
        <span class="formula-var">ì´ìœ¤ìœ¨</span>
      </div>
      <div class="formula-actions">
        <button class="formula-action-btn edit">âœï¸ ìˆ˜ì •</button>
        <button class="formula-action-btn delete">ğŸ—‘ ì‚­ì œ</button>
      </div>
    </div>

    <!-- 7. ì£¼ì¬ë£Œë¹„ -->
    <div class="formula-card">
      <div class="formula-card-header">
        <span class="formula-name">ì£¼ì¬ë£Œë¹„</span>
        <span class="formula-badge sub">í•˜ìœ„í•­ëª©</span>
      </div>
      <div class="formula-expression">
        <code>ì£¼ì¬ë£Œë¹„ = Î£(ìì¬ë‹¨ê°€ Ã— ì†Œìš”ëŸ‰ Ã— (1 + ì†ì‹¤ìœ¨))</code>
      </div>
      <div class="formula-desc">BOM(ìì¬ëª…ì„¸ì„œ) ê¸°ì¤€ ì£¼ìš” ì›ìì¬ì˜ íˆ¬ì… ë¹„ìš© í•©ê³„.</div>
      <div class="formula-var-list">
        <span class="formula-var">ìì¬ë‹¨ê°€</span>
        <span class="formula-var">ì†Œìš”ëŸ‰</span>
        <span class="formula-var">ì†ì‹¤ìœ¨</span>
      </div>
      <div class="formula-actions">
        <button class="formula-action-btn edit">âœï¸ ìˆ˜ì •</button>
        <button class="formula-action-btn delete">ğŸ—‘ ì‚­ì œ</button>
      </div>
    </div>
  </div>
</div>

<div class="parsing-container" id="parsingPage">
  <div style="padding:12px 24px 0;display:flex;align-items:center;gap:12px;">
    <span class="breadcrumb" style="font-size:13px;color:#86868b;">íŒŒì‹±</span>
  </div>
  <div class="parsing-header-area">
    <div class="parsing-title">ì–´ë–¤ íŒŒì¼ì„ ë¶„ì„ í• ê¹Œìš”?</div>
    <div class="parsing-subtitle">íŒŒì¼ì„ ì—…ë¡œë“œ í•˜ì‹œë©´ ìë™ìœ¼ë¡œ ë¶„ì„ì„ ì‹œì‘í•´ìš”</div>
    <div class="parsing-search">
      <input class="parsing-search-input" placeholder="ë¬¸ì„œëª…ìœ¼ë¡œ ê²€ìƒ‰í•´ ë³´ì„¸ìš”." />
      <button class="parsing-filter-btn">ğŸ” ìƒì„¸ì¡°íšŒ</button>
    </div>
  </div>

  <!-- Upload Area -->
  <div class="upload-area" id="uploadArea">
    <div class="upload-icon">ğŸ“</div>
    <div class="upload-text">íŒŒì¼ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ <strong>í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ</strong></div>
    <div class="upload-formats">ì§€ì› í˜•ì‹: xls, xlsx, ì´ë¯¸ì§€(jpg, png) Â· ìµœëŒ€ 50MB</div>
  </div>

  <!-- Status Cards -->
  <div class="status-cards">
    <div class="status-card sc-all active" onclick="filterFiles('all')">
      <div class="status-card-count">5</div>
      <div class="status-card-label">ì „ì²´íŒŒì¼</div>
    </div>
    <div class="status-card sc-extracting" onclick="filterFiles('extracting')">
      <div class="status-card-count">1</div>
      <div class="status-card-label">ì¶”ì¶œì¤‘</div>
    </div>
    <div class="status-card sc-complete" onclick="filterFiles('complete')">
      <div class="status-card-count">2</div>
      <div class="status-card-label">ì¶”ì¶œì™„ë£Œ</div>
    </div>
    <div class="status-card sc-failed" onclick="filterFiles('failed')">
      <div class="status-card-count">1</div>
      <div class="status-card-label">ì¶”ì¶œì‹¤íŒ¨</div>
    </div>
    <div class="status-card sc-analyzing" onclick="filterFiles('analyzing')">
      <div class="status-card-count">1</div>
      <div class="status-card-label">ë¶„ì„ì™„ë£Œ</div>
    </div>
  </div>

  <!-- File List -->
  <div class="file-list">
    <table class="file-table">
      <thead>
        <tr>
          <th style="width:30px;"></th>
          <th>ë¬¸ì„œëª…</th>
          <th style="width:100px;">ìƒíƒœ</th>
          <th style="width:100px;">ì§„í–‰ë¥ </th>
          <th style="width:80px;">íŒŒì‹±í•­ëª©</th>
          <th style="width:80px;">ì´ìƒì¹˜</th>
          <th style="width:100px;">ì—…ë¡œë“œì¼</th>
          <th style="width:160px;">ì•¡ì…˜</th>
        </tr>
      </thead>
      <tbody>
        <!-- 1. ì¶”ì¶œì¤‘ -->
        <tr class="file-row" data-status="extracting" onclick="openDrawer('extracting')">
          <td>ğŸ“„</td>
          <td class="file-name">CONSOLE_BOX_ì›ê°€ëª…ì„¸.xlsx</td>
          <td><span class="file-status fs-extracting">â³ ì¶”ì¶œì¤‘</span></td>
          <td>
            <div class="file-progress"><div class="file-progress-fill" style="width:65%;background:#ff9500;"></div></div>
            <span style="font-size:11px;color:#86868b;">65%</span>
          </td>
          <td style="color:#86868b;">â€”</td>
          <td style="color:#86868b;">â€”</td>
          <td>2026-02-19</td>
          <td class="file-actions">
            <button class="file-action-btn disabled">ë¬¸ì„œìƒì„¸ë³´ê¸°</button>
          </td>
        </tr>
        <!-- 2. ì¶”ì¶œì™„ë£Œ -->
        <tr class="file-row" data-status="complete" onclick="openDrawer('complete')">
          <td>ğŸ“„</td>
          <td class="file-name">HEAD_LINING_ì›ê°€ê³„ì‚°ì„œ.xlsx</td>
          <td><span class="file-status fs-complete">âœ… ì¶”ì¶œì™„ë£Œ</span></td>
          <td>
            <div class="file-progress"><div class="file-progress-fill" style="width:100%;background:#34c759;"></div></div>
            <span style="font-size:11px;color:#86868b;">100%</span>
          </td>
          <td>24ê±´</td>
          <td><span style="color:#ff3b30;font-weight:600;">2ê±´</span></td>
          <td>2026-02-18</td>
          <td class="file-actions">
            <button class="file-action-btn primary" onclick="event.stopPropagation(); switchPage('verification')">ë¬¸ì„œìƒì„¸ë³´ê¸°</button>
          </td>
        </tr>
        <!-- 3. ì¶”ì¶œì™„ë£Œ -->
        <tr class="file-row" data-status="complete" onclick="openDrawer('complete2')">
          <td>ğŸ“„</td>
          <td class="file-name">DOOR_TRIM_ê²¬ì ì„œ.xlsx</td>
          <td><span class="file-status fs-complete">âœ… ì¶”ì¶œì™„ë£Œ</span></td>
          <td>
            <div class="file-progress"><div class="file-progress-fill" style="width:100%;background:#34c759;"></div></div>
            <span style="font-size:11px;color:#86868b;">100%</span>
          </td>
          <td>18ê±´</td>
          <td><span style="color:#86868b;">0ê±´</span></td>
          <td>2026-02-17</td>
          <td class="file-actions">
            <button class="file-action-btn primary">ë¬¸ì„œìƒì„¸ë³´ê¸°</button>
          </td>
        </tr>
        <!-- 4. ì¶”ì¶œì‹¤íŒ¨ -->
        <tr class="file-row" data-status="failed" onclick="openDrawer('failed')">
          <td>ğŸ“„</td>
          <td class="file-name">SEAT_COVER_ì›ê°€ë¶„ì„.xlsx</td>
          <td><span class="file-status fs-failed">âŒ ì¶”ì¶œì‹¤íŒ¨</span></td>
          <td>
            <div class="file-progress"><div class="file-progress-fill" style="width:30%;background:#ff3b30;"></div></div>
            <span style="font-size:11px;color:#86868b;">30%</span>
          </td>
          <td style="color:#86868b;">â€”</td>
          <td style="color:#86868b;">â€”</td>
          <td>2026-02-16</td>
          <td class="file-actions">
            <button class="file-action-btn" style="color:#ff3b30;border-color:#ff3b30;">ì‹¤íŒ¨ì‚¬ìœ </button>
            <button class="file-action-btn">ì¬ì‹œë„</button>
          </td>
        </tr>
        <!-- 5. ë¶„ì„ì™„ë£Œ -->
        <tr class="file-row" data-status="analyzing" onclick="openDrawer('analyzed')">
          <td>ğŸ“„</td>
          <td class="file-name">BUMPER_ASSY_Q4ê²¬ì .xlsx</td>
          <td><span class="file-status fs-analyzing">ğŸŸ£ ë¶„ì„ì™„ë£Œ</span></td>
          <td>
            <div class="file-progress"><div class="file-progress-fill" style="width:100%;background:#af52de;"></div></div>
            <span style="font-size:11px;color:#86868b;">100%</span>
          </td>
          <td>32ê±´</td>
          <td><span style="color:#86868b;">0ê±´</span></td>
          <td>2026-02-15</td>
          <td class="file-actions">
            <button class="file-action-btn primary">ë¬¸ì„œìƒì„¸ë³´ê¸°</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Detail Drawer -->
<div class="detail-drawer" id="detailDrawer">
  <!-- Extracting state -->
  <div id="drawer-extracting" style="display:none;flex-direction:column;height:100%;">
    <div class="drawer-header">
      <div>
        <div style="font-size:15px;font-weight:600;">CONSOLE_BOX_ì›ê°€ëª…ì„¸.xlsx</div>
        <div style="font-size:12px;color:#86868b;margin-top:2px;">ì¶”ì¶œ ì§„í–‰ì¤‘...</div>
      </div>
      <button class="popup-close" onclick="closeDrawer()">âœ•</button>
    </div>
    <div class="drawer-body">
      <div class="drawer-section">
        <div class="drawer-section-title">íŒŒì¼ ì •ë³´</div>
        <div class="drawer-info-grid">
          <div class="drawer-info-item"><div class="drawer-info-label">íŒŒì¼ í¬ê¸°</div><div class="drawer-info-value">2.4 MB</div></div>
          <div class="drawer-info-item"><div class="drawer-info-label">ì‹œíŠ¸ ìˆ˜</div><div class="drawer-info-value">3ê°œ</div></div>
          <div class="drawer-info-item"><div class="drawer-info-label">ì—…ë¡œë“œ ì‹œê°„</div><div class="drawer-info-value">14:32:15</div></div>
          <div class="drawer-info-item"><div class="drawer-info-label">ì˜ˆìƒ ì™„ë£Œ</div><div class="drawer-info-value">~2ë¶„</div></div>
        </div>
      </div>
      <div class="drawer-section">
        <div class="drawer-section-title">ì¶”ì¶œ ì§„í–‰ ìƒí™©</div>
        <div style="margin-bottom:12px;">
          <div style="display:flex;justify-content:space-between;font-size:12px;margin-bottom:4px;">
            <span>ì „ì²´ ì§„í–‰ë¥ </span><span style="font-weight:600;color:#ff9500;">65%</span>
          </div>
          <div class="file-progress" style="width:100%;height:8px;">
            <div class="file-progress-fill" style="width:65%;background:linear-gradient(90deg,#ff9500,#ffb340);"></div>
          </div>
        </div>
        <div style="font-size:12px;color:#86868b;display:flex;flex-direction:column;gap:6px;">
          <div>âœ… Sheet 1 â€” êµ¬ì¡° ë¶„ì„ ì™„ë£Œ</div>
          <div>âœ… Sheet 2 â€” ì…€ ë§¤í•‘ ì™„ë£Œ</div>
          <div>â³ Sheet 3 â€” ë°ì´í„° ê²€ì¦ ì¤‘...</div>
        </div>
      </div>
      <div class="drawer-section">
        <div class="drawer-section-title">ì¶”ì¶œ ë¡œê·¸</div>
        <div class="extraction-log">
          <div class="log-line"><span class="log-time">14:32:16</span> <span class="log-info">íŒŒì¼ ì—…ë¡œë“œ ì™„ë£Œ (2.4MB)</span></div>
          <div class="log-line"><span class="log-time">14:32:18</span> <span class="log-ok">Sheet 1 êµ¬ì¡° ë¶„ì„ ì‹œì‘</span></div>
          <div class="log-line"><span class="log-time">14:32:45</span> <span class="log-ok">Sheet 1 íŒŒì‹± ì™„ë£Œ â€” 12ê°œ í•­ëª© ì¶”ì¶œ</span></div>
          <div class="log-line"><span class="log-time">14:32:46</span> <span class="log-ok">Sheet 2 êµ¬ì¡° ë¶„ì„ ì‹œì‘</span></div>
          <div class="log-line"><span class="log-time">14:33:10</span> <span class="log-warn">Sheet 2 ë³‘í•©ì…€ ê°ì§€ â€” ìë™ ë¶„ë¦¬</span></div>
          <div class="log-line"><span class="log-time">14:33:22</span> <span class="log-ok">Sheet 2 íŒŒì‹± ì™„ë£Œ â€” 8ê°œ í•­ëª© ì¶”ì¶œ</span></div>
          <div class="log-line"><span class="log-time">14:33:23</span> <span class="log-info">Sheet 3 ë°ì´í„° ê²€ì¦ ì¤‘...</span></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Complete state -->
  <div id="drawer-complete" style="display:none;flex-direction:column;height:100%;">
    <div class="drawer-header">
      <div>
        <div style="font-size:15px;font-weight:600;">HEAD_LINING_ì›ê°€ê³„ì‚°ì„œ.xlsx</div>
        <div style="font-size:12px;color:#34c759;margin-top:2px;">âœ… ì¶”ì¶œ ì™„ë£Œ</div>
      </div>
      <button class="popup-close" onclick="closeDrawer()">âœ•</button>
    </div>
    <div class="drawer-body">
      <div class="drawer-section">
        <div class="drawer-section-title">ì¶”ì¶œ ê²°ê³¼ ìš”ì•½</div>
        <div class="drawer-info-grid">
          <div class="drawer-info-item"><div class="drawer-info-label">íŒŒì‹± í•­ëª©</div><div class="drawer-info-value" style="color:#0071e3;">24ê±´</div></div>
          <div class="drawer-info-item"><div class="drawer-info-label">ì´ìƒì¹˜</div><div class="drawer-info-value" style="color:#ff3b30;">2ê±´</div></div>
          <div class="drawer-info-item"><div class="drawer-info-label">ì‹ ë¢°ë„</div><div class="drawer-info-value" style="color:#34c759;">92%</div></div>
          <div class="drawer-info-item"><div class="drawer-info-label">ì†Œìš”ì‹œê°„</div><div class="drawer-info-value">1ë¶„ 48ì´ˆ</div></div>
        </div>
      </div>
      <div class="drawer-section">
        <div class="drawer-section-title">íŒŒì¼ ì •ë³´</div>
        <div class="drawer-info-grid">
          <div class="drawer-info-item"><div class="drawer-info-label">íŒŒì¼ í¬ê¸°</div><div class="drawer-info-value">1.8 MB</div></div>
          <div class="drawer-info-item"><div class="drawer-info-label">ì‹œíŠ¸ ìˆ˜</div><div class="drawer-info-value">2ê°œ</div></div>
          <div class="drawer-info-item"><div class="drawer-info-label">í˜‘ë ¥ì‚¬</div><div class="drawer-info-value">ëŒ€í•œ(ì£¼)</div></div>
          <div class="drawer-info-item"><div class="drawer-info-label">í’ˆëª…</div><div class="drawer-info-value">HEAD LINING</div></div>
        </div>
      </div>
      <div class="drawer-section">
        <div class="drawer-section-title">ì¶”ì¶œ ë¡œê·¸</div>
        <div class="extraction-log">
          <div class="log-line"><span class="log-time">10:15:02</span> <span class="log-info">íŒŒì¼ ì—…ë¡œë“œ ì™„ë£Œ (1.8MB)</span></div>
          <div class="log-line"><span class="log-time">10:15:04</span> <span class="log-ok">Sheet 1 êµ¬ì¡° ë¶„ì„ ì‹œì‘</span></div>
          <div class="log-line"><span class="log-time">10:15:38</span> <span class="log-ok">Sheet 1 íŒŒì‹± ì™„ë£Œ â€” 18ê°œ í•­ëª©</span></div>
          <div class="log-line"><span class="log-time">10:15:39</span> <span class="log-ok">Sheet 2 íŒŒì‹± ì™„ë£Œ â€” 6ê°œ í•­ëª©</span></div>
          <div class="log-line"><span class="log-time">10:16:50</span> <span class="log-warn">ì´ìƒì¹˜ 2ê±´ ê°ì§€</span></div>
          <div class="log-line"><span class="log-time">10:16:50</span> <span class="log-ok">ì¶”ì¶œ ì™„ë£Œ â€” ì´ 24ê±´</span></div>
        </div>
      </div>
    </div>
    <div class="drawer-footer">
      <button class="btn btn-primary" style="flex:1;text-align:center;padding:10px;" onclick="closeDrawer(); switchPage('verification')">ë¬¸ì„œìƒì„¸ë³´ê¸°</button>
    </div>
  </div>

  <!-- Failed state -->
  <div id="drawer-failed" style="display:none;flex-direction:column;height:100%;">
    <div class="drawer-header">
      <div>
        <div style="font-size:15px;font-weight:600;">SEAT_COVER_ì›ê°€ë¶„ì„.xlsx</div>
        <div style="font-size:12px;color:#ff3b30;margin-top:2px;">âŒ ì¶”ì¶œ ì‹¤íŒ¨</div>
      </div>
      <button class="popup-close" onclick="closeDrawer()">âœ•</button>
    </div>
    <div class="drawer-body">
      <div class="drawer-section">
        <div class="drawer-section-title">ì‹¤íŒ¨ ì •ë³´</div>
        <div class="error-box">
          <div class="error-title">âš ï¸ íŒŒì‹± ì˜¤ë¥˜ â€” ì–‘ì‹ ì¸ì‹ ì‹¤íŒ¨</div>
          <div class="error-detail">
            Sheet 1ì˜ ì…€ êµ¬ì¡°ë¥¼ ì¸ì‹í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.<br>
            ì›ì¸: ë³‘í•© ì…€ì´ ë‹¤ì¤‘ ì¤‘ì²©(3ë‹¨ê³„ ì´ìƒ)ë˜ì–´ ìˆì–´ ìë™ íŒŒì‹±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.<br><br>
            <strong>ê¶Œì¥ ì¡°ì¹˜:</strong><br>
            â€¢ ì—‘ì…€ íŒŒì¼ì—ì„œ ë¶ˆí•„ìš”í•œ ë³‘í•© ì…€ í•´ì œ í›„ ì¬ì—…ë¡œë“œ<br>
            â€¢ ìˆ˜ë™ ë§¤í•‘ ëª¨ë“œë¡œ ì „í™˜í•˜ì—¬ ì§ì ‘ ì˜ì—­ ì§€ì •
          </div>
        </div>
      </div>
      <div class="drawer-section">
        <div class="drawer-section-title">íŒŒì¼ ì •ë³´</div>
        <div class="drawer-info-grid">
          <div class="drawer-info-item"><div class="drawer-info-label">íŒŒì¼ í¬ê¸°</div><div class="drawer-info-value">3.1 MB</div></div>
          <div class="drawer-info-item"><div class="drawer-info-label">ì‹œíŠ¸ ìˆ˜</div><div class="drawer-info-value">4ê°œ</div></div>
          <div class="drawer-info-item"><div class="drawer-info-label">ì‹¤íŒ¨ ì‹œì </div><div class="drawer-info-value">Sheet 1, Row 15</div></div>
          <div class="drawer-info-item"><div class="drawer-info-label">ì§„í–‰ë¥ </div><div class="drawer-info-value" style="color:#ff3b30;">30%</div></div>
        </div>
      </div>
      <div class="drawer-section">
        <div class="drawer-section-title">ì¶”ì¶œ ë¡œê·¸</div>
        <div class="extraction-log">
          <div class="log-line"><span class="log-time">09:20:01</span> <span class="log-info">íŒŒì¼ ì—…ë¡œë“œ ì™„ë£Œ (3.1MB)</span></div>
          <div class="log-line"><span class="log-time">09:20:03</span> <span class="log-ok">Sheet 1 êµ¬ì¡° ë¶„ì„ ì‹œì‘</span></div>
          <div class="log-line"><span class="log-time">09:20:15</span> <span class="log-warn">ë³‘í•© ì…€ ë‹¤ì¤‘ ì¤‘ì²© ê°ì§€ (A5:H20)</span></div>
          <div class="log-line"><span class="log-time">09:20:28</span> <span class="log-err">ERROR: ì…€ êµ¬ì¡° ì¸ì‹ ì‹¤íŒ¨ â€” Row 15 ë³‘í•© ì¶©ëŒ</span></div>
          <div class="log-line"><span class="log-time">09:20:28</span> <span class="log-err">ì¶”ì¶œ ì¤‘ë‹¨</span></div>
        </div>
      </div>
    </div>
    <div class="drawer-footer">
      <button class="btn btn-outline" style="flex:1;text-align:center;padding:10px;">ìˆ˜ë™ ë§¤í•‘</button>
      <button class="btn btn-primary" style="flex:1;text-align:center;padding:10px;">ì¬ì‹œë„</button>
    </div>
  </div>
</div>
<div class="sidebar-overlay" id="drawerOverlay" onclick="closeDrawer()" style="display:none;z-index:59;"></div>

<!-- Verification Page wrapper -->
<div id="verificationPage">

<!-- Standard View -->
<div class="standard-container" id="standardView" style="display:none;">
  <div style="padding:24px;">

    <!-- ë¬¸ì„œ ìš”ì•½ -->
    <div style="display:flex;gap:16px;margin-bottom:24px;">
      <div style="background:#fff;border:1px solid #e5e5e7;border-radius:10px;padding:16px;flex:1;">
        <div style="font-size:11px;color:#86868b;margin-bottom:4px;">E.O. NO.</div>
        <div style="font-size:14px;font-weight:600;">EO-2024-1201</div>
      </div>
      <div style="background:#fff;border:1px solid #e5e5e7;border-radius:10px;padding:16px;flex:1;">
        <div style="font-size:11px;color:#86868b;margin-bottom:4px;">í’ˆë²ˆ / í’ˆëª…</div>
        <div style="font-size:14px;font-weight:600;">HL-2024-001 Â· COMPLETE ASSY-HEAD LINING</div>
      </div>
      <div style="background:#fff;border:1px solid #e5e5e7;border-radius:10px;padding:16px;flex:1;">
        <div style="font-size:11px;color:#86868b;margin-bottom:4px;">í˜‘ë ¥ì‚¬ / ë‹´ë‹¹ì</div>
        <div style="font-size:14px;font-weight:600;">ëŒ€í•œ(ì£¼) Â· ê¹€ì² ìˆ˜</div>
      </div>
      <div style="background:#fff;border:1px solid #e5e5e7;border-radius:10px;padding:16px;flex:0 0 140px;">
        <div style="font-size:11px;color:#86868b;margin-bottom:4px;">ìƒì‚°ì›ê°€</div>
        <div style="font-size:18px;font-weight:700;color:#0071e3;">â‚©76,800</div>
      </div>
    </div>

    <!-- ì¬ë£Œë¹„ ê·¸ë£¹ -->
    <div class="std-group">
      <div class="std-group-header">
        <div class="std-group-title">
          <span class="std-group-icon" style="background:#e8f4fd;color:#0071e3;">â… </span>
          ì¬ë£Œë¹„
        </div>
        <div class="std-group-summary">
          <span class="std-summary-value">â‚©45,200</span>
          <span class="std-summary-pct">58.9%</span>
          <span class="badge badge-error" style="font-size:10px;">ì´ìƒì¹˜ 1</span>
        </div>
      </div>
      <table class="std-table">
        <thead>
          <tr>
            <th style="width:50px;">ë ˆë²¨</th>
            <th style="width:80px;">êµ¬ë¶„</th>
            <th>í’ˆëª…</th>
            <th>ê·œê²©</th>
            <th style="width:50px;">ë‹¨ìœ„</th>
            <th style="width:50px;">ìˆ˜ëŸ‰</th>
            <th style="width:90px;">ë‹¨ê°€</th>
            <th style="width:90px;">ê¸ˆì•¡</th>
            <th style="width:60px;">ë¹„ìœ¨</th>
            <th style="width:70px;">ì‹ ë¢°ë„</th>
            <th style="width:60px;">ìƒíƒœ</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><span class="level-badge l0">L0</span></td>
            <td>ì›ìì¬</td>
            <td class="std-cell-name">SUBSTRATE (ê¸°ì¬) <span class="has-sub">ğŸ“ í•˜ìœ„ ê²¬ì ì„œ</span></td>
            <td>1200Ã—800Ã—3T</td>
            <td>EA</td>
            <td>1</td>
            <td>18,500</td>
            <td style="font-weight:600;">18,500</td>
            <td>24.1%</td>
            <td><div class="mini-confidence"><div class="mini-bar" style="width:95%;background:#34c759;"></div></div><span style="font-size:10px;">95%</span></td>
            <td><span class="badge badge-ok">ì •ìƒ</span></td>
          </tr>
          <tr class="sub-row">
            <td><span class="level-badge l1">L1</span></td>
            <td style="color:#86868b;">ì›ìì¬</td>
            <td class="std-cell-name" style="padding-left:28px;">â”” BASE MATERIAL</td>
            <td>PP+GF30</td>
            <td>KG</td>
            <td>2.4</td>
            <td>5,000</td>
            <td>12,000</td>
            <td>15.6%</td>
            <td><div class="mini-confidence"><div class="mini-bar" style="width:94%;background:#34c759;"></div></div><span style="font-size:10px;">94%</span></td>
            <td><span class="badge badge-ok">ì •ìƒ</span></td>
          </tr>
          <tr class="sub-row">
            <td><span class="level-badge l1">L1</span></td>
            <td style="color:#86868b;">ê°€ê³µë¹„</td>
            <td class="std-cell-name" style="padding-left:28px;">â”” ì••ì¶œ ì„±í˜•</td>
            <td></td>
            <td>íšŒ</td>
            <td>1</td>
            <td>6,500</td>
            <td>6,500</td>
            <td>8.5%</td>
            <td><div class="mini-confidence"><div class="mini-bar" style="width:94%;background:#34c759;"></div></div><span style="font-size:10px;">94%</span></td>
            <td><span class="badge badge-ok">ì •ìƒ</span></td>
          </tr>
          <tr class="anomaly-row">
            <td><span class="level-badge l0">L0</span></td>
            <td>ì›ìì¬</td>
            <td class="std-cell-name">SKIN (í‘œí”¼ì¬) <span class="anomaly-icon">âš ï¸</span></td>
            <td>PVC 0.8mm</td>
            <td>MÂ²</td>
            <td>1.2</td>
            <td>18,917</td>
            <td style="font-weight:600;color:#ff3b30;">22,700</td>
            <td>29.6%</td>
            <td><div class="mini-confidence"><div class="mini-bar" style="width:75%;background:#ff9500;"></div></div><span style="font-size:10px;color:#ff9500;">75%</span></td>
            <td><span class="badge badge-error">ì´ìƒì¹˜</span></td>
          </tr>
          <tr>
            <td><span class="level-badge l0">L0</span></td>
            <td>ì›ìì¬</td>
            <td class="std-cell-name">ADHESIVE (ì ‘ì°©ì œ)</td>
            <td>WATER BASE</td>
            <td>KG</td>
            <td>0.5</td>
            <td>4,400</td>
            <td style="font-weight:600;">2,200</td>
            <td>2.9%</td>
            <td><div class="mini-confidence"><div class="mini-bar" style="width:98%;background:#34c759;"></div></div><span style="font-size:10px;">98%</span></td>
            <td><span class="badge badge-ok">ì •ìƒ</span></td>
          </tr>
          <tr>
            <td><span class="level-badge l0">L0</span></td>
            <td>ë¶€ìì¬</td>
            <td class="std-cell-name">CLIP</td>
            <td>PA66</td>
            <td>EA</td>
            <td>12</td>
            <td>75</td>
            <td>900</td>
            <td>1.2%</td>
            <td><div class="mini-confidence"><div class="mini-bar" style="width:98%;background:#34c759;"></div></div><span style="font-size:10px;">98%</span></td>
            <td><span class="badge badge-ok">ì •ìƒ</span></td>
          </tr>
          <tr>
            <td><span class="level-badge l0">L0</span></td>
            <td>ë¶€ìì¬</td>
            <td class="std-cell-name">PACKING (í¬ì¥ì¬)</td>
            <td>ê³¨íŒì§€</td>
            <td>SET</td>
            <td>1</td>
            <td>900</td>
            <td>900</td>
            <td>1.2%</td>
            <td><div class="mini-confidence"><div class="mini-bar" style="width:98%;background:#34c759;"></div></div><span style="font-size:10px;">98%</span></td>
            <td><span class="badge badge-ok">ì •ìƒ</span></td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- ê°€ê³µë¹„ ê·¸ë£¹ -->
    <div class="std-group">
      <div class="std-group-header">
        <div class="std-group-title">
          <span class="std-group-icon" style="background:#e8fde8;color:#34c759;">â…¡</span>
          ê°€ê³µë¹„
        </div>
        <div class="std-group-summary">
          <span class="std-summary-value">â‚©23,100</span>
          <span class="std-summary-pct">30.1%</span>
        </div>
      </div>
      <table class="std-table">
        <thead>
          <tr>
            <th style="width:50px;">ë ˆë²¨</th>
            <th style="width:80px;">ê³µì •</th>
            <th>ê³µì •ëª…</th>
            <th>ê·œê²©</th>
            <th style="width:50px;">ë‹¨ìœ„</th>
            <th style="width:50px;">ìˆ˜ëŸ‰</th>
            <th style="width:90px;">ë‹¨ê°€</th>
            <th style="width:90px;">ê¸ˆì•¡</th>
            <th style="width:60px;">ë¹„ìœ¨</th>
            <th style="width:70px;">ì‹ ë¢°ë„</th>
            <th style="width:60px;">ìƒíƒœ</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><span class="level-badge l0">L0</span></td>
            <td>ì„±í˜•</td>
            <td class="std-cell-name">í”„ë ˆìŠ¤ ì„±í˜•</td>
            <td></td>
            <td>íšŒ</td>
            <td>1</td>
            <td>8,500</td>
            <td style="font-weight:600;">8,500</td>
            <td>11.1%</td>
            <td><div class="mini-confidence"><div class="mini-bar" style="width:96%;background:#34c759;"></div></div><span style="font-size:10px;">96%</span></td>
            <td><span class="badge badge-ok">ì •ìƒ</span></td>
          </tr>
          <tr>
            <td><span class="level-badge l0">L0</span></td>
            <td>ì ‘ì°©</td>
            <td class="std-cell-name">ì ‘ì°© ê³µì •</td>
            <td></td>
            <td>íšŒ</td>
            <td>1</td>
            <td>6,200</td>
            <td style="font-weight:600;">6,200</td>
            <td>8.1%</td>
            <td><div class="mini-confidence"><div class="mini-bar" style="width:94%;background:#34c759;"></div></div><span style="font-size:10px;">94%</span></td>
            <td><span class="badge badge-ok">ì •ìƒ</span></td>
          </tr>
          <tr>
            <td><span class="level-badge l0">L0</span></td>
            <td>í›„ì²˜ë¦¬</td>
            <td class="std-cell-name">íŠ¸ë¦¬ë°</td>
            <td></td>
            <td>íšŒ</td>
            <td>1</td>
            <td>5,400</td>
            <td style="font-weight:600;">5,400</td>
            <td>7.0%</td>
            <td><div class="mini-confidence"><div class="mini-bar" style="width:92%;background:#34c759;"></div></div><span style="font-size:10px;">92%</span></td>
            <td><span class="badge badge-ok">ì •ìƒ</span></td>
          </tr>
          <tr>
            <td><span class="level-badge l0">L0</span></td>
            <td>ê²€ì‚¬</td>
            <td class="std-cell-name">ê²€ì‚¬/í¬ì¥</td>
            <td></td>
            <td>íšŒ</td>
            <td>1</td>
            <td>3,000</td>
            <td style="font-weight:600;">3,000</td>
            <td>3.9%</td>
            <td><div class="mini-confidence"><div class="mini-bar" style="width:90%;background:#34c759;"></div></div><span style="font-size:10px;">90%</span></td>
            <td><span class="badge badge-ok">ì •ìƒ</span></td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- ì œê²½ë¹„ ê·¸ë£¹ -->
    <div class="std-group">
      <div class="std-group-header">
        <div class="std-group-title">
          <span class="std-group-icon" style="background:#fde8e8;color:#ff3b30;">â…¢</span>
          ì œê²½ë¹„
        </div>
        <div class="std-group-summary">
          <span class="std-summary-value">â‚©8,500</span>
          <span class="std-summary-pct">11.1%</span>
          <span class="badge badge-error" style="font-size:10px;">ì´ìƒì¹˜ 1</span>
        </div>
      </div>
      <table class="std-table">
        <thead>
          <tr>
            <th style="width:50px;">ë ˆë²¨</th>
            <th style="width:80px;">êµ¬ë¶„</th>
            <th>í•­ëª©</th>
            <th colspan="4"></th>
            <th style="width:90px;">ê¸ˆì•¡</th>
            <th style="width:60px;">ë¹„ìœ¨</th>
            <th style="width:70px;">ì‹ ë¢°ë„</th>
            <th style="width:60px;">ìƒíƒœ</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><span class="level-badge l0">L0</span></td>
            <td>ê°ê°€ìƒê°</td>
            <td class="std-cell-name">ê°ê°€ìƒê°ë¹„</td>
            <td colspan="4"></td>
            <td style="font-weight:600;">3,200</td>
            <td>4.2%</td>
            <td><div class="mini-confidence"><div class="mini-bar" style="width:90%;background:#34c759;"></div></div><span style="font-size:10px;">90%</span></td>
            <td><span class="badge badge-ok">ì •ìƒ</span></td>
          </tr>
          <tr>
            <td><span class="level-badge l0">L0</span></td>
            <td>ìœ í‹¸ë¦¬í‹°</td>
            <td class="std-cell-name">ì „ë ¥ë¹„</td>
            <td colspan="4"></td>
            <td style="font-weight:600;">2,800</td>
            <td>3.6%</td>
            <td><div class="mini-confidence"><div class="mini-bar" style="width:88%;background:#34c759;"></div></div><span style="font-size:10px;">88%</span></td>
            <td><span class="badge badge-ok">ì •ìƒ</span></td>
          </tr>
          <tr class="anomaly-row">
            <td><span class="level-badge l0">L0</span></td>
            <td>ê¸°íƒ€</td>
            <td class="std-cell-name">ê¸°íƒ€ ê²½ë¹„ <span class="anomaly-icon">âš ï¸</span></td>
            <td colspan="4"></td>
            <td style="font-weight:600;color:#ff3b30;">2,500</td>
            <td>3.3%</td>
            <td><div class="mini-confidence"><div class="mini-bar" style="width:72%;background:#ff9500;"></div></div><span style="font-size:10px;color:#ff9500;">72%</span></td>
            <td><span class="badge badge-error">ì´ìƒì¹˜</span></td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- ì†Œê³„ ê·¸ë£¹ -->
    <div class="std-group">
      <div class="std-group-header std-total-header">
        <div class="std-group-title">
          <span class="std-group-icon" style="background:#1d1d1f;color:#fff;">Î£</span>
          ì†Œê³„ (ìƒì‚°ì›ê°€)
        </div>
        <div class="std-group-summary">
          <span class="std-summary-value" style="font-size:18px;color:#0071e3;">â‚©76,800</span>
          <span class="std-summary-pct">100%</span>
        </div>
      </div>
      <table class="std-table">
        <thead>
          <tr>
            <th>êµ¬ë¶„</th>
            <th style="width:120px;">ê¸ˆì•¡</th>
            <th style="width:80px;">ë¹„ìœ¨</th>
            <th style="width:200px;">êµ¬ì„±</th>
            <th style="width:80px;">ì´ìƒì¹˜</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="font-weight:600;">â… . ì¬ë£Œë¹„</td>
            <td style="font-weight:600;">â‚©45,200</td>
            <td>58.9%</td>
            <td>
              <div class="cost-bar">
                <div class="cost-fill" style="width:58.9%;background:#0071e3;"></div>
              </div>
            </td>
            <td><span style="color:#ff3b30;font-weight:600;">1ê±´</span></td>
          </tr>
          <tr>
            <td style="font-weight:600;">â…¡. ê°€ê³µë¹„</td>
            <td style="font-weight:600;">â‚©23,100</td>
            <td>30.1%</td>
            <td>
              <div class="cost-bar">
                <div class="cost-fill" style="width:30.1%;background:#34c759;"></div>
              </div>
            </td>
            <td><span style="color:#86868b;">0ê±´</span></td>
          </tr>
          <tr>
            <td style="font-weight:600;">â…¢. ì œê²½ë¹„</td>
            <td style="font-weight:600;">â‚©8,500</td>
            <td>11.1%</td>
            <td>
              <div class="cost-bar">
                <div class="cost-fill" style="width:11.1%;background:#ff9500;"></div>
              </div>
            </td>
            <td><span style="color:#ff3b30;font-weight:600;">1ê±´</span></td>
          </tr>
          <tr style="background:#f0f4ff;font-weight:700;">
            <td>í•©ê³„</td>
            <td style="color:#0071e3;font-size:15px;">â‚©76,800</td>
            <td>100%</td>
            <td>
              <div class="cost-bar">
                <div class="cost-fill" style="width:58.9%;background:#0071e3;"></div>
                <div class="cost-fill" style="width:30.1%;background:#34c759;margin-left:-1px;"></div>
                <div class="cost-fill" style="width:11.1%;background:#ff9500;margin-left:-1px;"></div>
              </div>
            </td>
            <td style="color:#ff3b30;">2ê±´</td>
          </tr>
        </tbody>
      </table>
    </div>

  </div>
</div>

<!-- List View (ë¦¬ìŠ¤íŠ¸ ë·°) -->
<div class="list-container" id="listView">
  <div style="padding:24px;">

    <!-- ë¬¸ì„œ ìš”ì•½ (ë™ì¼) -->
    <div style="display:flex;gap:16px;margin-bottom:24px;">
      <div style="background:#fff;border:1px solid #e5e5e7;border-radius:10px;padding:16px;flex:1;">
        <div style="font-size:11px;color:#86868b;margin-bottom:4px;">E.O. NO.</div>
        <div style="font-size:14px;font-weight:600;">EO-2024-1201</div>
      </div>
      <div style="background:#fff;border:1px solid #e5e5e7;border-radius:10px;padding:16px;flex:1;">
        <div style="font-size:11px;color:#86868b;margin-bottom:4px;">í’ˆë²ˆ / í’ˆëª…</div>
        <div style="font-size:14px;font-weight:600;">HL-2024-001 Â· COMPLETE ASSY-HEAD LINING</div>
      </div>
      <div style="background:#fff;border:1px solid #e5e5e7;border-radius:10px;padding:16px;flex:1;">
        <div style="font-size:11px;color:#86868b;margin-bottom:4px;">í˜‘ë ¥ì‚¬ / ë‹´ë‹¹ì</div>
        <div style="font-size:14px;font-weight:600;">ëŒ€í•œ(ì£¼) Â· ê¹€ì² ìˆ˜</div>
      </div>
      <div style="background:#fff;border:1px solid #e5e5e7;border-radius:10px;padding:16px;flex:0 0 140px;">
        <div style="font-size:11px;color:#86868b;margin-bottom:4px;">ìƒì‚°ì›ê°€</div>
        <div style="font-size:18px;font-weight:700;color:#0071e3;">â‚©76,800</div>
      </div>
    </div>

    <!-- ì¬ë£Œë¹„ -->
    <div class="list-group">
      <div class="std-group-header">
        <div class="std-group-title">
          <span class="std-group-icon" style="background:#e8f4fd;color:#0071e3;">â… </span>
          ì¬ë£Œë¹„
        </div>
        <div class="std-group-summary">
          <span class="std-summary-value">â‚©45,200</span>
          <span class="std-summary-pct">58.9%</span>
          <span class="badge badge-error" style="font-size:10px;">ì´ìƒì¹˜ 1</span>
        </div>
      </div>
      <!-- Header -->
      <div class="list-row list-row-header">
        <div></div>
        <div>êµ¬ë¶„</div>
        <div>í’ˆëª…</div>
        <div>ê·œê²©</div>
        <div>ë‹¨ìœ„</div>
        <div>ìˆ˜ëŸ‰</div>
        <div>ë‹¨ê°€</div>
        <div>ê¸ˆì•¡</div>
        <div>ë¹„ìœ¨</div>
        <div>ì‹ ë¢°ë„</div>
        <div>ìƒíƒœ</div>
      </div>
      <!-- SUBSTRATE (has children) -->
      <div class="list-row" onclick="toggleAccordion(this)">
        <div><button class="accordion-toggle" data-target="sub-substrate">â–¶</button></div>
        <div>ì›ìì¬</div>
        <div class="std-cell-name">SUBSTRATE (ê¸°ì¬) <span class="has-sub">ğŸ“ í•˜ìœ„ ê²¬ì ì„œ</span></div>
        <div>1200Ã—800Ã—3T</div>
        <div>EA</div>
        <div>1</div>
        <div>18,500</div>
        <div style="font-weight:600;">18,500</div>
        <div>24.1%</div>
        <div><div class="mini-confidence"><div class="mini-bar" style="width:95%;background:#34c759;"></div></div><span style="font-size:10px;">95%</span></div>
        <div><span class="badge badge-ok">ì •ìƒ</span></div>
      </div>
      <div class="accordion-children" id="sub-substrate">
        <!-- Sub header -->
        <div class="list-row list-row-header">
          <div></div>
          <div>êµ¬ë¶„</div>
          <div>í’ˆëª…</div>
          <div>ê·œê²©</div>
          <div>ë‹¨ìœ„</div>
          <div>ìˆ˜ëŸ‰</div>
          <div>ë‹¨ê°€</div>
          <div>ê¸ˆì•¡</div>
          <div>ë¹„ìœ¨</div>
          <div>ì‹ ë¢°ë„</div>
          <div>ìƒíƒœ</div>
        </div>
        <div class="list-row">
          <div><button class="accordion-toggle no-child">â–¶</button></div>
          <div style="color:#86868b;">ì¬ë£Œ</div>
          <div><span class="child-connector">â””</span>BASE MATERIAL</div>
          <div>PP+GF30</div>
          <div>KG</div>
          <div>2.4</div>
          <div>5,000</div>
          <div>12,000</div>
          <div>15.6%</div>
          <div><div class="mini-confidence"><div class="mini-bar" style="width:94%;background:#34c759;"></div></div><span style="font-size:10px;">94%</span></div>
          <div><span class="badge badge-ok">ì •ìƒ</span></div>
        </div>
        <div class="list-row">
          <div><button class="accordion-toggle no-child">â–¶</button></div>
          <div style="color:#86868b;">ì¬ë£Œ</div>
          <div><span class="child-connector">â””</span>FOAM LAYER</div>
          <div>PU 5mm</div>
          <div>MÂ²</div>
          <div>1.0</div>
          <div>3,200</div>
          <div>3,200</div>
          <div>4.2%</div>
          <div><div class="mini-confidence"><div class="mini-bar" style="width:93%;background:#34c759;"></div></div><span style="font-size:10px;">93%</span></div>
          <div><span class="badge badge-ok">ì •ìƒ</span></div>
        </div>
        <div class="list-row">
          <div><button class="accordion-toggle no-child">â–¶</button></div>
          <div style="color:#86868b;">ê°€ê³µ</div>
          <div><span class="child-connector">â””</span>ì••ì¶œ ì„±í˜•</div>
          <div></div>
          <div>íšŒ</div>
          <div>1</div>
          <div>6,500</div>
          <div>6,500</div>
          <div>8.5%</div>
          <div><div class="mini-confidence"><div class="mini-bar" style="width:94%;background:#34c759;"></div></div><span style="font-size:10px;">94%</span></div>
          <div><span class="badge badge-ok">ì •ìƒ</span></div>
        </div>
        <div class="list-row" style="background:#f0f4ff;font-weight:600;">
          <div></div>
          <div></div>
          <div>SUBSTRATE ì†Œê³„</div>
          <div></div>
          <div></div>
          <div></div>
          <div></div>
          <div style="color:#0071e3;">21,700</div>
          <div>28.3%</div>
          <div></div>
          <div></div>
        </div>
      </div>

      <!-- SKIN (anomaly, no children) -->
      <div class="list-row anomaly-row">
        <div><button class="accordion-toggle no-child">â–¶</button></div>
        <div>ì›ìì¬</div>
        <div class="std-cell-name">SKIN (í‘œí”¼ì¬) <span class="anomaly-icon">âš ï¸</span></div>
        <div>PVC 0.8mm</div>
        <div>MÂ²</div>
        <div>1.2</div>
        <div>18,917</div>
        <div style="font-weight:600;color:#ff3b30;">22,700</div>
        <div>29.6%</div>
        <div><div class="mini-confidence"><div class="mini-bar" style="width:75%;background:#ff9500;"></div></div><span style="font-size:10px;color:#ff9500;">75%</span></div>
        <div><span class="badge badge-error">ì´ìƒì¹˜</span></div>
      </div>

      <!-- ADHESIVE (no children) -->
      <div class="list-row">
        <div><button class="accordion-toggle no-child">â–¶</button></div>
        <div>ì›ìì¬</div>
        <div class="std-cell-name">ADHESIVE (ì ‘ì°©ì œ)</div>
        <div>WATER BASE</div>
        <div>KG</div>
        <div>0.5</div>
        <div>4,400</div>
        <div style="font-weight:600;">2,200</div>
        <div>2.9%</div>
        <div><div class="mini-confidence"><div class="mini-bar" style="width:98%;background:#34c759;"></div></div><span style="font-size:10px;">98%</span></div>
        <div><span class="badge badge-ok">ì •ìƒ</span></div>
      </div>

      <!-- CLIP -->
      <div class="list-row">
        <div><button class="accordion-toggle no-child">â–¶</button></div>
        <div>ë¶€ìì¬</div>
        <div class="std-cell-name">CLIP</div>
        <div>PA66</div>
        <div>EA</div>
        <div>12</div>
        <div>75</div>
        <div>900</div>
        <div>1.2%</div>
        <div><div class="mini-confidence"><div class="mini-bar" style="width:98%;background:#34c759;"></div></div><span style="font-size:10px;">98%</span></div>
        <div><span class="badge badge-ok">ì •ìƒ</span></div>
      </div>

      <!-- PACKING -->
      <div class="list-row">
        <div><button class="accordion-toggle no-child">â–¶</button></div>
        <div>ë¶€ìì¬</div>
        <div class="std-cell-name">PACKING (í¬ì¥ì¬)</div>
        <div>ê³¨íŒì§€</div>
        <div>SET</div>
        <div>1</div>
        <div>900</div>
        <div>900</div>
        <div>1.2%</div>
        <div><div class="mini-confidence"><div class="mini-bar" style="width:98%;background:#34c759;"></div></div><span style="font-size:10px;">98%</span></div>
        <div><span class="badge badge-ok">ì •ìƒ</span></div>
      </div>
    </div>

    <!-- ê°€ê³µë¹„ -->
    <div class="list-group">
      <div class="std-group-header">
        <div class="std-group-title">
          <span class="std-group-icon" style="background:#e8fde8;color:#34c759;">â…¡</span>
          ê°€ê³µë¹„
        </div>
        <div class="std-group-summary">
          <span class="std-summary-value">â‚©23,100</span>
          <span class="std-summary-pct">30.1%</span>
        </div>
      </div>
      <div class="list-row list-row-header">
        <div></div>
        <div>ê³µì •</div>
        <div>ê³µì •ëª…</div>
        <div>ê·œê²©</div>
        <div>ë‹¨ìœ„</div>
        <div>ìˆ˜ëŸ‰</div>
        <div>ë‹¨ê°€</div>
        <div>ê¸ˆì•¡</div>
        <div>ë¹„ìœ¨</div>
        <div>ì‹ ë¢°ë„</div>
        <div>ìƒíƒœ</div>
      </div>
      <div class="list-row">
        <div><button class="accordion-toggle no-child">â–¶</button></div>
        <div>ì„±í˜•</div>
        <div>í”„ë ˆìŠ¤ ì„±í˜•</div>
        <div></div>
        <div>íšŒ</div>
        <div>1</div>
        <div>8,500</div>
        <div style="font-weight:600;">8,500</div>
        <div>11.1%</div>
        <div><div class="mini-confidence"><div class="mini-bar" style="width:96%;background:#34c759;"></div></div><span style="font-size:10px;">96%</span></div>
        <div><span class="badge badge-ok">ì •ìƒ</span></div>
      </div>
      <div class="list-row">
        <div><button class="accordion-toggle no-child">â–¶</button></div>
        <div>ì ‘ì°©</div>
        <div>ì ‘ì°© ê³µì •</div>
        <div></div>
        <div>íšŒ</div>
        <div>1</div>
        <div>6,200</div>
        <div style="font-weight:600;">6,200</div>
        <div>8.1%</div>
        <div><div class="mini-confidence"><div class="mini-bar" style="width:94%;background:#34c759;"></div></div><span style="font-size:10px;">94%</span></div>
        <div><span class="badge badge-ok">ì •ìƒ</span></div>
      </div>
      <div class="list-row">
        <div><button class="accordion-toggle no-child">â–¶</button></div>
        <div>í›„ì²˜ë¦¬</div>
        <div>íŠ¸ë¦¬ë°</div>
        <div></div>
        <div>íšŒ</div>
        <div>1</div>
        <div>5,400</div>
        <div style="font-weight:600;">5,400</div>
        <div>7.0%</div>
        <div><div class="mini-confidence"><div class="mini-bar" style="width:92%;background:#34c759;"></div></div><span style="font-size:10px;">92%</span></div>
        <div><span class="badge badge-ok">ì •ìƒ</span></div>
      </div>
      <div class="list-row">
        <div><button class="accordion-toggle no-child">â–¶</button></div>
        <div>ê²€ì‚¬</div>
        <div>ê²€ì‚¬/í¬ì¥</div>
        <div></div>
        <div>íšŒ</div>
        <div>1</div>
        <div>3,000</div>
        <div style="font-weight:600;">3,000</div>
        <div>3.9%</div>
        <div><div class="mini-confidence"><div class="mini-bar" style="width:90%;background:#34c759;"></div></div><span style="font-size:10px;">90%</span></div>
        <div><span class="badge badge-ok">ì •ìƒ</span></div>
      </div>
    </div>

    <!-- ì œê²½ë¹„ -->
    <div class="list-group">
      <div class="std-group-header">
        <div class="std-group-title">
          <span class="std-group-icon" style="background:#fde8e8;color:#ff3b30;">â…¢</span>
          ì œê²½ë¹„
        </div>
        <div class="std-group-summary">
          <span class="std-summary-value">â‚©8,500</span>
          <span class="std-summary-pct">11.1%</span>
          <span class="badge badge-error" style="font-size:10px;">ì´ìƒì¹˜ 1</span>
        </div>
      </div>
      <div class="list-row list-row-header">
        <div></div>
        <div>êµ¬ë¶„</div>
        <div>í•­ëª©</div>
        <div colspan="4"></div>
        <div></div>
        <div></div>
        <div></div>
        <div>ê¸ˆì•¡</div>
        <div>ë¹„ìœ¨</div>
        <div>ì‹ ë¢°ë„</div>
        <div>ìƒíƒœ</div>
      </div>
      <div class="list-row">
        <div><button class="accordion-toggle no-child">â–¶</button></div>
        <div>ê°ê°€ìƒê°</div>
        <div>ê°ê°€ìƒê°ë¹„</div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div style="font-weight:600;">3,200</div>
        <div>4.2%</div>
        <div><div class="mini-confidence"><div class="mini-bar" style="width:90%;background:#34c759;"></div></div><span style="font-size:10px;">90%</span></div>
        <div><span class="badge badge-ok">ì •ìƒ</span></div>
      </div>
      <div class="list-row">
        <div><button class="accordion-toggle no-child">â–¶</button></div>
        <div>ìœ í‹¸ë¦¬í‹°</div>
        <div>ì „ë ¥ë¹„</div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div style="font-weight:600;">2,800</div>
        <div>3.6%</div>
        <div><div class="mini-confidence"><div class="mini-bar" style="width:88%;background:#34c759;"></div></div><span style="font-size:10px;">88%</span></div>
        <div><span class="badge badge-ok">ì •ìƒ</span></div>
      </div>
      <div class="list-row anomaly-row">
        <div><button class="accordion-toggle no-child">â–¶</button></div>
        <div>ê¸°íƒ€</div>
        <div>ê¸°íƒ€ ê²½ë¹„ <span class="anomaly-icon">âš ï¸</span></div>
        <div></div>
        <div></div>
        <div></div>
        <div></div>
        <div style="font-weight:600;color:#ff3b30;">2,500</div>
        <div>3.3%</div>
        <div><div class="mini-confidence"><div class="mini-bar" style="width:72%;background:#ff9500;"></div></div><span style="font-size:10px;color:#ff9500;">72%</span></div>
        <div><span class="badge badge-error">ì´ìƒì¹˜</span></div>
      </div>
    </div>

    <!-- ì†Œê³„ -->
    <div class="list-group">
      <div class="std-group-header std-total-header">
        <div class="std-group-title">
          <span class="std-group-icon" style="background:#1d1d1f;color:#fff;">Î£</span>
          ì†Œê³„ (ìƒì‚°ì›ê°€)
        </div>
        <div class="std-group-summary">
          <span class="std-summary-value" style="font-size:18px;color:#0071e3;">â‚©76,800</span>
          <span class="std-summary-pct">100%</span>
        </div>
      </div>
      <table class="std-table">
        <thead>
          <tr>
            <th>êµ¬ë¶„</th>
            <th style="width:120px;">ê¸ˆì•¡</th>
            <th style="width:80px;">ë¹„ìœ¨</th>
            <th style="width:200px;">êµ¬ì„±</th>
            <th style="width:80px;">ì´ìƒì¹˜</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="font-weight:600;">â… . ì¬ë£Œë¹„</td>
            <td style="font-weight:600;">â‚©45,200</td>
            <td>58.9%</td>
            <td><div class="cost-bar"><div class="cost-fill" style="width:58.9%;background:#0071e3;"></div></div></td>
            <td><span style="color:#ff3b30;font-weight:600;">1ê±´</span></td>
          </tr>
          <tr>
            <td style="font-weight:600;">â…¡. ê°€ê³µë¹„</td>
            <td style="font-weight:600;">â‚©23,100</td>
            <td>30.1%</td>
            <td><div class="cost-bar"><div class="cost-fill" style="width:30.1%;background:#34c759;"></div></div></td>
            <td><span style="color:#86868b;">0ê±´</span></td>
          </tr>
          <tr>
            <td style="font-weight:600;">â…¢. ì œê²½ë¹„</td>
            <td style="font-weight:600;">â‚©8,500</td>
            <td>11.1%</td>
            <td><div class="cost-bar"><div class="cost-fill" style="width:11.1%;background:#ff9500;"></div></div></td>
            <td><span style="color:#ff3b30;font-weight:600;">1ê±´</span></td>
          </tr>
          <tr style="background:#f0f4ff;font-weight:700;">
            <td>í•©ê³„</td>
            <td style="color:#0071e3;font-size:15px;">â‚©76,800</td>
            <td>100%</td>
            <td><div class="cost-bar"><div class="cost-fill" style="width:58.9%;background:#0071e3;"></div><div class="cost-fill" style="width:30.1%;background:#34c759;"></div><div class="cost-fill" style="width:11.1%;background:#ff9500;"></div></div></td>
            <td style="color:#ff3b30;">2ê±´</td>
          </tr>
        </tbody>
      </table>
    </div>

  </div>
</div>

<!-- Canvas (ê´€ê³„ë„ ë·°) -->
<div class="canvas-container" id="graphView">
  <div class="graph">

    <!-- SVG Connections -->
    <svg class="connections" viewBox="0 0 1500 900">
      <!-- Root â†’ SUBSTRATE -->
      <path class="connection-line" d="M 620,155 C 620,230 230,230 230,300" />
      <!-- Root â†’ SKIN -->
      <path class="connection-line anomaly" d="M 620,155 C 620,230 680,230 680,300" />
      <!-- Root â†’ ADHESIVE -->
      <path class="connection-line" d="M 620,155 C 620,230 1130,230 1130,300" />
      <!-- SUBSTRATE â†’ Sub BOM -->
      <path class="connection-line" d="M 230,440 C 230,510 200,510 200,570" />
    </svg>

    <!-- Root Node -->
    <div class="node root" style="left: 490px; top: 20px;">
      <div class="node-header">
        <span class="node-type root-type">ì™„ì œí’ˆ</span>
        <div class="node-badge">
          <span class="badge badge-error">ì´ìƒì¹˜ 2</span>
        </div>
      </div>
      <div class="node-title">COMPLETE ASSY-HEAD LINING</div>
      <div class="node-subtitle">HL-2024-001 Â· ëŒ€í•œ(ì£¼)</div>
      <div class="node-stats">
        <div class="node-stat">
          <div class="stat-label">ì¬ë£Œë¹„</div>
          <div class="stat-value">â‚©45,200</div>
        </div>
        <div class="node-stat">
          <div class="stat-label">ê°€ê³µë¹„</div>
          <div class="stat-value">â‚©23,100</div>
        </div>
        <div class="node-stat">
          <div class="stat-label">ì œê²½ë¹„</div>
          <div class="stat-value">â‚©8,500</div>
        </div>
        <div class="node-stat">
          <div class="stat-label">ìƒì‚°ì›ê°€</div>
          <div class="stat-value" style="color:#0071e3;">â‚©76,800</div>
        </div>
      </div>
      <div class="node-footer">
        <div style="display:flex;align-items:center;gap:6px;">
          <span style="font-size:11px;color:#86868b;">ì‹ ë¢°ë„</span>
          <div class="confidence-bar"><div class="confidence-fill high"></div></div>
          <span style="font-size:11px;font-weight:600;">92%</span>
        </div>
        <span class="node-action">ìƒì„¸ë³´ê¸° â†’</span>
      </div>
      <div class="expand-btn">â–¼</div>
    </div>

    <!-- Child Node 1: SUBSTRATE -->
    <div class="node" style="left: 100px; top: 300px;">
      <div class="node-header">
        <span class="node-type sub-type">ì›ìì¬</span>
        <div class="node-badge">
          <span class="badge badge-ok">ì •ìƒ</span>
        </div>
      </div>
      <div class="node-title">SUBSTRATE (ê¸°ì¬)</div>
      <div class="node-subtitle">SUB-001 Â· í•˜ìœ„ ê²¬ì ì„œ ìˆìŒ</div>
      <div class="node-stats">
        <div class="node-stat">
          <div class="stat-label">ì¬ë£Œë¹„</div>
          <div class="stat-value">â‚©18,500</div>
        </div>
        <div class="node-stat">
          <div class="stat-label">ê°€ê³µë¹„</div>
          <div class="stat-value">â‚©12,300</div>
        </div>
        <div class="node-stat">
          <div class="stat-label">ì œê²½ë¹„</div>
          <div class="stat-value">â‚©4,200</div>
        </div>
        <div class="node-stat">
          <div class="stat-label">ì†Œê³„</div>
          <div class="stat-value">â‚©35,000</div>
        </div>
      </div>
      <div class="node-footer">
        <div style="display:flex;align-items:center;gap:6px;">
          <span style="font-size:11px;color:#86868b;">ì‹ ë¢°ë„</span>
          <div class="confidence-bar"><div class="confidence-fill high"></div></div>
          <span style="font-size:11px;font-weight:600;">95%</span>
        </div>
        <span class="node-action">ìƒì„¸ë³´ê¸° â†’</span>
      </div>
      <div class="expand-btn">â–¼</div>
      <!-- Tooltip on hover -->
      <div class="tooltip">
        <div class="tooltip-row"><span class="tooltip-label">íŒŒì‹± í•­ëª©</span><span>12ê±´</span></div>
        <div class="tooltip-row"><span class="tooltip-label">ì´ìƒì¹˜</span><span>0ê±´</span></div>
        <div class="tooltip-row"><span class="tooltip-label">í•˜ìœ„ ê²¬ì ì„œ</span><span>1ê°œ</span></div>
      </div>
    </div>

    <!-- Child Node 2: SKIN (with anomaly) -->
    <div class="node has-anomaly" style="left: 550px; top: 300px;">
      <div class="node-header">
        <span class="node-type sub-type">ì›ìì¬</span>
        <div class="node-badge">
          <span class="badge badge-error">ì´ìƒì¹˜ 2</span>
        </div>
      </div>
      <div class="node-title">SKIN (í‘œí”¼ì¬)</div>
      <div class="node-subtitle">SKN-002</div>
      <div class="node-stats">
        <div class="node-stat">
          <div class="stat-label">ì¬ë£Œë¹„</div>
          <div class="stat-value" style="color:#ff3b30;">â‚©22,700 âš ï¸</div>
        </div>
        <div class="node-stat">
          <div class="stat-label">ê°€ê³µë¹„</div>
          <div class="stat-value">â‚©8,400</div>
        </div>
        <div class="node-stat">
          <div class="stat-label">ì œê²½ë¹„</div>
          <div class="stat-value" style="color:#ff3b30;">â‚©3,100 âš ï¸</div>
        </div>
        <div class="node-stat">
          <div class="stat-label">ì†Œê³„</div>
          <div class="stat-value">â‚©34,200</div>
        </div>
      </div>
      <div class="node-footer">
        <div style="display:flex;align-items:center;gap:6px;">
          <span style="font-size:11px;color:#86868b;">ì‹ ë¢°ë„</span>
          <div class="confidence-bar"><div class="confidence-fill mid"></div></div>
          <span style="font-size:11px;font-weight:600;color:#ff9500;">75%</span>
        </div>
        <span class="node-action">ìƒì„¸ë³´ê¸° â†’</span>
      </div>
    </div>

    <!-- Child Node 3: ADHESIVE -->
    <div class="node" style="left: 1000px; top: 300px;">
      <div class="node-header">
        <span class="node-type sub-type">ì›ìì¬</span>
        <div class="node-badge">
          <span class="badge badge-ok">ì •ìƒ</span>
        </div>
      </div>
      <div class="node-title">ADHESIVE (ì ‘ì°©ì œ)</div>
      <div class="node-subtitle">ADH-003 Â· ë‹¨ìˆœ ìì¬</div>
      <div class="node-stats">
        <div class="node-stat">
          <div class="stat-label">ì¬ë£Œë¹„</div>
          <div class="stat-value">â‚©3,200</div>
        </div>
        <div class="node-stat">
          <div class="stat-label">ê°€ê³µë¹„</div>
          <div class="stat-value">â‚©1,800</div>
        </div>
        <div class="node-stat">
          <div class="stat-label">ì œê²½ë¹„</div>
          <div class="stat-value">â‚©900</div>
        </div>
        <div class="node-stat">
          <div class="stat-label">ì†Œê³„</div>
          <div class="stat-value">â‚©5,900</div>
        </div>
      </div>
      <div class="node-footer">
        <div style="display:flex;align-items:center;gap:6px;">
          <span style="font-size:11px;color:#86868b;">ì‹ ë¢°ë„</span>
          <div class="confidence-bar"><div class="confidence-fill high"></div></div>
          <span style="font-size:11px;font-weight:600;">98%</span>
        </div>
        <span class="node-action">ìƒì„¸ë³´ê¸° â†’</span>
      </div>
    </div>

    <!-- Grandchild: SUBSTRATE Sub-BOM -->
    <div class="node" style="left: 70px; top: 570px; width: 260px;">
      <div class="node-header">
        <span class="node-type sub-type">í•˜ìœ„ ê²¬ì ì„œ</span>
        <div class="node-badge">
          <span class="badge badge-ok">ì •ìƒ</span>
        </div>
      </div>
      <div class="node-title">SUBSTRATE ì›ìì¬ ê²¬ì ì„œ</div>
      <div class="node-subtitle">SUB-BOM-001 Â· 2ë‹¨ê³„</div>
      <div class="node-stats">
        <div class="node-stat">
          <div class="stat-label">ì¬ë£Œë¹„</div>
          <div class="stat-value">â‚©12,000</div>
        </div>
        <div class="node-stat">
          <div class="stat-label">ê°€ê³µë¹„</div>
          <div class="stat-value">â‚©6,500</div>
        </div>
      </div>
      <div class="node-footer">
        <div style="display:flex;align-items:center;gap:6px;">
          <span style="font-size:11px;color:#86868b;">ì‹ ë¢°ë„</span>
          <div class="confidence-bar"><div class="confidence-fill high"></div></div>
          <span style="font-size:11px;font-weight:600;">94%</span>
        </div>
        <span class="node-action">ìƒì„¸ë³´ê¸° â†’</span>
      </div>
    </div>

    <!-- Annotation -->
    <div class="annotation" style="left: 870px; top: 240px;">
      ì´ìƒì¹˜ ê°ì§€: SKIN ì¬ë£Œë¹„ê°€ ê³¼ê±° ê²¬ì  ëŒ€ë¹„ 35% ë†’ìŒ. ì œê²½ë¹„ ê³„ì‚°ì‹ ì˜¤ë¥˜ ì˜ì‹¬.
    </div>

  </div>
</div>

<!-- Legend -->
<div class="legend">
  <div class="legend-item">
    <div class="legend-dot normal"></div>
    <span>ì •ìƒ</span>
  </div>
  <div class="legend-item">
    <div class="legend-dot warning"></div>
    <span>í™•ì¸ í•„ìš”</span>
  </div>
  <div class="legend-item">
    <div class="legend-dot error"></div>
    <span>ì´ìƒì¹˜</span>
  </div>
  <div class="legend-item">
    <span style="color:#86868b;">â”€â”€ ì •ìƒ ì—°ê²°</span>
  </div>
  <div class="legend-item">
    <span style="color:#ff3b30;">- - - ì´ìƒì¹˜ ì—°ê²°</span>
  </div>
</div>

<!-- Zoom Toolbar -->
<div class="canvas-toolbar">
  <button class="toolbar-btn" title="í™•ëŒ€">+</button>
  <button class="toolbar-btn" title="ì¶•ì†Œ">âˆ’</button>
  <button class="toolbar-btn" title="ì „ì²´ë³´ê¸°">âŠ¡</button>
  <button class="toolbar-btn" title="ì ‘ê¸°/í¼ì¹˜ê¸°">âŠŸ</button>
</div>

<!-- Minimap -->
<div class="minimap">
  <div class="minimap-label">ì „ì²´ êµ¬ì¡°</div>
  <svg viewBox="0 0 180 90" style="width:100%;height:80px;">
    <rect x="70" y="5" width="40" height="15" rx="3" fill="#0071e3" opacity="0.3"/>
    <rect x="15" y="40" width="35" height="12" rx="3" fill="#34c759" opacity="0.3"/>
    <rect x="70" y="40" width="35" height="12" rx="3" fill="#ff3b30" opacity="0.3"/>
    <rect x="125" y="40" width="35" height="12" rx="3" fill="#34c759" opacity="0.3"/>
    <rect x="5" y="70" width="30" height="10" rx="3" fill="#34c759" opacity="0.2"/>
    <line x1="90" y1="20" x2="32" y2="40" stroke="#d2d2d7" stroke-width="1"/>
    <line x1="90" y1="20" x2="87" y2="40" stroke="#ff3b30" stroke-width="1" stroke-dasharray="2 1"/>
    <line x1="90" y1="20" x2="142" y2="40" stroke="#d2d2d7" stroke-width="1"/>
    <line x1="32" y1="52" x2="20" y2="70" stroke="#d2d2d7" stroke-width="1"/>
    <!-- viewport indicator -->
    <rect x="0" y="0" width="160" height="80" rx="3" fill="none" stroke="#0071e3" stroke-width="1.5" opacity="0.5"/>
  </svg>
</div>

</div><!-- /verificationPage -->

</div><!-- /main-wrapper -->

<!-- Excel Popup -->
<div class="popup-overlay" id="excelPopup">
  <div class="popup">
    <div class="popup-header">
      <div style="display:flex;align-items:center;gap:12px;">
        <h2>ğŸ“„ ì›ë³¸ ê²¬ì ì„œ â€” HEAD_LINING_ì›ê°€ê³„ì‚°ì„œ.xlsx</h2>
        <span style="font-size:11px;color:#86868b;background:#f0f0f2;padding:2px 8px;border-radius:4px;">Sheet 1 of 2</span>
      </div>
      <div class="popup-header-right">
        <span style="font-size:11px;color:#86868b;">í•˜ì´ë¼ì´íŠ¸ëœ ì…€: ë§¤í•‘ëœ í•­ëª©</span>
        <button class="popup-close" onclick="closePopup()">âœ•</button>
      </div>
    </div>
    <div class="popup-toolbar">
      <div class="popup-toolbar-left">
        <div class="popup-tab active">ì›ê°€ê³„ì‚°ì„œ</div>
        <div class="popup-tab">ìì¬ëª…ì„¸</div>
      </div>
      <div style="display:flex;gap:8px;align-items:center;">
        <span>í™•ëŒ€/ì¶•ì†Œ:</span>
        <button class="btn" style="padding:2px 8px;font-size:11px;" onclick="zoomExcel(-1)">âˆ’</button>
        <span id="zoomLevel" style="font-size:12px;font-weight:600;">100%</span>
        <button class="btn" style="padding:2px 8px;font-size:11px;" onclick="zoomExcel(1)">+</button>
      </div>
    </div>
    <div class="popup-body">
      <div class="excel-wrapper" id="excelWrapper">
        <table class="excel-table" id="excelTable">
          <thead>
            <tr>
              <th></th>
              <th>A</th>
              <th>B</th>
              <th>C</th>
              <th>D</th>
              <th>E</th>
              <th>F</th>
              <th>G</th>
              <th>H</th>
              <th>I</th>
            </tr>
          </thead>
          <tbody>
            <!-- Row 1: Title -->
            <tr>
              <td class="row-header">1</td>
              <td colspan="9" class="cell-merged" style="font-size:14px;">ì› ê°€ ê³„ ì‚° ì„œ</td>
            </tr>
            <!-- Row 2: Empty -->
            <tr>
              <td class="row-header">2</td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
            </tr>
            <!-- Row 3: Header info -->
            <tr>
              <td class="row-header">3</td>
              <td style="font-weight:600;">E.O. NO.</td>
              <td class="cell-highlight-green">EO-2024-1201 <span class="mapping-tag mapped">ë§¤í•‘</span></td>
              <td class="cell-empty"></td>
              <td style="font-weight:600;">ì‘ì„±ì¼ì</td>
              <td class="cell-highlight-green">2024-11-25 <span class="mapping-tag mapped">ë§¤í•‘</span></td>
              <td class="cell-empty"></td>
              <td style="font-weight:600;">í˜‘ë ¥ì‚¬</td>
              <td colspan="2" class="cell-highlight-green">ëŒ€í•œ(ì£¼) <span class="mapping-tag mapped">ë§¤í•‘</span></td>
            </tr>
            <!-- Row 4: Part info -->
            <tr>
              <td class="row-header">4</td>
              <td style="font-weight:600;">í’ˆë²ˆ</td>
              <td class="cell-highlight-green">HL-2024-001 <span class="mapping-tag mapped">ë§¤í•‘</span></td>
              <td class="cell-empty"></td>
              <td style="font-weight:600;">í’ˆëª…</td>
              <td colspan="3" class="cell-highlight-green">COMPLETE ASSY-HEAD LINING <span class="mapping-tag mapped">ë§¤í•‘</span></td>
              <td style="font-weight:600;">ë‹´ë‹¹ì</td>
              <td class="cell-highlight-green">ê¹€ì² ìˆ˜ <span class="mapping-tag mapped">ë§¤í•‘</span></td>
            </tr>
            <!-- Row 5: Empty -->
            <tr>
              <td class="row-header">5</td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
            </tr>
            <!-- Row 6: Table header -->
            <tr>
              <td class="row-header">6</td>
              <td style="font-weight:600;background:#e8edf3;">êµ¬ë¶„</td>
              <td style="font-weight:600;background:#e8edf3;">í’ˆëª…</td>
              <td style="font-weight:600;background:#e8edf3;">ê·œê²©</td>
              <td style="font-weight:600;background:#e8edf3;">ë‹¨ìœ„</td>
              <td style="font-weight:600;background:#e8edf3;">ìˆ˜ëŸ‰</td>
              <td style="font-weight:600;background:#e8edf3;">ë‹¨ê°€</td>
              <td style="font-weight:600;background:#e8edf3;">ê¸ˆì•¡</td>
              <td style="font-weight:600;background:#e8edf3;">ë¹„ìœ¨(%)</td>
              <td style="font-weight:600;background:#e8edf3;">ë¹„ê³ </td>
            </tr>
            <!-- Row 7: ì¬ë£Œë¹„ header -->
            <tr>
              <td class="row-header">7</td>
              <td colspan="2" class="cell-merged" style="background:#eef3ff;">â… . ì¬ë£Œë¹„</td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-highlight-green" style="font-weight:600;">45,200 <span class="mapping-tag mapped">ë§¤í•‘</span></td>
              <td>58.9%</td>
              <td class="cell-empty"></td>
            </tr>
            <!-- Row 8 -->
            <tr>
              <td class="row-header">8</td>
              <td>ì›ìì¬</td>
              <td class="cell-highlight">SUBSTRATE (ê¸°ì¬) <span class="mapping-tag mapped">ë§¤í•‘</span></td>
              <td>1200Ã—800Ã—3T</td>
              <td>EA</td>
              <td>1</td>
              <td>18,500</td>
              <td class="cell-highlight-green">18,500</td>
              <td>24.1%</td>
              <td class="cell-empty"></td>
            </tr>
            <!-- Row 9 -->
            <tr>
              <td class="row-header">9</td>
              <td>ì›ìì¬</td>
              <td class="cell-highlight-red">SKIN (í‘œí”¼ì¬) <span class="mapping-tag anomaly">ì´ìƒì¹˜</span></td>
              <td>PVC 0.8mm</td>
              <td>MÂ²</td>
              <td>1.2</td>
              <td>18,917</td>
              <td class="cell-highlight-red" style="font-weight:600;">22,700 <span class="mapping-tag anomaly">âš ï¸</span></td>
              <td>29.6%</td>
              <td style="color:#ff3b30;font-size:11px;">ê³¼ê±° ëŒ€ë¹„ +35%</td>
            </tr>
            <!-- Row 10 -->
            <tr>
              <td class="row-header">10</td>
              <td>ì›ìì¬</td>
              <td class="cell-highlight">ADHESIVE (ì ‘ì°©ì œ) <span class="mapping-tag mapped">ë§¤í•‘</span></td>
              <td>WATER BASE</td>
              <td>KG</td>
              <td>0.5</td>
              <td>4,400</td>
              <td class="cell-highlight-green">2,200</td>
              <td>2.9%</td>
              <td class="cell-empty"></td>
            </tr>
            <!-- Row 11 -->
            <tr>
              <td class="row-header">11</td>
              <td>ë¶€ìì¬</td>
              <td>CLIP</td>
              <td>PA66</td>
              <td>EA</td>
              <td>12</td>
              <td>75</td>
              <td>900</td>
              <td>1.2%</td>
              <td class="cell-empty"></td>
            </tr>
            <!-- Row 12 -->
            <tr>
              <td class="row-header">12</td>
              <td>ë¶€ìì¬</td>
              <td>PACKING</td>
              <td>ê³¨íŒì§€</td>
              <td>SET</td>
              <td>1</td>
              <td>900</td>
              <td>900</td>
              <td>1.2%</td>
              <td class="cell-empty"></td>
            </tr>
            <!-- Row 13: Empty -->
            <tr>
              <td class="row-header">13</td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
            </tr>
            <!-- Row 14: ê°€ê³µë¹„ -->
            <tr>
              <td class="row-header">14</td>
              <td colspan="2" class="cell-merged" style="background:#eef3ff;">â…¡. ê°€ê³µë¹„</td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-highlight-green" style="font-weight:600;">23,100 <span class="mapping-tag mapped">ë§¤í•‘</span></td>
              <td>30.1%</td>
              <td class="cell-empty"></td>
            </tr>
            <!-- Row 15 -->
            <tr>
              <td class="row-header">15</td>
              <td></td>
              <td>í”„ë ˆìŠ¤ ì„±í˜•</td>
              <td class="cell-empty"></td>
              <td>íšŒ</td>
              <td>1</td>
              <td>8,500</td>
              <td>8,500</td>
              <td>11.1%</td>
              <td class="cell-empty"></td>
            </tr>
            <!-- Row 16 -->
            <tr>
              <td class="row-header">16</td>
              <td></td>
              <td>ì ‘ì°© ê³µì •</td>
              <td class="cell-empty"></td>
              <td>íšŒ</td>
              <td>1</td>
              <td>6,200</td>
              <td>6,200</td>
              <td>8.1%</td>
              <td class="cell-empty"></td>
            </tr>
            <!-- Row 17 -->
            <tr>
              <td class="row-header">17</td>
              <td></td>
              <td>íŠ¸ë¦¬ë°</td>
              <td class="cell-empty"></td>
              <td>íšŒ</td>
              <td>1</td>
              <td>5,400</td>
              <td>5,400</td>
              <td>7.0%</td>
              <td class="cell-empty"></td>
            </tr>
            <!-- Row 18 -->
            <tr>
              <td class="row-header">18</td>
              <td></td>
              <td>ê²€ì‚¬/í¬ì¥</td>
              <td class="cell-empty"></td>
              <td>íšŒ</td>
              <td>1</td>
              <td>3,000</td>
              <td>3,000</td>
              <td>3.9%</td>
              <td class="cell-empty"></td>
            </tr>
            <!-- Row 19: Empty -->
            <tr>
              <td class="row-header">19</td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
            </tr>
            <!-- Row 20: ì œê²½ë¹„ -->
            <tr>
              <td class="row-header">20</td>
              <td colspan="2" class="cell-merged" style="background:#eef3ff;">â…¢. ì œê²½ë¹„</td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-highlight-red" style="font-weight:600;">8,500 <span class="mapping-tag anomaly">âš ï¸</span></td>
              <td>11.1%</td>
              <td style="color:#ff3b30;font-size:11px;">ê³„ì‚°ì‹ ë¶ˆì¼ì¹˜</td>
            </tr>
            <!-- Row 21 -->
            <tr>
              <td class="row-header">21</td>
              <td></td>
              <td>ê°ê°€ìƒê°ë¹„</td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td>3,200</td>
              <td>4.2%</td>
              <td class="cell-empty"></td>
            </tr>
            <!-- Row 22 -->
            <tr>
              <td class="row-header">22</td>
              <td></td>
              <td>ì „ë ¥ë¹„</td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td>2,800</td>
              <td>3.6%</td>
              <td class="cell-empty"></td>
            </tr>
            <!-- Row 23 -->
            <tr>
              <td class="row-header">23</td>
              <td></td>
              <td>ê¸°íƒ€ ê²½ë¹„</td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td>2,500</td>
              <td>3.3%</td>
              <td class="cell-empty"></td>
            </tr>
            <!-- Row 24: Empty -->
            <tr>
              <td class="row-header">24</td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
            </tr>
            <!-- Row 25: Total -->
            <tr style="background:#f0f4ff;">
              <td class="row-header">25</td>
              <td colspan="2" class="cell-merged" style="font-size:13px;background:#dce6f7;">í•©ê³„ (ìƒì‚°ì›ê°€)</td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-empty"></td>
              <td class="cell-highlight-green" style="font-weight:700;font-size:13px;">76,800 <span class="mapping-tag mapped">ë§¤í•‘</span></td>
              <td style="font-weight:700;">100%</td>
              <td class="cell-empty"></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <!-- Footer legend -->
    <div class="highlight-legend">
      <div class="hl-item"><div class="hl-dot hl-mapped"></div><span>ë§¤í•‘ ì™„ë£Œ</span></div>
      <div class="hl-item"><div class="hl-dot hl-selected"></div><span>ì„ íƒëœ í•­ëª©</span></div>
      <div class="hl-item"><div class="hl-dot hl-anomaly"></div><span>ì´ìƒì¹˜ ê°ì§€</span></div>
      <span style="margin-left:auto;">ì…€ í´ë¦­ ì‹œ ì¢Œì¸¡ í‘œì¤€ ë°ì´í„°ì™€ ì—°ë™ë©ë‹ˆë‹¤</span>
    </div>
  </div>
</div>

<script>
  // Open popup
  function openPopup() {
    document.getElementById('excelPopup').classList.add('active');
  }
  // Close popup
  function closePopup() {
    document.getElementById('excelPopup').classList.remove('active');
  }
  // Close on overlay click
  document.getElementById('excelPopup').addEventListener('click', function(e) {
    if (e.target === this) closePopup();
  });
  // ESC to close
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') closePopup();
  });

  // Bind "ì›ë³¸ë³´ê¸°" button
  document.querySelector('.btn[style*="ì›ë³¸ë³´ê¸°"]') ||
  document.querySelectorAll('.btn').forEach(function(btn) {
    if (btn.textContent.includes('ì›ë³¸ë³´ê¸°')) {
      btn.addEventListener('click', openPopup);
    }
  });

  // Also bind all "ìƒì„¸ë³´ê¸°" links in nodes
  document.querySelectorAll('.node-action').forEach(function(link) {
    link.addEventListener('click', openPopup);
  });

  // View tab switching
  document.querySelectorAll('.view-tab').forEach(function(tab) {
    tab.addEventListener('click', function() {
      document.querySelectorAll('.view-tab').forEach(t => t.classList.remove('active'));
      this.classList.add('active');
      const label = this.textContent.trim();
      const graphView = document.getElementById('graphView');
      const stdView = document.getElementById('standardView');
      const legend = document.querySelector('.legend');
      const minimap = document.querySelector('.minimap');
      const toolbar = document.querySelector('.canvas-toolbar');

      var listView = document.getElementById('listView');

      stdView.style.display = 'none';
      graphView.style.display = 'none';
      listView.style.display = 'none';
      if (legend) legend.style.display = 'none';
      if (minimap) minimap.style.display = 'none';
      if (toolbar) toolbar.style.display = 'none';

      if (label === 'í‘œì¤€') {
        stdView.style.display = 'block';
      } else if (label === 'ê´€ê³„ë„') {
        graphView.style.display = 'block';
        if (legend) legend.style.display = 'flex';
        if (minimap) minimap.style.display = 'block';
        if (toolbar) toolbar.style.display = 'flex';
      } else if (label === 'ë¦¬ìŠ¤íŠ¸') {
        listView.style.display = 'block';
      }
    });
  });

  // Page switching
  function switchPage(page) {
    var parsingPage = document.getElementById('parsingPage');
    var verificationPage = document.getElementById('verificationPage');
    var header = document.querySelector('.header');
    var statusBar = document.querySelector('.status-bar');

    var insightPage = document.getElementById('insightPage');

    var modelPage = document.getElementById('modelPage');

    parsingPage.style.display = 'none';
    verificationPage.style.display = 'none';
    insightPage.style.display = 'none';
    insightPage.classList.remove('active');
    modelPage.style.display = 'none';
    header.style.display = 'none';
    statusBar.style.display = 'none';

    if (page === 'parsing') {
      parsingPage.style.display = 'block';
    } else if (page === 'verification') {
      verificationPage.style.display = 'block';
      header.style.display = 'flex';
      statusBar.style.display = 'flex';
    } else if (page === 'insight') {
      insightPage.style.display = 'flex';
      insightPage.classList.add('active');
    } else if (page === 'model') {
      modelPage.style.display = 'block';
    }

    // Update sidebar active
    document.querySelectorAll('.sidebar-item').forEach(function(item) {
      item.classList.remove('active');
      if (item.getAttribute('data-page') === page) item.classList.add('active');
    });

    // Sidebar stays visible (no close needed)
  }

  // Drawer
  function openDrawer(type) {
    var drawer = document.getElementById('detailDrawer');
    // Hide all states
    document.querySelectorAll('#detailDrawer > div').forEach(d => d.style.display = 'none');
    // Show target
    var mapping = {
      'extracting': 'drawer-extracting',
      'complete': 'drawer-complete',
      'complete2': 'drawer-complete',
      'failed': 'drawer-failed',
      'analyzed': 'drawer-complete'
    };
    var target = document.getElementById(mapping[type] || 'drawer-complete');
    if (target) target.style.display = 'flex';
    drawer.classList.add('open');
    document.getElementById('drawerOverlay').style.display = 'block';
  }
  function closeDrawer() {
    document.getElementById('detailDrawer').classList.remove('open');
    document.getElementById('drawerOverlay').style.display = 'none';
  }

  // File filter
  function filterFiles(status) {
    document.querySelectorAll('.status-card').forEach(c => c.classList.remove('active'));
    event.currentTarget.classList.add('active');
    document.querySelectorAll('.file-row').forEach(function(row) {
      if (status === 'all' || row.getAttribute('data-status') === status) {
        row.style.display = '';
      } else {
        row.style.display = 'none';
      }
    });
  }

  // Chat functions
  function sendChat() {
    var input = document.getElementById('chatInput');
    var text = input.value.trim();
    if (!text) return;
    var messages = document.getElementById('chatMessages');
    messages.innerHTML += '<div class="chat-msg user"><div class="chat-avatar user-avatar">HY</div><div><div class="chat-bubble">' + text + '</div><div class="chat-meta">ë°©ê¸ˆ</div></div></div>';
    input.value = '';
    messages.scrollTop = messages.scrollHeight;
    // Simulate AI typing
    setTimeout(function() {
      messages.innerHTML += '<div class="chat-msg ai"><div class="chat-avatar ai-avatar">AI</div><div><div class="chat-bubble">ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”. â³</div><div class="chat-meta">ë°©ê¸ˆ Â· ë¶„ì„ì¤‘</div></div></div>';
      messages.scrollTop = messages.scrollHeight;
    }, 800);
  }
  function sendSuggestion(el) {
    var text = el.querySelector('.insight-suggestion-text').textContent;
    document.getElementById('chatInput').value = text;
    sendChat();
  }
  // Enter to send
  document.addEventListener('DOMContentLoaded', function() {
    var chatInput = document.getElementById('chatInput');
    if (chatInput) {
      chatInput.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') sendChat();
      });
    }
  });

  // Sidebar collapse/expand toggle
  document.addEventListener('DOMContentLoaded', function() {
    var btn = document.getElementById('sidebarCollapseBtn');
    if (btn) {
      btn.addEventListener('click', function(e) {
        e.stopPropagation();
        e.preventDefault();
        var sidebar = document.getElementById('sidebar');
        sidebar.classList.toggle('collapsed');
        document.body.classList.toggle('sidebar-collapsed');
        btn.textContent = sidebar.classList.contains('collapsed') ? 'Â»' : 'Â«';
      });
    }

    // Collapsed ìƒíƒœì—ì„œ ì•„ì´ì½˜ í´ë¦­ìœ¼ë¡œ í¼ì¹˜ê¸°
    var logoIcon = document.querySelector('.sidebar-logo-icon');
    if (logoIcon) {
      logoIcon.addEventListener('click', function() {
        var sidebar = document.getElementById('sidebar');
        if (sidebar.classList.contains('collapsed')) {
          sidebar.classList.remove('collapsed');
          document.body.classList.remove('sidebar-collapsed');
          document.getElementById('sidebarCollapseBtn').textContent = 'Â«';
        }
      });
    }
  });

  function toggleSidebarCollapse() {
    var sidebar = document.getElementById('sidebar');
    var btn = document.getElementById('sidebarCollapseBtn');
    sidebar.classList.toggle('collapsed');
    document.body.classList.toggle('sidebar-collapsed');
    btn.textContent = sidebar.classList.contains('collapsed') ? 'Â»' : 'Â«';
  }

  // Legacy toggle (hamburger) â€” now also collapses
  function toggleSidebar() {
    toggleSidebarCollapse();
  }

  // Model management - add formula
  function addFormula() {
    var list = document.getElementById('formulaList');
    var card = document.createElement('div');
    card.className = 'formula-card';
    card.style.border = '2px solid #0071e3';
    card.innerHTML = '<div class="formula-card-header"><input type="text" placeholder="ìˆ˜ì‹ ì´ë¦„ ì…ë ¥" style="font-size:15px;font-weight:700;border:1px solid #e5e5e7;border-radius:6px;padding:6px 10px;outline:none;flex:1;" autofocus><select style="margin-left:8px;padding:4px 8px;border:1px solid #e5e5e7;border-radius:6px;font-size:12px;"><option>í•µì‹¬</option><option>í•˜ìœ„í•­ëª©</option><option>ë¹„ìœ¨</option></select></div><div class="formula-expression" style="background:#fff;border:2px solid #0071e3;"><input type="text" placeholder="ì˜ˆ: êµ¬ë§¤ì›ê°€ = ì¬ë£Œë¹„ + ê°€ê³µë¹„ + ì œê²½ë¹„" style="flex:1;border:none;outline:none;font-family:SF Mono,Consolas,monospace;font-size:14px;background:none;"></div><textarea placeholder="ìˆ˜ì‹ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”" style="width:100%;border:1px solid #e5e5e7;border-radius:8px;padding:10px;font-size:13px;resize:vertical;min-height:60px;outline:none;margin-bottom:8px;font-family:inherit;"></textarea><div class="formula-actions"><button class="formula-action-btn" onclick="this.closest(\'.formula-card\').remove()" style="color:#86868b;">ì·¨ì†Œ</button><button class="formula-action-btn edit">ğŸ’¾ ì €ì¥</button></div>';
    list.insertBefore(card, list.firstChild);
    card.querySelector('input').focus();
    card.scrollIntoView({behavior: 'smooth', block: 'start'});
  }

  // Logout
  function handleLogout() {
    var overlay = document.getElementById('loginOverlay');
    overlay.style.display = 'flex';
    overlay.classList.remove('hidden');
    // Reset login form
    document.getElementById('loginForm').classList.remove('hidden');
    document.getElementById('otpForm').classList.remove('active');
    document.getElementById('loginId').value = '';
    document.getElementById('loginPw').value = '';
    document.querySelectorAll('#otpInputs input').forEach(function(inp) { inp.value = ''; });
    document.getElementById('loginError').style.display = 'none';
    document.getElementById('otpError').style.display = 'none';
    // Hide main content
    document.querySelector('.sidebar').style.visibility = 'hidden';
  }

  // Accordion toggle
  function toggleAccordion(row) {
    var btn = row.querySelector('.accordion-toggle');
    if (!btn || btn.classList.contains('no-child')) return;
    var targetId = btn.getAttribute('data-target');
    var children = document.getElementById(targetId);
    if (children) {
      children.classList.toggle('open');
      btn.classList.toggle('open');
    }
  }

  // Zoom
  let zoom = 100;
  function zoomExcel(dir) {
    zoom = Math.max(60, Math.min(150, zoom + dir * 10));
    document.getElementById('excelTable').style.transform = 'scale(' + (zoom/100) + ')';
    document.getElementById('excelTable').style.transformOrigin = 'top left';
    document.getElementById('zoomLevel').textContent = zoom + '%';
  }

  // ===== Login & 2FA Logic =====
  // Hide main content until login
  document.addEventListener('DOMContentLoaded', function() {
    // Initially hide everything behind login
    document.querySelector('.sidebar').style.visibility = 'hidden';
    document.getElementById('parsingPage').style.visibility = 'hidden';
  });

  function handleLogin() {
    var id = document.getElementById('loginId').value.trim();
    var pw = document.getElementById('loginPw').value.trim();
    var err = document.getElementById('loginError');

    if (!id || !pw) {
      err.style.display = 'block';
      err.textContent = 'ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.';
      return;
    }
    err.style.display = 'none';

    // 1ì°¨ ì¸ì¦ í†µê³¼ â†’ 2ì°¨ ì¸ì¦ í™”ë©´
    document.getElementById('loginForm').classList.add('hidden');
    document.getElementById('otpForm').classList.add('active');
    startOtpTimer();

    // OTP ì…ë ¥ ìë™ í¬ì»¤ìŠ¤
    var inputs = document.querySelectorAll('#otpInputs input');
    inputs[0].focus();
    inputs.forEach(function(inp, i) {
      inp.addEventListener('input', function() {
        if (inp.value && i < inputs.length - 1) inputs[i + 1].focus();
      });
      inp.addEventListener('keydown', function(e) {
        if (e.key === 'Backspace' && !inp.value && i > 0) inputs[i - 1].focus();
      });
    });
  }

  // Enter key for login
  document.addEventListener('DOMContentLoaded', function() {
    ['loginId', 'loginPw'].forEach(function(id) {
      var el = document.getElementById(id);
      if (el) el.addEventListener('keydown', function(e) { if (e.key === 'Enter') handleLogin(); });
    });
  });

  var otpInterval;
  function startOtpTimer() {
    var seconds = 180;
    var timerEl = document.getElementById('otpTimerText');
    clearInterval(otpInterval);
    otpInterval = setInterval(function() {
      seconds--;
      var m = Math.floor(seconds / 60);
      var s = seconds % 60;
      timerEl.textContent = (m < 10 ? '0' : '') + m + ':' + (s < 10 ? '0' : '') + s;
      if (seconds <= 0) clearInterval(otpInterval);
    }, 1000);
  }

  function resendOtp() {
    startOtpTimer();
    alert('ì¸ì¦ë²ˆí˜¸ê°€ ì¬ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.');
  }

  function handleOtp() {
    var inputs = document.querySelectorAll('#otpInputs input');
    var code = '';
    inputs.forEach(function(inp) { code += inp.value; });
    var err = document.getElementById('otpError');

    if (code.length < 6) {
      err.style.display = 'block';
      err.textContent = 'ì¸ì¦ë²ˆí˜¸ 6ìë¦¬ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.';
      return;
    }
    err.style.display = 'none';
    clearInterval(otpInterval);

    // ë¡œê·¸ì¸ ì„±ê³µ â†’ ë©”ì¸ í™”ë©´ ì§„ì…
    var overlay = document.getElementById('loginOverlay');
    overlay.classList.add('hidden');
    setTimeout(function() { overlay.style.display = 'none'; }, 400);

    // Show main content
    document.querySelector('.sidebar').style.visibility = 'visible';
    document.getElementById('parsingPage').style.visibility = 'visible';
    switchPage('parsing');
  }
</script>

</body>
</html>
